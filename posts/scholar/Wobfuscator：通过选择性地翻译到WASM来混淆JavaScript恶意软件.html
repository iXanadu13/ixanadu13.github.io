<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.18" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.59" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://iXanadu13.github.io/posts/scholar/Wobfuscator%EF%BC%9A%E9%80%9A%E8%BF%87%E9%80%89%E6%8B%A9%E6%80%A7%E5%9C%B0%E7%BF%BB%E8%AF%91%E5%88%B0WASM%E6%9D%A5%E6%B7%B7%E6%B7%86JavaScript%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6.html"><meta property="og:site_name" content="Xanadu13's Blog"><meta property="og:title" content="Wobfuscator: Obfuscating JavaScript Malware via Opportunistic Translation to WebAssembly"><meta property="og:description" content="Wobfuscator: Obfuscating JavaScript Malware via Opportunistic Translation to WebAssembly è®ºæ–‡æ¥è‡ª 2022 IEEE Symposium on Security and Privacy (SP 2022) çš„ã€ŠWobfuscator: Obfuscating Ja..."><meta property="og:type" content="article"><meta property="og:image" content="https://iXanadu13.github.io/assets/images/scholar/Wobfuscatorï¼šé€šè¿‡é€‰æ‹©æ€§åœ°ç¿»è¯‘åˆ°WASMæ¥æ··æ·†JavaScriptæ¶æ„è½¯ä»¶/figure1.png"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-10-12T03:57:52.000Z"><meta property="article:tag" content="Obfuscate"><meta property="article:published_time" content="2025-09-22T00:00:00.000Z"><meta property="article:modified_time" content="2025-10-12T03:57:52.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Wobfuscator: Obfuscating JavaScript Malware via Opportunistic Translation to WebAssembly","image":["https://iXanadu13.github.io/assets/images/scholar/Wobfuscatorï¼šé€šè¿‡é€‰æ‹©æ€§åœ°ç¿»è¯‘åˆ°WASMæ¥æ··æ·†JavaScriptæ¶æ„è½¯ä»¶/figure1.png","https://iXanadu13.github.io/assets/images/scholar/Wobfuscatorï¼šé€šè¿‡é€‰æ‹©æ€§åœ°ç¿»è¯‘åˆ°WASMæ¥æ··æ·†JavaScriptæ¶æ„è½¯ä»¶/table1.png","https://iXanadu13.github.io/assets/images/scholar/Wobfuscatorï¼šé€šè¿‡é€‰æ‹©æ€§åœ°ç¿»è¯‘åˆ°WASMæ¥æ··æ·†JavaScriptæ¶æ„è½¯ä»¶/other1.png","https://iXanadu13.github.io/assets/images/scholar/Wobfuscatorï¼šé€šè¿‡é€‰æ‹©æ€§åœ°ç¿»è¯‘åˆ°WASMæ¥æ··æ·†JavaScriptæ¶æ„è½¯ä»¶/figure2.png","https://iXanadu13.github.io/assets/images/scholar/Wobfuscatorï¼šé€šè¿‡é€‰æ‹©æ€§åœ°ç¿»è¯‘åˆ°WASMæ¥æ··æ·†JavaScriptæ¶æ„è½¯ä»¶/figure3.png","https://iXanadu13.github.io/assets/images/scholar/Wobfuscatorï¼šé€šè¿‡é€‰æ‹©æ€§åœ°ç¿»è¯‘åˆ°WASMæ¥æ··æ·†JavaScriptæ¶æ„è½¯ä»¶/table2.png","https://iXanadu13.github.io/assets/images/scholar/Wobfuscatorï¼šé€šè¿‡é€‰æ‹©æ€§åœ°ç¿»è¯‘åˆ°WASMæ¥æ··æ·†JavaScriptæ¶æ„è½¯ä»¶/table3.png","https://iXanadu13.github.io/assets/images/scholar/Wobfuscatorï¼šé€šè¿‡é€‰æ‹©æ€§åœ°ç¿»è¯‘åˆ°WASMæ¥æ··æ·†JavaScriptæ¶æ„è½¯ä»¶/figure4.png","https://iXanadu13.github.io/assets/images/scholar/Wobfuscatorï¼šé€šè¿‡é€‰æ‹©æ€§åœ°ç¿»è¯‘åˆ°WASMæ¥æ··æ·†JavaScriptæ¶æ„è½¯ä»¶/table4.png","https://iXanadu13.github.io/assets/images/scholar/Wobfuscatorï¼šé€šè¿‡é€‰æ‹©æ€§åœ°ç¿»è¯‘åˆ°WASMæ¥æ··æ·†JavaScriptæ¶æ„è½¯ä»¶/table5.png","https://iXanadu13.github.io/assets/images/scholar/Wobfuscatorï¼šé€šè¿‡é€‰æ‹©æ€§åœ°ç¿»è¯‘åˆ°WASMæ¥æ··æ·†JavaScriptæ¶æ„è½¯ä»¶/table6.png","https://iXanadu13.github.io/assets/images/scholar/Wobfuscatorï¼šé€šè¿‡é€‰æ‹©æ€§åœ°ç¿»è¯‘åˆ°WASMæ¥æ··æ·†JavaScriptæ¶æ„è½¯ä»¶/table7-8.png"],"datePublished":"2025-09-22T00:00:00.000Z","dateModified":"2025-10-12T03:57:52.000Z","author":[{"@type":"Person","name":"Xanadu13","url":"https://github.com/iXanadu13"}]}</script><link rel="icon" href="/skyblock.png"><title>Wobfuscator: Obfuscating JavaScript Malware via Opportunistic Translation to WebAssembly | Xanadu13's Blog</title><meta name="description" content="Wobfuscator: Obfuscating JavaScript Malware via Opportunistic Translation to WebAssembly è®ºæ–‡æ¥è‡ª 2022 IEEE Symposium on Security and Privacy (SP 2022) çš„ã€ŠWobfuscator: Obfuscating Ja...">
    <link rel="preload" href="/assets/style-5cE57DiZ.css" as="style"><link rel="stylesheet" href="/assets/style-5cE57DiZ.css">
    <link rel="modulepreload" href="/assets/app-Bb1W1urA.js"><link rel="modulepreload" href="/assets/Wobfuscatorï¼šé€šè¿‡é€‰æ‹©æ€§åœ°ç¿»è¯‘åˆ°WASMæ¥æ··æ·†JavaScriptæ¶æ„è½¯ä»¶.html-CbGFop1-.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-D3kTXrdh.js" as="script"><link rel="prefetch" href="/assets/intro.html-B53BCpRh.js" as="script"><link rel="prefetch" href="/assets/compiler_principle.html-DMsg6ThN.js" as="script"><link rel="prefetch" href="/assets/ensp-win11.html-7CDAg2bX.js" as="script"><link rel="prefetch" href="/assets/git.html-48NkD184.js" as="script"><link rel="prefetch" href="/assets/install-rabbitmq.html-STMEErj2.js" as="script"><link rel="prefetch" href="/assets/interview.html-BnTdcEmY.js" as="script"><link rel="prefetch" href="/assets/linux-cmd.html-RHf4IQlt.js" as="script"><link rel="prefetch" href="/assets/nodejs.html-DLLEsc8D.js" as="script"><link rel="prefetch" href="/assets/tsconfig-json-error.html-faCJkTIk.js" as="script"><link rel="prefetch" href="/assets/vmware-macOS.html-CeGp0gqI.js" as="script"><link rel="prefetch" href="/assets/yapi.html-BzOuAvZz.js" as="script"><link rel="prefetch" href="/assets/å»è™šæ‹ŸåŒ–.html-rMS_nM7Z.js" as="script"><link rel="prefetch" href="/assets/Catalan.html-BSnoHSB4.js" as="script"><link rel="prefetch" href="/assets/LIS.html-L4jforgs.js" as="script"><link rel="prefetch" href="/assets/disjoint-set.html-CRezM3qD.js" as="script"><link rel="prefetch" href="/assets/jd0802t2.html-CFrQpY49.js" as="script"><link rel="prefetch" href="/assets/jd0809t1.html-B8WCstp8.js" as="script"><link rel="prefetch" href="/assets/kmp.html-DF7ggW4k.js" as="script"><link rel="prefetch" href="/assets/longestPalindrome.html-B30jUFxU.js" as="script"><link rel="prefetch" href="/assets/sieve.html-tWGQkaj-.js" as="script"><link rel="prefetch" href="/assets/sort.html-BapaJ8ds.js" as="script"><link rel="prefetch" href="/assets/Round-1044-div2.html-lO_Y28zm.js" as="script"><link rel="prefetch" href="/assets/basic.html-DM9zyg6J.js" as="script"><link rel="prefetch" href="/assets/c-union.html-BLVukAge.js" as="script"><link rel="prefetch" href="/assets/compile-time-obf.html-CRb4ES-8.js" as="script"><link rel="prefetch" href="/assets/meta-program.html-BE7e3Hbz.js" as="script"><link rel="prefetch" href="/assets/priority_queue.html-yO2-Zb1X.js" as="script"><link rel="prefetch" href="/assets/shared_ptr.html-CC7r2pqU.js" as="script"><link rel="prefetch" href="/assets/mysql-devide.html-BUUV4mhV.js" as="script"><link rel="prefetch" href="/assets/1010.html-Cw-U8M3b.js" as="script"><link rel="prefetch" href="/assets/1028.html-G8AAjph6.js" as="script"><link rel="prefetch" href="/assets/1058-ä¸‘æ•°.html-CHVhcPo9.js" as="script"><link rel="prefetch" href="/assets/1213-disjoint-set.html-Bo5IT9E9.js" as="script"><link rel="prefetch" href="/assets/3743-merge-sort.html-Bsj7ayvR.js" as="script"><link rel="prefetch" href="/assets/ExecutorService.html-cLUzlw4y.js" as="script"><link rel="prefetch" href="/assets/classfile-format.html-DCkshJd9.js" as="script"><link rel="prefetch" href="/assets/log-in-java.html-CSXRFr4J.js" as="script"><link rel="prefetch" href="/assets/sync.html-DV_5msdK.js" as="script"><link rel="prefetch" href="/assets/P1106-åˆ æ•°é—®é¢˜.html-qu-g-9cv.js" as="script"><link rel="prefetch" href="/assets/P1175-è¡¨è¾¾å¼çš„è½¬æ¢.html-tFBvpgrt.js" as="script"><link rel="prefetch" href="/assets/P1323-åˆ æ•°é—®é¢˜2.html-CNjhc1Z0.js" as="script"><link rel="prefetch" href="/assets/P1462-é€šå¾€å¥¥æ ¼ç‘ç›çš„é“è·¯.html-D4_9cYsY.js" as="script"><link rel="prefetch" href="/assets/P1807-æœ€é•¿è·¯.html-t5-J9dUT.js" as="script"><link rel="prefetch" href="/assets/P3916-å›¾çš„éå†.html-CmzFKVbd.js" as="script"><link rel="prefetch" href="/assets/difficulties.html-C5Z9BBST.js" as="script"><link rel="prefetch" href="/assets/tricks.html-JuH39b4f.js" as="script"><link rel="prefetch" href="/assets/C2RustSafe.html-CWWmR6qv.js" as="script"><link rel="prefetch" href="/assets/CFHiderï¼šåŸºäºIntel SGXçš„æ§åˆ¶æµæ··æ·†.html-BxCXRlAJ.js" as="script"><link rel="prefetch" href="/assets/Do-not-Write-but-Return.html--p3lQDXG.js" as="script"><link rel="prefetch" href="/assets/EVOC2RUSTï¼šç”¨äºé¡¹ç›®çº§Cåˆ°Rustè½¬æ¢çš„éª¨æ¶å¼•å¯¼æ¡†æ¶.html-o3gTp89A.js" as="script"><link rel="prefetch" href="/assets/Emerging_Threat_of_Web-Enabled_LLMs.html-BKVcA9Qr.js" as="script"><link rel="prefetch" href="/assets/Ownership_Guided_C_to_Rust_Translation.html-DKHWgyu3.js" as="script"><link rel="prefetch" href="/assets/RansomSentryï¼šä½¿ç”¨åŸºäºç¼–è¯‘å™¨çš„æ£€æµ‹å·¥å…·å¯¹Androidå‹’ç´¢è½¯ä»¶è¿›è¡Œè¿è¡Œæ—¶æ£€æµ‹.html-DtULCUpS.js" as="script"><link rel="prefetch" href="/assets/RustSanï¼šRetrofitting AddressSanitizer for Efficient Sanitization of Rust.html-BpHO0hbu.js" as="script"><link rel="prefetch" href="/assets/Translingual_Obfuscation.html-DMkxkAjc.js" as="script"><link rel="prefetch" href="/assets/å…³äºLLMåº”ç”¨ç¨‹åºå•†åº—çš„ï¼ˆå†…éƒ¨ï¼‰å®‰å…¨æ€§.html-DTOqwCvZ.js" as="script"><link rel="prefetch" href="/assets/åæ··æ·†ï¼šé€†å‘æ··æ·†åçš„ä»£ç .html-S27kGuXi.js" as="script"><link rel="prefetch" href="/assets/åŸºäºè½¯ä»¶çš„ç”Ÿå­˜æœºåˆ¶ä¿æŠ¤.html-R8Jn9kVd.js" as="script"><link rel="prefetch" href="/assets/è‡ªåŠ¨ç¨‹åºç¿»è¯‘çš„ç¨‹åºéª¨æ¶.html-D2A21PVx.js" as="script"><link rel="prefetch" href="/assets/é€šè¿‡è¯­ä¹‰ä¿æŒä»£ç è½¬æ¢æŒ‘æˆ˜åŸºäºæœºå™¨å­¦ä¹ çš„å…‹éš†æ£€æµ‹å™¨.html-BYR0OUUC.js" as="script"><link rel="prefetch" href="/assets/é€šè¿‡é™æ€åˆ†ææ”¹è¿›è‡ªåŠ¨Cåˆ°Rustçš„è½¬æ¢.html-D_0kEfBu.js" as="script"><link rel="prefetch" href="/assets/WSL-memo.html-DCB5rPP1.js" as="script"><link rel="prefetch" href="/assets/centos.html-BxxmFU6D.js" as="script"><link rel="prefetch" href="/assets/docker-in-WSL.html-C5Wh1hEI.js" as="script"><link rel="prefetch" href="/assets/kali-linux-in-WSL.html-DkQbgKkf.js" as="script"><link rel="prefetch" href="/assets/kali-wsl-autostart.html-D30qdnLP.js" as="script"><link rel="prefetch" href="/assets/ssh-in-WSL.html-B8zYSsUm.js" as="script"><link rel="prefetch" href="/assets/404.html-zohBZMoo.js" as="script"><link rel="prefetch" href="/assets/index.html-CPYrZFqr.js" as="script"><link rel="prefetch" href="/assets/index.html-C0bbhu2L.js" as="script"><link rel="prefetch" href="/assets/index.html-BQXaIJFy.js" as="script"><link rel="prefetch" href="/assets/index.html-BdA7i2AR.js" as="script"><link rel="prefetch" href="/assets/index.html-BnJHiJyj.js" as="script"><link rel="prefetch" href="/assets/index.html-DtiDUlI5.js" as="script"><link rel="prefetch" href="/assets/index.html-CtxROO1B.js" as="script"><link rel="prefetch" href="/assets/index.html-MHCCJWmr.js" as="script"><link rel="prefetch" href="/assets/index.html-DWrcWSsO.js" as="script"><link rel="prefetch" href="/assets/index.html-BiNKz-GL.js" as="script"><link rel="prefetch" href="/assets/index.html-Casryd2j.js" as="script"><link rel="prefetch" href="/assets/index.html-DRhaTTnH.js" as="script"><link rel="prefetch" href="/assets/index.html-CdsudAHA.js" as="script"><link rel="prefetch" href="/assets/index.html-DmGRL50B.js" as="script"><link rel="prefetch" href="/assets/index.html-hsCD7Udx.js" as="script"><link rel="prefetch" href="/assets/index.html-CzMTxckl.js" as="script"><link rel="prefetch" href="/assets/index.html-BpkdT5np.js" as="script"><link rel="prefetch" href="/assets/index.html-46exaPIv.js" as="script"><link rel="prefetch" href="/assets/index.html-Cnjb7An1.js" as="script"><link rel="prefetch" href="/assets/index.html-BRglCCLQ.js" as="script"><link rel="prefetch" href="/assets/index.html-OuY3sveA.js" as="script"><link rel="prefetch" href="/assets/index.html-BP6zcmqg.js" as="script"><link rel="prefetch" href="/assets/index.html-B0KTRjzV.js" as="script"><link rel="prefetch" href="/assets/index.html-jP6kg7y7.js" as="script"><link rel="prefetch" href="/assets/index.html-DvGib5f5.js" as="script"><link rel="prefetch" href="/assets/index.html-DYAtKYkZ.js" as="script"><link rel="prefetch" href="/assets/index.html-BP81WpFb.js" as="script"><link rel="prefetch" href="/assets/index.html-MvYdeYBB.js" as="script"><link rel="prefetch" href="/assets/index.html-wfJ4Hx0W.js" as="script"><link rel="prefetch" href="/assets/index.html-DlJqovvn.js" as="script"><link rel="prefetch" href="/assets/index.html-x8p6IZ6z.js" as="script"><link rel="prefetch" href="/assets/index.html-c-l2zCDK.js" as="script"><link rel="prefetch" href="/assets/index.html-8ig91lJj.js" as="script"><link rel="prefetch" href="/assets/index.html-hP1fCrms.js" as="script"><link rel="prefetch" href="/assets/index.html-C_CsbPI_.js" as="script"><link rel="prefetch" href="/assets/index.html-Cv3my_2f.js" as="script"><link rel="prefetch" href="/assets/index.html-COZTZfA1.js" as="script"><link rel="prefetch" href="/assets/index.html-BaDOVtZx.js" as="script"><link rel="prefetch" href="/assets/index.html-cQpDJW9c.js" as="script"><link rel="prefetch" href="/assets/index.html-X1H_43jx.js" as="script"><link rel="prefetch" href="/assets/index.html-Chrk3uMu.js" as="script"><link rel="prefetch" href="/assets/index.html-BV666P_x.js" as="script"><link rel="prefetch" href="/assets/index.html-DdeI2KrF.js" as="script"><link rel="prefetch" href="/assets/index.html-Cva38TIH.js" as="script"><link rel="prefetch" href="/assets/index.html-CPtRoGT6.js" as="script"><link rel="prefetch" href="/assets/index.html-CaTmEVfW.js" as="script"><link rel="prefetch" href="/assets/index.html-DpyKu03X.js" as="script"><link rel="prefetch" href="/assets/index.html-gFaNCp16.js" as="script"><link rel="prefetch" href="/assets/index.html-D5hxWuXM.js" as="script"><link rel="prefetch" href="/assets/index.html-DDfQ30J8.js" as="script"><link rel="prefetch" href="/assets/index.html-DMwIwKud.js" as="script"><link rel="prefetch" href="/assets/index.html-DvZftzyy.js" as="script"><link rel="prefetch" href="/assets/index.html-C2XqvR-Q.js" as="script"><link rel="prefetch" href="/assets/index.html-DX60_U4g.js" as="script"><link rel="prefetch" href="/assets/index.html-DUU3kuTz.js" as="script"><link rel="prefetch" href="/assets/index.html-DSP2r1Nv.js" as="script"><link rel="prefetch" href="/assets/index.html-3TjIVXY9.js" as="script"><link rel="prefetch" href="/assets/index.html-BPfPRhLk.js" as="script"><link rel="prefetch" href="/assets/index.html-C0U-5mvc.js" as="script"><link rel="prefetch" href="/assets/index.html-H3yurbiL.js" as="script"><link rel="prefetch" href="/assets/index.html-DaZgABCr.js" as="script"><link rel="prefetch" href="/assets/index.html-9YMo9apA.js" as="script"><link rel="prefetch" href="/assets/index.html-KWQV4rq0.js" as="script"><link rel="prefetch" href="/assets/index.html-CpLUbORR.js" as="script"><link rel="prefetch" href="/assets/index.html-BlxSbAiV.js" as="script"><link rel="prefetch" href="/assets/index.html-BSoHxJBL.js" as="script"><link rel="prefetch" href="/assets/index.html-D--UDmL0.js" as="script"><link rel="prefetch" href="/assets/index.html-BPq9betF.js" as="script"><link rel="prefetch" href="/assets/giscus-BZxmVUME.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-GXRgw7eJ.js" as="script"><link rel="prefetch" href="/assets/SearchResult-CMdSvCtX.js" as="script"><link rel="prefetch" href="/assets/setupDevtools-7MC2TMWH-B9WsZDo8.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/" aria-label="å¸¦æˆ‘å›å®¶"><img class="vp-nav-logo" src="/assets/icon/xmn.png" alt><!----><span class="vp-site-name hide-in-pad">Xanadu13&#39;s Blog</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="åšå®¢ä¸»é¡µ"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->åšå®¢ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/article/" aria-label="æ–‡ç« "><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->æ–‡ç« <!----></a></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/iXanadu13/iXanadu13.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="slimsearch-button" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="slimsearch-placeholder">æœç´¢</div><div class="slimsearch-key-hints"><kbd class="slimsearch-key">Ctrl</kbd><kbd class="slimsearch-key">K</kbd></div></button><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/" aria-label="åšå®¢ä¸»é¡µ"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->åšå®¢ä¸»é¡µ<!----></a></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header active"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">æ–‡ç« </span><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Algo</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Codeforces</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Cpp</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Database</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Hdoj</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Java</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/linux-cmd.html" aria-label="LinuxæŒ‡ä»¤å¤‡å¿˜å½•"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->LinuxæŒ‡ä»¤å¤‡å¿˜å½•<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Luogu</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/nodejs.html" aria-label="Nodejsä¸­æŠ¥é”™â€œError: spawn EINVALâ€"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Nodejsä¸­æŠ¥é”™â€œError: spawn EINVALâ€<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/install-rabbitmq.html" aria-label="RabbitMQå®‰è£…è¸©å‘è®°å½•"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->RabbitMQå®‰è£…è¸©å‘è®°å½•<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Rust</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Scholar</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/CFHider%EF%BC%9A%E5%9F%BA%E4%BA%8EIntel%20SGX%E7%9A%84%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B7%B7%E6%B7%86.html" aria-label="CFHider: Control Flow Obfuscation with Intel SGX"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->CFHider: Control Flow Obfuscation with Intel SGX<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/%E9%80%9A%E8%BF%87%E8%AF%AD%E4%B9%89%E4%BF%9D%E6%8C%81%E4%BB%A3%E7%A0%81%E8%BD%AC%E6%8D%A2%E6%8C%91%E6%88%98%E5%9F%BA%E4%BA%8E%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%9A%84%E5%85%8B%E9%9A%86%E6%A3%80%E6%B5%8B%E5%99%A8.html" aria-label="Challenging Machine Learning-based Clone Detectors via Semantic-preserving Code Transformations"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Challenging Machine Learning-based Clone Detectors via Semantic-preserving Code Transformations<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/%E5%8F%8D%E6%B7%B7%E6%B7%86%EF%BC%9A%E9%80%86%E5%90%91%E6%B7%B7%E6%B7%86%E5%90%8E%E7%9A%84%E4%BB%A3%E7%A0%81.html" aria-label="Deobfuscation: Reverse Engineering Obfuscated Code"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Deobfuscation: Reverse Engineering Obfuscated Code<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/Do-not-Write-but-Return.html" aria-label="Donâ€™t Write, but Return: Replacing Output Parameters with Algebraic Data Types in C-to-Rust Translation"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Donâ€™t Write, but Return: Replacing Output Parameters with Algebraic Data Types in C-to-Rust Translation<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/EVOC2RUST%EF%BC%9A%E7%94%A8%E4%BA%8E%E9%A1%B9%E7%9B%AE%E7%BA%A7C%E5%88%B0Rust%E8%BD%AC%E6%8D%A2%E7%9A%84%E9%AA%A8%E6%9E%B6%E5%BC%95%E5%AF%BC%E6%A1%86%E6%9E%B6.html" aria-label="EVOC2RUST: A Skeleton-guided Framework for Project-Level C-to-Rust Translation"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->EVOC2RUST: A Skeleton-guided Framework for Project-Level C-to-Rust Translation<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/%E9%80%9A%E8%BF%87%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E6%94%B9%E8%BF%9B%E8%87%AA%E5%8A%A8C%E5%88%B0Rust%E7%9A%84%E8%BD%AC%E6%8D%A2.html" aria-label="Improving Automatic C-to-Rust Translation with Static Analysis"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Improving Automatic C-to-Rust Translation with Static Analysis<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/C2RustSafe.html" aria-label="In Rust We Trust â€“ A Transpiler from Unsafe C to Safer Rust"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->In Rust We Trust â€“ A Transpiler from Unsafe C to Safer Rust<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/%E5%85%B3%E4%BA%8ELLM%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%95%86%E5%BA%97%E7%9A%84%EF%BC%88%E5%86%85%E9%83%A8%EF%BC%89%E5%AE%89%E5%85%A8%E6%80%A7.html" aria-label="On the (In)Security of LLM App Stores"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->On the (In)Security of LLM App Stores<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/Ownership_Guided_C_to_Rust_Translation.html" aria-label="Ownership Guided C to Rust Translation"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Ownership Guided C to Rust Translation<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/%E8%87%AA%E5%8A%A8%E7%A8%8B%E5%BA%8F%E7%BF%BB%E8%AF%91%E7%9A%84%E7%A8%8B%E5%BA%8F%E9%AA%A8%E6%9E%B6.html" aria-label="Program Skeletons for Automated Program Translation"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Program Skeletons for Automated Program Translation<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/RansomSentry%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E7%BC%96%E8%AF%91%E5%99%A8%E7%9A%84%E6%A3%80%E6%B5%8B%E5%B7%A5%E5%85%B7%E5%AF%B9Android%E5%8B%92%E7%B4%A2%E8%BD%AF%E4%BB%B6%E8%BF%9B%E8%A1%8C%E8%BF%90%E8%A1%8C%E6%97%B6%E6%A3%80%E6%B5%8B.html" aria-label="RansomSentry: Runtime Detection of Android Ransomware With Compiler-Based Instrumentation"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->RansomSentry: Runtime Detection of Android Ransomware With Compiler-Based Instrumentation<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/RustSan%EF%BC%9ARetrofitting%20AddressSanitizer%20for%20Efficient%20Sanitization%20of%20Rust.html" aria-label="RustSan: Retrofitting AddressSanitizer for Efficient Sanitization of Rust"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->RustSan: Retrofitting AddressSanitizer for Efficient Sanitization of Rust<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/Translingual_Obfuscation.html" aria-label="Translingual Obfuscation"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Translingual Obfuscation<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/Emerging_Threat_of_Web-Enabled_LLMs.html" aria-label="When LLMs Go Online: The Emerging Threat of Web-Enabled LLMs"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->When LLMs Go Online: The Emerging Threat of Web-Enabled LLMs<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/posts/scholar/Wobfuscator%EF%BC%9A%E9%80%9A%E8%BF%87%E9%80%89%E6%8B%A9%E6%80%A7%E5%9C%B0%E7%BF%BB%E8%AF%91%E5%88%B0WASM%E6%9D%A5%E6%B7%B7%E6%B7%86JavaScript%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6.html" aria-label="Wobfuscator: Obfuscating JavaScript Malware via Opportunistic Translation to WebAssembly"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Wobfuscator: Obfuscating JavaScript Malware via Opportunistic Translation to WebAssembly<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/%E5%9F%BA%E4%BA%8E%E8%BD%AF%E4%BB%B6%E7%9A%84%E7%94%9F%E5%AD%98%E6%9C%BA%E5%88%B6%E4%BF%9D%E6%8A%A4.html" aria-label="åŸºäºè½¯ä»¶çš„ç”Ÿå­˜æœºåˆ¶ä¿æŠ¤"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->åŸºäºè½¯ä»¶çš„ç”Ÿå­˜æœºåˆ¶ä¿æŠ¤<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Wsl</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/yapi.html" aria-label="Yapiå®‰è£…æ•™ç¨‹"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Yapiå®‰è£…æ•™ç¨‹<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/vmware-macOS.html" aria-label="åœ¨VMwareä¸­å®‰è£…MacOSè™šæ‹Ÿæœº"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->åœ¨VMwareä¸­å®‰è£…MacOSè™šæ‹Ÿæœº<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/compiler_principle.html" aria-label="ç¼–è¯‘åŸç†æœŸæœ«å¤ä¹ ç¬”è®°"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->ç¼–è¯‘åŸç†æœŸæœ«å¤ä¹ ç¬”è®°<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/%E5%8E%BB%E8%99%9A%E6%8B%9F%E5%8C%96.html" aria-label="è™šæ‹Ÿæœºå»è™šæ‹ŸåŒ–"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->è™šæ‹Ÿæœºå»è™šæ‹ŸåŒ–<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/tsconfig-json-error.html" aria-label="è§£å†³vscodeæŠ¥é”™ï¼šæ‰¾ä¸åˆ°â€œcookieâ€çš„ç±»å‹å®šä¹‰æ–‡ä»¶ã€‚ç¨‹åºåŒ…å«è¯¥æ–‡ä»¶æ˜¯å› ä¸º: éšå¼ç±»å‹åº“ &quot;cookie&quot; çš„å…¥å£ç‚¹ts"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->è§£å†³vscodeæŠ¥é”™ï¼šæ‰¾ä¸åˆ°â€œcookieâ€çš„ç±»å‹å®šä¹‰æ–‡ä»¶ã€‚ç¨‹åºåŒ…å«è¯¥æ–‡ä»¶æ˜¯å› ä¸º: éšå¼ç±»å‹åº“ &quot;cookie&quot; çš„å…¥å£ç‚¹ts<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/ensp-win11.html" aria-label="è§£å†³åœ¨windows 11ä¸­æ— æ³•ä½¿ç”¨eNSPçš„é—®é¢˜"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->è§£å†³åœ¨windows 11ä¸­æ— æ³•ä½¿ç”¨eNSPçš„é—®é¢˜<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/git.html" aria-label="è®°å½•æœ‰å…³Gitçš„å‘½ä»¤"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->è®°å½•æœ‰å…³Gitçš„å‘½ä»¤<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/interview.html" aria-label="é¢è¯•çœŸé¢˜æ•´ç†"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->é¢è¯•çœŸé¢˜æ•´ç†<!----></a></li></ul></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/intro.html" aria-label="ä»‹ç»é¡µ"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span><!--]-->ä»‹ç»é¡µ<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>Wobfuscator: Obfuscating JavaScript Malware via Opportunistic Translation to WebAssembly</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/iXanadu13" target="_blank" rel="noopener noreferrer">Xanadu13</a></span><span property="author" content="Xanadu13"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2025å¹´9æœˆ22æ—¥</span><meta property="datePublished" content="2025-09-22T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 56 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT56M"></span><!----><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color6 clickable" role="navigation">Obfuscate</span><!--]--><meta property="keywords" content="Obfuscate"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc" vp-toc><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#æ‘˜è¦">æ‘˜è¦</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1-introduction">1. Introduction</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-webassemblyçš„èƒŒæ™¯">2. WebAssemblyçš„èƒŒæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_3-å¨èƒæ¨¡å‹-threat-model">3. å¨èƒæ¨¡å‹ï¼ˆTHREAT MODELï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4-æ–¹æ³•">4. æ–¹æ³•</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#a-overview-and-challenges">A. Overview and Challenges</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#b-å˜æ¢-transformations">B. å˜æ¢ï¼ˆTransformationsï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#c-åŒæ­¥ä¸å¼‚æ­¥çš„-webassembly-å®ä¾‹åŒ–">C. åŒæ­¥ä¸å¼‚æ­¥çš„ WebAssembly å®ä¾‹åŒ–</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#d-åº”ç”¨å˜æ¢-applying-transformations">D. åº”ç”¨å˜æ¢ï¼ˆApplying Transformationsï¼‰</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_5-å®ç°">5. å®ç°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_6-è¯„ä¼°">6. è¯„ä¼°</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#a-å®éªŒé…ç½®">A. å®éªŒé…ç½®</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#b-èº²é¿æ¢æµ‹çš„æœ‰æ•ˆæ€§-rq1">B. èº²é¿æ¢æµ‹çš„æœ‰æ•ˆæ€§ï¼ˆRQ1ï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#c-è½¬æ¢çš„æ­£ç¡®æ€§-rq2">C. è½¬æ¢çš„æ­£ç¡®æ€§ï¼ˆRQ2ï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#d-è¿è¡Œæ—¶å’Œä»£ç å¤§å°æ–¹é¢çš„æ•ˆç‡-rq3">D. è¿è¡Œæ—¶å’Œä»£ç å¤§å°æ–¹é¢çš„æ•ˆç‡ï¼ˆRQ3ï¼‰</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_7-discussion">7. Discussion</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#a-limitations">A. Limitations</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#b-mitigations">B. Mitigations</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_8-ç›¸å…³å·¥ä½œ">8. ç›¸å…³å·¥ä½œ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_9-ç»“è®º">9. ç»“è®º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#references">References</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#citations">Citations</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#xmal-a-lightweight-memory-based-explainable-obfuscated-malware-detector">XMal: A lightweight memory-based explainable obfuscated-malware detector</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#finding-the-dwarf-recovering-precise-types-from-webassembly-binaries">Finding the Dwarf: Recovering Precise Types from WebAssembly Binaries</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content" vp-content><h1 id="wobfuscator-obfuscating-javascript-malware-via-opportunistic-translation-to-webassembly" tabindex="-1"><a class="header-anchor" href="#wobfuscator-obfuscating-javascript-malware-via-opportunistic-translation-to-webassembly"><span>Wobfuscator: Obfuscating JavaScript Malware via Opportunistic Translation to WebAssembly</span></a></h1><p>è®ºæ–‡æ¥è‡ª 2022 IEEE Symposium on Security and Privacy (SP 2022) çš„ã€Š<a href="https://ieeexplore.ieee.org/abstract/document/9833626/" target="_blank" rel="noopener noreferrer">Wobfuscator: Obfuscating JavaScript Malware via Opportunistic Translation to WebAssembly</a>ã€‹ã€‚</p><h2 id="æ‘˜è¦" tabindex="-1"><a class="header-anchor" href="#æ‘˜è¦"><span>æ‘˜è¦</span></a></h2><p>ä¸ºäº†ä¿æŠ¤webç”¨æˆ·å…å—æ¶æ„JavaScriptä»£ç çš„æ”»å‡»ï¼Œå·²ç»æå‡ºäº†å„ç§æ¶æ„è½¯ä»¶æ£€æµ‹å™¨ï¼Œå®ƒä»¬å¯ä»¥åˆ†æå’Œåˆ†ç±»ä»£ç ä¸ºæ¶æ„æˆ–è‰¯æ€§ã€‚æœ€å…ˆè¿›çš„æ£€æµ‹å™¨ä¸“æ³¨äºJavaScriptä½œä¸ºå”¯ä¸€çš„ç›®æ ‡è¯­è¨€ã€‚</p><p>ç„¶è€Œï¼ŒWebAssemblyä¸ºæ”»å‡»è€…æä¾›äº†ä¸€ä¸ªæ–°çš„ã€è¿„ä»Šä¸ºæ­¢å°šæœªæ¢ç´¢çš„èº²é¿æ¶æ„è½¯ä»¶æ£€æµ‹å™¨çš„æœºä¼šã€‚æœ¬æ–‡ä»‹ç»äº†Wobfuscatorï¼Œè¿™æ˜¯ç¬¬ä¸€ç§é€šè¿‡å°†è®¡ç®—éƒ¨åˆ†ç§»åŠ¨åˆ°WebAssemblyä¸­æ¥é€ƒé¿é™æ€JavaScriptæ¶æ„è½¯ä»¶æ£€æµ‹çš„æŠ€æœ¯ã€‚è¯¥æŠ€æœ¯çš„æ ¸å¿ƒæ˜¯ä¸€ç»„ä»£ç è½¬æ¢ï¼Œå°†JavaScriptä¸­ç²¾å¿ƒé€‰æ‹©çš„è¡Œä¸ºéƒ¨åˆ†è½¬æ¢ä¸ºWebAssemblyã€‚è¿™ç§æ–¹æ³•æ˜¯æœºä¼šä¸»ä¹‰çš„ï¼Œå› ä¸ºå®ƒä½¿ç”¨WebAssemblyï¼Œåœ¨ä¸æŸå®³ä»£ç æ­£ç¡®æ€§çš„æƒ…å†µä¸‹å¸®åŠ©é€ƒé¿æ¶æ„è½¯ä»¶æ£€æµ‹ã€‚ä½¿ç”¨43499ä¸ªæ¶æ„JavaScriptæ–‡ä»¶å’Œ149677ä¸ªè‰¯æ€§JavaScriptæ–‡ä»¶ä»¥åŠå…­ä¸ªæµè¡Œçš„JavaScriptåº“çš„æ•°æ®é›†è¯„ä¼°æˆ‘ä»¬çš„æ–¹æ³•ï¼Œç»“æœè¡¨æ˜æˆ‘ä»¬çš„æ–¹æ³•å¯ä»¥æœ‰æ•ˆåœ°é¿å¼€æœ€å…ˆè¿›çš„åŸºäºå­¦ä¹ çš„é™æ€æ¶æ„è½¯ä»¶æ£€æµ‹å™¨ï¼›ä¸”æ··æ·†åè¯­ä¹‰ä¸å˜ï¼›è€Œä¸”æˆ‘ä»¬çš„æ–¹æ³•å¼€é”€å¾ˆå°ï¼Œä½¿å…¶åœ¨ç°å®ä¸–ç•Œçš„ç¨‹åºä¸­å…·æœ‰å®ç”¨æ€§ã€‚é€šè¿‡æŒ‡å‡ºå½“å‰æ¶æ„è½¯ä»¶æ£€æµ‹å™¨çš„å±€é™æ€§ï¼Œæˆ‘ä»¬çš„å·¥ä½œæ¿€åŠ±äº†æœªæ¥æ£€æµ‹ç½‘ç»œä¸­å¤šè¯­è¨€æ¶æ„è½¯ä»¶çš„åŠªåŠ›ã€‚</p><h2 id="_1-introduction" tabindex="-1"><a class="header-anchor" href="#_1-introduction"><span>1. Introduction</span></a></h2><p>webçš„æ— å¤„ä¸åœ¨ä½¿å®¢æˆ·ç«¯webåº”ç”¨ç¨‹åºæˆä¸ºæ”»å‡»è€…çš„ä¸€ä¸ªæœ‰å¸å¼•åŠ›çš„ç›®æ ‡ã€‚å› æ­¤ï¼Œå„ç§ç±»å‹çš„æ”»å‡»éƒ½é’ˆå¯¹æµè§ˆå™¨ï¼Œä¾‹å¦‚ï¼Œç”±æ¶æ„è½¯ä»¶é©±åŠ¨çš„æ”»å‡»[48]ã€[23]ã€[43]ã€é€šè¿‡åŸºäºè„šæœ¬çš„æµè§ˆå™¨å¢å¼ºå¸‚åœºéƒ¨ç½²çš„æ¶æ„ä»£ç [58]ã€æœªç»ç”¨æˆ·åŒæ„çš„åŸºäºæµè§ˆå™¨çš„åŠ å¯†æŒ–æ˜[40]ã€[52]ã€[34]ã€æ¶æ„æµè§ˆå™¨æ‰©å±•[21]ã€[65]å’ŒåŸºäºæµè§ˆå™¨çš„ç½‘ç»œé’“é±¼[14]ã€‚æœ€è¿‘çš„ä¸€ä»½æŠ¥å‘Šä¼°è®¡ï¼Œä»…ç²¾å¿ƒç­–åˆ’çš„ç½‘ç»œé’“é±¼æ´»åŠ¨æ¯æœˆå°±ä¼šäº§ç”Ÿ170ä¸‡åˆ°200ä¸‡ä¸ªæ¶æ„æœ‰æ•ˆè½½è·ç½‘å€[44]ã€‚é™¤äº†è¿™äº›æ˜æ˜¾çš„æ¶æ„æ´»åŠ¨å¤–ï¼Œè®¸å¤šç½‘ç«™è¿˜é‡‡ç”¨äº†ç”¨æˆ·ä¸æƒ³è¦çš„æŠ€æœ¯ï¼Œä¾‹å¦‚å¹¿æ³›çš„æµè§ˆå™¨æŒ‡çº¹è¯†åˆ«[30]æˆ–è·Ÿè¸ª[25]ã€‚</p><p>ä¸ºäº†ä¿æŠ¤ç”¨æˆ·å…å—åœ¨æµè§ˆå™¨ä¸­æ‰§è¡Œæ¶æ„è„šæœ¬çš„ä¾µå®³ï¼ŒJavaScriptæ¶æ„è½¯ä»¶æ£€æµ‹å™¨ä¼šåœ¨æ‰§è¡Œè¿™äº›è„šæœ¬ä¹‹å‰æˆ–æœŸé—´å‘å‡ºè­¦å‘Šã€‚ä¸€è¡Œå·¥ä½œåœ¨è„šæœ¬æ‰§è¡Œä¹‹å‰å¯¹å…¶è¿›è¡Œé™æ€åˆ†æ[24]ã€[50]ã€[56]ã€[28]ã€[27]ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡æ‹¦æˆªç½‘ç»œä¸­å·²æœ‰çš„è„šæœ¬ã€ä½œä¸ºæµè§ˆå™¨çš„ä¸€éƒ¨åˆ†æˆ–ä½œä¸ºå•ç‹¬çš„åç—…æ¯’å·¥å…·çš„ä¸€éƒ¨åˆ†ã€‚å¦ä¸€é¡¹å·¥ä½œæ˜¯åŠ¨æ€åˆ†æè„šæœ¬[36]ï¼Œä¾‹å¦‚é€šè¿‡æ£€æµ‹ä»£ç æˆ–é€šè¿‡æµè§ˆå™¨æ‰©å±•ã€‚ä¸ºäº†å‡å°‘åŸºäºåŠ¨æ€åˆ†æçš„æ¶æ„è½¯ä»¶æ£€æµ‹å™¨å¸¦æ¥çš„è¿è¡Œæ—¶å¼€é”€ï¼Œé™æ€æ£€æµ‹å™¨é€šå¸¸ä½œä¸ºç¬¬ä¸€é“é˜²çº¿ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡ä»…åŠ¨æ€åˆ†æé™æ€åˆ†æè®¤ä¸ºå±é™©çš„è„šæœ¬ã€‚</p><p>ä¸ºäº†åœ¨æ¶æ„è½¯ä»¶æ£€æµ‹å™¨å­˜åœ¨çš„æƒ…å†µä¸‹æœ‰æ•ˆåœ°æ”»å‡»ç”¨æˆ·ï¼Œæ”»å‡»è€…è¯•å›¾é€šè¿‡æ··æ·†å’Œè§„é¿æŠ€æœ¯æ¥éšè—è„šæœ¬çš„æ¶æ„æ€§[53]ï¼Œ[55]ã€‚æ”»å‡»è€…å’Œé˜²å¾¡è€…çš„è¿›æ­¥å¯¼è‡´äº†æ—¥ç›Šå¤æ‚çš„æ··æ·†å’Œè§„é¿æŠ€æœ¯ä¸æ—¥ç›Šæœ‰æ•ˆçš„æ¶æ„è½¯ä»¶æ£€æµ‹å™¨ä¹‹é—´çš„å†›å¤‡ç«èµ›ã€‚ç›®å‰ï¼Œæœ€æœ‰æ•ˆçš„æ¶æ„è½¯ä»¶æ£€æµ‹æŠ€æœ¯ä½¿ç”¨åŸºäºå­¦ä¹ çš„åˆ†ç±»å™¨æ¥åŒºåˆ†æ¶æ„è„šæœ¬å’Œè‰¯æ€§è„šæœ¬[24]ï¼Œ[50]ï¼Œ[28]ï¼Œ[27]ã€‚è¿™äº›æ–¹æ³•ä»ç»™å®šçš„JavaScriptæ–‡ä»¶ä¸­æå–ä¸€ç»„ç‰¹å¾ï¼Œä¾‹å¦‚nå…ƒä»£ç ä»¤ç‰Œï¼ˆn-grams of code tokensï¼‰æˆ–åŸºäºASTçš„ç‰¹å¾ï¼Œæˆ–è€…å°†JavaScriptä»£ç è¾“å…¥æ·±åº¦ç¥ç»ç½‘ç»œ[63]ï¼Œä»¥ç¡®å®šè¯¥æ–‡ä»¶æ˜¯å¦å¯èƒ½æ˜¯æ¶æ„çš„ã€‚</p><p>è™½ç„¶å…³æ³¨JavaScriptåœ¨å†å²ä¸Šæ˜¯æœ‰æ„ä¹‰çš„ï¼Œä½†JavaScriptä¸å†æ˜¯å®¢æˆ·ç«¯webçš„å”¯ä¸€è¯­è¨€ã€‚WebAssembly[31]æ˜¯å¦ä¸€ç§åœ¨æµè§ˆå™¨ä¸­å¹¿æ³›ä½¿ç”¨çš„è¯­è¨€ã€‚WebAssemblyäº2015å¹´é¦–æ¬¡å®£å¸ƒï¼Œè‡ª2017å¹´11æœˆä»¥æ¥ï¼Œæ‰€æœ‰ä¸»è¦æµè§ˆå™¨éƒ½æ”¯æŒWebAssemblysï¼Œæˆªè‡³2021å¹´8æœˆï¼Œå…¨çƒ94%çš„æµè§ˆå™¨å®‰è£…éƒ½æ”¯æŒå®ƒã€‚è¯¥è¯­è¨€ä¸ºç”¨Cå’ŒC++ç­‰è¯­è¨€ç¼–å†™çš„è®¡ç®—å¯†é›†å‹åº“æä¾›äº†ä¸€ä¸ªé«˜æ•ˆçš„ç¼–è¯‘ç›®æ ‡ã€‚é™¤äº†WebAssemblyçš„è®¸å¤šç§¯æç”¨é€”å¤–ï¼Œè¯¥è¯­è¨€è¿˜ä¸ºæ”»å‡»è€…æä¾›äº†é€ƒé¿æ¶æ„è½¯ä»¶æ£€æµ‹å™¨çš„æ–°æœºä¼šâ€”â€”æ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œè¿™ä¸€æœºä¼šå°šæœªè¢«æ¢ç´¢ã€‚</p><p>æœ¬æ–‡ä»‹ç»äº†ç¬¬ä¸€ç§é€šè¿‡å°†è®¡ç®—éƒ¨åˆ†ç§»åŠ¨åˆ°WebAssemblyä¸­æ¥é€ƒé¿JavaScriptæ¶æ„è½¯ä»¶æ£€æµ‹çš„æŠ€æœ¯ã€‚æˆ‘ä»¬æè¿°äº†Wobfuscatorï¼Œè¿™æ˜¯ä¸€ç§ä»£ç æ··æ·†æŠ€æœ¯ï¼Œå¯ä»¥å°†ç»™å®šçš„JavaScriptæ–‡ä»¶è½¬æ¢ä¸ºæ–°çš„JavaScriptæ–‡ä»¶å’Œä¸€ç»„WebAssemblyæ¨¡å—ã€‚é€šè¿‡æ›´æ”¹æ¶æ„JavaScriptä»£ç ï¼Œæˆ‘ä»¬çš„å·¥ä½œæ—¨åœ¨é¿å¼€é™æ€æ¶æ„è½¯ä»¶æ£€æµ‹å™¨ã€‚å…¶åŸºæœ¬åŸç†æ˜¯ï¼Œé™æ€æ£€æµ‹å™¨å¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºè„šæœ¬åŠ¨æ€åˆ†æçš„è¿‡æ»¤å™¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œèº²é¿é™æ€æ¶æ„è½¯ä»¶æ£€æµ‹å™¨ä¸ºæ”»å‡»è€…å¸¦æ¥äº†å·¨å¤§çš„å¥½å¤„ã€‚</p><p>å°†JavaScriptæ–‡ä»¶çš„ä¸€éƒ¨åˆ†è½¬æ¢ä¸ºWebAssemblyç»éæ˜“äº‹ã€‚JavaScriptæ˜¯åŠ¨æ€ç±»å‹çš„ï¼Œå…·æœ‰å¤æ‚çš„å¯¹è±¡ï¼Œå¹¶æä¾›å¯¹æµè§ˆå™¨APIçš„ç›´æ¥è®¿é—®ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒWebAssemblyæ˜¯é™æ€ç±»å‹çš„ï¼Œåªæœ‰å››ç§ä½çº§åŸå§‹æ•°æ®ç±»å‹ï¼Œå¹¶ä¸”åªèƒ½é€šè¿‡ä»JavaScriptå¯¼å…¥æ¥é—´æ¥è®¿é—®æµè§ˆå™¨APIã€‚ç”±äºè¿™äº›æ ¹æœ¬æ€§çš„å·®å¼‚ï¼Œä¸€èˆ¬çš„JavaScriptåˆ°WebAssemblyçš„ç¿»è¯‘å®é™…ä¸Šæ˜¯ä¸å¯èƒ½çš„ï¼Œè¿™åæ˜ åœ¨WebAssemblysä»æœªè¢«å¹æ§ä¸ºJavaScriptçš„æ›¿ä»£å“ï¼Œè€Œæ˜¯ä½œä¸ºä¸€ç§è¡¥å……çš„æ–¹å¼[31]ã€‚</p><p>æœ¬æ–‡çš„æ ¸å¿ƒæŠ€æœ¯è´¡çŒ®æ˜¯ä¸€ç»„ä»£ç è½¬æ¢ï¼Œè¿™äº›è½¬æ¢æå–äº†JavaScriptä¸­ç²¾å¿ƒé€‰æ‹©çš„è¡Œä¸ºéƒ¨åˆ†ï¼Œä»¥è½¬æ¢ä¸ºWebAssemblyã€‚è¿™ç§æ–¹æ³•æ˜¯æœºä¼šä¸»ä¹‰çš„ï¼Œå› ä¸ºå®ƒå°†JavaScriptè½¬æ¢ä¸ºWebAssemblyï¼Œåœ¨ä¸æŸå®³ä»£ç æ­£ç¡®æ€§çš„æƒ…å†µä¸‹ï¼Œå®ƒæœ‰åŠ©äºé¿å¼€æ¶æ„è½¯ä»¶æ£€æµ‹å™¨ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§è½¬æ¢ï¼Œå°†å‡½æ•°è°ƒç”¨æå–åˆ°WebAssemblyæ¨¡å—ä¸­ï¼Œæ··æ·†è„šæœ¬æ˜¯å¦ä»¥åŠä½•æ—¶è°ƒç”¨ç‰¹å®šå‡½æ•°ã€‚å…¶ä»–è½¬æ¢æ—¨åœ¨æ··æ·†å­—ç¬¦ä¸²æ–‡å­—ã€æ§åˆ¶æµè¯­å¥å’Œæ•°ç»„åˆå§‹åŒ–ã€‚å‰ææ¡ä»¶ä¿æŠ¤æ¯ä¸ªè½¬æ¢ï¼Œä»¥ç¡®ä¿ä¿ç•™åŸå§‹è¡Œä¸ºï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™æ˜¯æ”»å‡»è€…ä½¿ç”¨æ··æ·†æŠ€æœ¯çš„å…³é”®å±æ€§ã€‚</p><p>æˆ‘ä»¬çš„å·¥ä½œæ¶‰åŠç°æœ‰çš„JavaScriptæ··æ·†æŠ€æœ¯ã€‚ä¾‹å¦‚ï¼ŒFassç­‰äººå°†æ¶æ„ä»£ç èåˆä¸ºè‰¯æ€§ä»£ç ï¼ŒåŒæ—¶ä¿ç•™è‰¯æ€§ä»£ç çš„AST[26]ã€‚ä¸ºäº†æ›´å…¨é¢åœ°äº†è§£æ··æ·†æŠ€æœ¯åŠå…¶æµè¡Œæƒ…å†µï¼Œæˆ‘ä»¬å»ºè®®è¯»è€…å‚è€ƒå…¶ä»–å·¥ä½œ[66]ï¼Œ[55]ã€‚æ‰€æœ‰è¿™äº›æ–¹æ³•éƒ½æ˜¯é€šè¿‡JavaScriptè¯­è¨€ä¸­çš„è½¬æ¢æ¥æ··æ·†ä»£ç çš„ï¼Œè€ŒWobfusctoråˆ™åˆ©ç”¨WebAssemblyçš„å¯ç”¨æ€§ï¼Œé€šè¿‡ç¿»è¯‘JavaScriptä¹‹å¤–çš„ä»£ç æ¥æ··æ·†ä»£ç ã€‚Wangç­‰äººçš„ä¸€ç¯‡è®ºæ–‡åˆ†äº«äº†é€šè¿‡å°†ä¸€ç§è¯­è¨€çš„éƒ¨åˆ†ä»£ç ç¿»è¯‘æˆå¦ä¸€ç§è¯­è¨€æ¥æ··æ·†ç”¨ä¸€ç§è¯­è¨€ç¼–å†™çš„ä»£ç çš„ä¸€èˆ¬æƒ³æ³•[60]ã€‚ç„¶è€Œï¼Œä»–ä»¬æè¿°äº†å°†Cä»£ç éƒ¨åˆ†ç¿»è¯‘æˆPrologï¼Œè¿™å¹¶æ²¡æœ‰è§£å†³é€šè¿‡éƒ¨åˆ†ç¿»è¯‘æˆWebAssemblyæ¥æ··æ·†JavaScriptçš„ç‹¬ç‰¹æŒ‘æˆ˜ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨43499ä¸ªæ¶æ„JavaScriptæ–‡ä»¶å’Œ149677ä¸ªè‰¯æ€§JavaScriptæ–‡ä»¶çš„æ•°æ®é›†ä»¥åŠå…­ä¸ªæµè¡Œçš„JavaScriptåº“æ¥è¯„ä¼°Wobfuscatorã€‚æˆ‘ä»¬çš„ç»“æœæ˜¾ç¤ºå¦‚ä¸‹ã€‚é¦–å…ˆï¼Œè¯¥æ–¹æ³•æœ‰æ•ˆåœ°é¿å¼€äº†æœ€å…ˆè¿›çš„åŸºäºå­¦ä¹ çš„é™æ€æ¶æ„è½¯ä»¶æ£€æµ‹å™¨ï¼šåº”ç”¨æˆ‘ä»¬çš„è½¬æ¢å°†å››ä¸ªç ”ç©¶çš„æ£€æµ‹å™¨[50]ã€[24]ã€[28]ã€[27]çš„å¬å›ç‡åˆ†åˆ«é™ä½åˆ°0.18ã€0.63ã€0.18å’Œ0.00ã€‚å…¶æ¬¡ï¼Œæ··æ·†ä¿ç•™äº†è½¬æ¢ä»£ç çš„è¯­ä¹‰ï¼šæ··æ·†äº†å…­ä¸ªæµè¡Œçš„JavaScriptåº“å¹¶è¿è¡Œäº†å®ƒä»¬çš„2017å¹´æµ‹è¯•ï¼Œç»“æœæ˜¾ç¤ºæµ‹è¯•ä»£ç çš„è¡Œä¸ºæ²¡æœ‰æ˜æ˜¾å˜åŒ–ã€‚æœ€åï¼Œæˆ‘ä»¬å‘ç°æˆ‘ä»¬çš„å·¥å…·å°†æ‰€æœ‰è½¬æ¢åº”ç”¨äºé¡¹ç›®å¹³å‡åªéœ€è¦8.9ç§’ï¼ˆå¹³å‡4152è¡Œä»£ç ï¼‰ï¼Œåœ¨è¿è¡Œæ—¶å¹³å‡å¢åŠ 31.07%çš„å¼€é”€ã€‚æ€»ä½“è€Œè¨€ï¼Œè¿™äº›ç»“æœè¡¨æ˜Wobfuscatoråœ¨ç°å®ä¸–ç•Œçš„ç¨‹åºä¸­æ˜¯å®ç”¨çš„ã€‚</p><p>æ€»ä¹‹ï¼Œæœ¬æ–‡æœ‰ä»¥ä¸‹è´¡çŒ®ï¼š</p><ul><li>ç¬¬ä¸€ç§ä½¿ç”¨WebAssemblyä½œä¸ºæ··æ·†æ¶æ„JavaScriptä»£ç è¡Œä¸ºçš„æ–¹æ³•çš„æŠ€æœ¯ã€‚</li><li>ä¸€ç»„ä»£ç è½¬æ¢ï¼Œå°†ç²¾å¿ƒé€‰æ‹©çš„JavaScriptä»£ç ä½ç½®è½¬æ¢ä¸ºWebAssemblyã€‚</li><li>ç»¼åˆè¯„ä¼°è¡¨æ˜ï¼Œè¯¥æ–¹æ³•æœ‰æ•ˆåœ°é¿å¼€äº†æœ€å…ˆè¿›çš„é™æ€æ¶æ„è½¯ä»¶æ£€æµ‹å™¨ï¼ŒåŒæ—¶ä¿ç•™äº†åŸå§‹ä»£ç çš„è¯­ä¹‰ã€‚</li></ul><p>æˆ‘ä»¬çš„å®éªŒç»“æœå·²å…¬å¼€ï¼šhttps://github.com/js2wasm-obfuscator/translator</p><h2 id="_2-webassemblyçš„èƒŒæ™¯" tabindex="-1"><a class="header-anchor" href="#_2-webassemblyçš„èƒŒæ™¯"><span>2. WebAssemblyçš„èƒŒæ™¯</span></a></h2><p>æˆ‘ä»¬ç®€è¦ä»‹ç»äº†WebAssemblyçš„æ ¸å¿ƒæ¦‚å¿µå’Œè¯­æ³•ã€‚å‡ºäºç¯‡å¹…åŸå› ï¼Œæˆ‘ä»¬å»ºè®®è¯»è€…å‚è€ƒåŸå§‹å‡ºç‰ˆç‰©[31]ã€å®˜æ–¹ç½‘ç«™[10]æˆ–è§„èŒƒ[64]ä»¥è·å–æ›´è¯¦ç»†çš„è§£é‡Šã€‚</p><p>WebAssemblyæ˜¯ä¸€ç§ä½çº§å­—èŠ‚ç è¯­è¨€ã€‚WebAssemblyç¨‹åºä»¥äºŒè¿›åˆ¶æ–‡ä»¶çš„å½¢å¼åˆ†å‘ï¼Œè¿™äº›äºŒè¿›åˆ¶æ–‡ä»¶ç»“æ„ç´§å‡‘ï¼Œå¯ä»¥é€šè¿‡ç½‘ç»œå‘é€ï¼Œè§£æé€Ÿåº¦ä¹Ÿå¾ˆå¿«ã€‚</p><p>æ¯ä¸ªWebAssemblyç¨‹åºéƒ½æ˜¯ä¸€ä¸ªæ–‡ä»¶æ¨¡å—ï¼Œåˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œä»£ç éƒ¨åˆ†åŒ…å«æ‰€æœ‰å‡½æ•°åŠå…¶æ­£æ–‡ã€‚å…¨å±€éƒ¨åˆ†åŒ…å«æ ‡é‡å…¨å±€å˜é‡ã€‚å†…å­˜éƒ¨åˆ†å£°æ˜äº†ä¸€ä¸ªçº¿æ€§çš„ã€å­—èŠ‚å¯å¯»å€çš„å†…å­˜ï¼Œå…¶ä¸­çš„éƒ¨åˆ†å¯ä»¥ç”¨æ•°æ®éƒ¨åˆ†åˆå§‹åŒ–ã€‚</p><p>WebAssemblyæŒ‡ä»¤åœ¨ä½æŠ½è±¡çº§åˆ«ä¸Šè¿è¡Œï¼Œæ²¡æœ‰ç±»æˆ–å¤æ‚å¯¹è±¡ç­‰ã€‚æŒ‡ä»¤å’Œå‡½æ•°æ˜¯é™æ€ç±»å‹çš„ï¼Œä½†åªæœ‰å››ç§åŸºæœ¬ç±»å‹ï¼šåˆ†åˆ«æ˜¯32ä½å’Œ64ä½æ•´æ•°å€¼å’Œæµ®ç‚¹å€¼ã€‚æŒ‡ä»¤åœ¨è™šæ‹Ÿå †æ ˆæœºä¸Šæ‰§è¡Œï¼Œå³å®ƒä»¬å¼¹å‡ºæ“ä½œæ•°å¹¶å°†ç»“æœæ¨é€åˆ°éšå¼è®¡ç®—å †æ ˆä¸Šã€‚æŒ‡ä»¤å¾ˆç®€å•ï¼Œæ—¨åœ¨ä¸ç¡¬ä»¶æŒ‡ä»¤ç´§å¯†æ˜ å°„ï¼Œä¾‹å¦‚ï¼ŒWebAssembly i32.addæŒ‡ä»¤å°†è¢«è½¬æ¢ä¸ºx86 addlã€‚ç”±äºæ²¡æœ‰åƒåœ¾æ”¶é›†å™¨ï¼Œåªæœ‰åŸå§‹æ ‡é‡ç±»å‹ï¼Œå¤æ‚å¯¹è±¡ï¼ˆå­—ç¬¦ä¸²ã€æ•°ç»„ã€è®°å½•ç­‰ï¼‰è¢«å­˜å‚¨åœ¨ç¨‹åºç»„ç»‡çš„çº¿æ€§å†…å­˜ä¸­ï¼Œè¯¥å†…å­˜æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªéç±»å‹åŒ–å­—èŠ‚çš„å¯å¢é•¿æ•°ç»„ã€‚</p><p>WebAssemblyæ²¡æœ‰æ ‡å‡†åº“ï¼Œä¸ºäº†ä¸â€œå¤–éƒ¨ä¸–ç•Œâ€äº¤äº’ï¼ŒWebAssemblysæ¨¡å—éœ€è¦ä»å®¿ä¸»ç¯å¢ƒå¯¼å…¥å‡½æ•°ã€‚åœ¨æµè§ˆå™¨ä¸­ï¼Œå®¿ä¸»ç¯å¢ƒæ˜¯JavaScriptï¼Œå› æ­¤ä»»ä½•JavaScriptå‡½æ•°éƒ½å¯ä»¥ä»WebAssemblyè°ƒç”¨ã€‚ç„¶è€Œï¼ŒéåŸå§‹æ•°æ®éœ€è¦é€šè¿‡WebAssemblyå†…å­˜è¿›è¡Œå°é€ï¼ˆä¹Ÿå¯ä»¥ä»JavaScriptè®¿é—®ï¼‰ã€‚JavaScriptä¸­çš„WebAssembly APIæä¾›äº†ç¼–è¯‘å’Œå®ä¾‹åŒ–ï¼ˆå³å®ç°WebAssemblyæ¨¡å—çš„å¯¼å…¥ï¼‰WebAssemblyå’Œè°ƒç”¨å¯¼å‡ºWebAssemblyå‡½æ•°çš„å‡½æ•°ã€‚</p><h2 id="_3-å¨èƒæ¨¡å‹-threat-model" tabindex="-1"><a class="header-anchor" href="#_3-å¨èƒæ¨¡å‹-threat-model"><span>3. å¨èƒæ¨¡å‹ï¼ˆTHREAT MODELï¼‰</span></a></h2><p>æˆ‘ä»¬çš„å·¥ä½œæ˜¯å…³äºä½œä¸ºå®¢æˆ·ç«¯webåº”ç”¨ç¨‹åºçš„ä¸€éƒ¨åˆ†äº¤ä»˜çš„æ¶æ„æˆ–ä¸éœ€è¦çš„ä»£ç ã€‚ç½‘ç«™å¯èƒ½æ•…æ„ä¼ é€’æ­¤ç±»ä»£ç ï¼Œä¾‹å¦‚ï¼Œå› ä¸ºåŸŸç”±æ”»å‡»è€…æ§åˆ¶ï¼Œä¹Ÿå¯èƒ½æ— æ„ä¸­ä¼ é€’ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡ç¬¬ä¸‰æ–¹è„šæœ¬æˆ–å¹¿å‘Šã€‚æˆ‘ä»¬å‡è®¾æ”»å‡»è€…æ§åˆ¶ç€æœåŠ¡å™¨ç«¯çš„æ¶æ„ä»£ç ï¼Œå› æ­¤å¯ä»¥è‡ªç”±ä¿®æ”¹å®ƒã€‚ç‰¹åˆ«æ˜¯ï¼Œä»–ä»¬å¯ä»¥è½¬æ¢æºä»£ç ã€å°†ä¸€ä¸ªæ–‡ä»¶æ‹†åˆ†ä¸ºå¤šä¸ªæ–‡ä»¶æˆ–åˆå¹¶å¤šä¸ªä»£ç æ–‡ä»¶ã€‚</p><p>åœ¨é˜²å¾¡æ–¹é¢ï¼Œæˆ‘ä»¬å‡è®¾ä¸€ä¸ªé™æ€æ¶æ„è½¯ä»¶æ£€æµ‹å™¨åœ¨webåº”ç”¨ç¨‹åºåœ¨æµè§ˆå™¨ä¸­æ‰§è¡Œä¹‹å‰æ‰«æå…¶å®¢æˆ·ç«¯ä»£ç ã€‚æ¶æ„è½¯ä»¶æ£€æµ‹å™¨ç”¨äºæ‹¦æˆªå’Œæ£€æŸ¥ä»£ç çš„æœºåˆ¶ä¸æˆ‘ä»¬æ— å…³ã€‚ä¾‹å¦‚ï¼Œå®ƒå¯ä»¥å®ç°ä¸ºä¸€ä¸ªç½‘ç»œä»£ç†ï¼Œåœ¨æ–‡ä»¶åˆ°è¾¾å®¢æˆ·ç«¯è®¡ç®—æœºä¹‹å‰å¯¹å…¶è¿›è¡Œæ‰«æï¼Œä¹Ÿå¯ä»¥å®ç°ä¸ºå®¢æˆ·ç«¯è®¡ç®—æœºä¸Šçš„é˜²ç—…æ¯’å·¥å…·æˆ–æµè§ˆå™¨æ‰©å±•ã€‚è¶…å‡ºé™æ€åˆ†æçš„æ¶æ„è½¯ä»¶æ£€æµ‹æˆ–ç¼“è§£æŠ€æœ¯ï¼Œä¾‹å¦‚åŸºäºåˆ†æå®¢æˆ·ç«¯ä»£ç çš„æ‰§è¡Œï¼Œè¶…å‡ºäº†æœ¬å·¥ä½œçš„èŒƒå›´ã€‚</p><p>æ”»å‡»è€…çš„ç›®æ ‡æ˜¯ç»•è¿‡æ¶æ„è½¯ä»¶æ£€æµ‹å™¨ã€‚ä¸ºæ­¤ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šè®¤ä¸ºç›®æ ‡æµè§ˆå™¨æ”¯æŒWebAssemblyï¼Œè¿™æ˜¯å½“ä»Šå‡ ä¹æ‰€æœ‰æµè§ˆå™¨çš„æƒ…å†µã€‚æ”»å‡»è€…ä¸éœ€è¦è®¿é—®æ¶æ„è½¯ä»¶æ£€æµ‹å™¨ï¼Œæˆ–è€…åœ¨åŸºäºæœºå™¨å­¦ä¹ çš„æ£€æµ‹å™¨çš„æƒ…å†µä¸‹ï¼Œä¸éœ€è¦è®¿é—®å…¶è®­ç»ƒçš„æ•°æ®ã€‚</p><h2 id="_4-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_4-æ–¹æ³•"><span>4. æ–¹æ³•</span></a></h2><h3 id="a-overview-and-challenges" tabindex="-1"><a class="header-anchor" href="#a-overview-and-challenges"><span>A. Overview and Challenges</span></a></h3><p>å›¾1ç»™å‡ºäº†Wobfuscatorçš„æ¦‚è§ˆã€‚è¾“å…¥æ˜¯ä¸€ä¸ªJavaScriptæ–‡ä»¶ï¼Œæˆ‘ä»¬å°†å…¶è§£æä¸ºASTã€‚æ¥ä¸‹æ¥ï¼Œè¯¥æ–¹æ³•è¯†åˆ«æ½œåœ¨çš„ç¿»è¯‘ç«™ç‚¹ï¼Œå³ï¼ˆiï¼‰ä¸æ£€æµ‹æ¶æ„ä»£ç ç›¸å…³çš„ä»£ç ä½ç½®ï¼Œä»¥åŠï¼ˆiiï¼‰å¯ä»¥ä»¥è¯­ä¹‰ä¿ç•™çš„æ–¹å¼ç¿»è¯‘æˆWebAssemblyçš„ä»£ç ä½ç½®ã€‚è¯¥æ–¹æ³•ä¸æ˜¯é’ˆå¯¹ä¸€èˆ¬çš„JavaScriptåˆ°WebAssemblyè½¬æ¢ï¼Œè€Œæ˜¯æœºä¼šä¸»ä¹‰åœ°åªé’ˆå¯¹æ»¡è¶³è¿™ä¸¤ä¸ªè¦æ±‚çš„ä»£ç ä½ç½®ã€‚</p><figure><img src="/assets/images/scholar/Wobfuscator%EF%BC%9A%E9%80%9A%E8%BF%87%E9%80%89%E6%8B%A9%E6%80%A7%E5%9C%B0%E7%BF%BB%E8%AF%91%E5%88%B0WASM%E6%9D%A5%E6%B7%B7%E6%B7%86JavaScript%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/figure1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ä¸ºäº†å°†è¡Œä¸ºè½¬ç§»åˆ°WebAssemblyä¸­ï¼ŒWobfuscatorä¸ºæ¯ä¸ªç¿»è¯‘ç«™ç‚¹ç”ŸæˆWebAssemblysä»£ç ï¼Œç„¶åè½¬æ¢JavaScript ASTä»¥åˆ©ç”¨ç”Ÿæˆçš„ä»£ç ã€‚ASTé€šè¿‡ä¸‰ç§æ–¹å¼è¿›è¡Œè½¬æ¢ã€‚é¦–å…ˆï¼Œåœ¨å®ä¾‹åŒ–ç«™ç‚¹ï¼Œæˆ‘ä»¬æ·»åŠ ä»£ç å°†WebAssemblyæ¨¡å—åŠ è½½åˆ°åº”ç”¨ç¨‹åºä¸­ã€‚å…¶æ¬¡ï¼Œåœ¨æ¯ä¸ªé€‰å®šçš„ç¿»è¯‘ç«™ç‚¹ï¼Œæˆ‘ä»¬ä¿®æ”¹ä»£ç ä»¥è®¿é—®WebAssemblyæ¨¡å—æä¾›çš„å±æ€§å’Œå‡½æ•°ã€‚ç¬¬ä¸‰ï¼Œåœ¨ASTçš„æ ¹èŠ‚ç‚¹ï¼Œæˆ‘ä»¬æœ‰æ¡ä»¶åœ°å°†è„šæœ¬åŒ…è£…æˆä¸€ä¸ªåŒ¿åçš„å¼‚æ­¥å‡½æ•°ï¼Œç§°ä¸ºå¼‚æ­¥åŒ…è£…å™¨ï¼Œä»¥æ”¯æŒä»£ç ä¸­çš„å¼‚æ­¥å…³é”®å­—ã€‚æœ¬èŠ‚çš„å…¶ä½™éƒ¨åˆ†å°†è¯¦ç»†è§£é‡Šè¿™äº›è½¬æ¢ã€‚æœ€åï¼ŒWobfuscatorçš„è¾“å‡ºæ˜¯è½¬æ¢åçš„JavaScriptä»£ç ä»¥åŠä¸€ä¸ªæˆ–å¤šä¸ªç”Ÿæˆçš„WebAssemblyæ¨¡å—ã€‚</p><p>åœ¨è®¾è®¡å°†JavaScriptè¡Œä¸ºè½¬æ¢ä¸ºWebAssemblyæ¨¡å—çš„è½¬æ¢æ—¶ï¼Œæˆ‘ä»¬é‡åˆ°äº†å‡ ä¸ªæŒ‘æˆ˜ã€‚ä¸€ä¸ªå…³é”®çš„æŒ‘æˆ˜æ˜¯ï¼Œç”±äºWebAssemblyä¸­çš„åŠŸèƒ½æœ‰é™ï¼Œä¸å¯èƒ½å°†é€šç”¨JavaScriptä»£ç å®Œå…¨ç¿»è¯‘æˆWebAssemblyã€‚ä¸€ä¸ªä¾‹å­æ˜¯åŠ¨æ€ç”Ÿæˆçš„ä»£ç ï¼Œå®ƒåœ¨JavaScriptä¸­é€šè¿‡è‡­åæ˜­è‘—çš„evalå‡½æ•°å¯ç”¨ï¼Œä½†åœ¨WebAssemblyä¸­ä¸å—æ”¯æŒã€‚JavaScriptæ”¯æŒç›¸å½“å¤æ‚çš„è§„åˆ™ï¼Œä¾‹å¦‚varç»‘å®šå˜é‡çš„å‡½æ•°ä½œç”¨åŸŸã€hoisting of functionså’Œé—­åŒ…ã€‚WebAssemblyåªæœ‰ä¸‰ä¸ªå­˜å‚¨ä½ç½®ï¼šå…¨å±€æ¨¡å—å˜é‡ã€æ¯ä¸ªå‡½æ•°çš„å±€éƒ¨å˜é‡å’ŒåŸå§‹å­—èŠ‚å†…å­˜ã€‚æ­¤å¤–ï¼ŒWebAssemblyåªæœ‰æœ‰é™çš„æ§åˆ¶æµæŒ‡ä»¤ï¼Œä¸èƒ½å®Œå…¨å¤åˆ¶æ‰€æœ‰å¯ç”¨çš„JavaScriptæ„é€ ï¼Œå¦‚try/catchè¯­å¥ã€forå¾ªç¯å’ŒPromisesã€‚å¦ä¸€ä¸ªæŒ‘æˆ˜æ˜¯WebAssemblyå’ŒJavaScriptä¹‹é—´å¯ä»¥ä¼ é€’çš„æ•°æ®ç±»å‹æœ‰é™ã€‚åœ¨WebAssemblyçš„åˆå§‹ç‰ˆæœ¬ä¸­ï¼Œå‡½æ•°åªèƒ½æ¥å—å’Œè¿”å›æ•°å€¼æ•°æ®ç±»å‹ï¼Œè¿™æ— æ³•å¤åˆ¶JavaScriptæ”¯æŒçš„å¤æ‚å¯¹è±¡ã€‚æœ€åï¼Œä¸åŒçš„æµè§ˆå™¨å¯ä»¥å¯¹ä½¿ç”¨çš„WebAssemblyæ¨¡å—æ–½åŠ æ–‡ä»¶å¤§å°é™åˆ¶ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»è§£å†³è¿™ä¸ªé™åˆ¶ï¼Œä»¥ä¾¿æˆ‘ä»¬çš„æŠ€æœ¯å…·æœ‰é€šç”¨æ€§ã€‚</p><p>ç”±äºè¿™äº›å’Œå…¶ä»–å·®å¼‚ï¼ŒWobfuscatorä¸æ˜¯åŸºäºå®Œæ•´çš„ï¼Œè€Œæ˜¯åŸºäºæœºä¼šä¸»ä¹‰çš„ç¿»è¯‘ï¼Œå³åœ¨ä¸ç‰ºç‰²æ­£ç¡®æ€§çš„æƒ…å†µä¸‹ï¼Œè½¬æ¢æœ‰åŠ©äºé¿å¼€æ¶æ„è½¯ä»¶æ£€æµ‹å™¨çš„ä»£ç ã€‚</p><h3 id="b-å˜æ¢-transformations" tabindex="-1"><a class="header-anchor" href="#b-å˜æ¢-transformations"><span>B. å˜æ¢ï¼ˆTransformationsï¼‰</span></a></h3><p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ç”Ÿæˆ <strong>WebAssembly</strong> æ¨¡å—ï¼Œä»¥å¤ç°ç‰¹å®š <strong>JavaScript</strong> ä»£ç ç‰‡æ®µçš„åŠŸèƒ½è¡Œä¸ºã€‚ä¸ºå®ç°è¿™äº›æ¨¡å—ï¼Œ<strong>Wobfuscator</strong> æ„å»ºåœ¨ä¸€ç»„æ ¸å¿ƒçš„å˜æ¢è§„åˆ™ä¹‹ä¸Šï¼š</p><p><strong>å®šä¹‰ 1ï¼ˆå˜æ¢è§„åˆ™ï¼‰</strong>ï¼šä¸€ä¸ªå˜æ¢è§„åˆ™æ˜¯ä¸€ä¸ªä¸‰å…ƒç»„ ((L, t, p))ï¼Œå…¶ä¸­ï¼š</p><ul><li>(L) è¡¨ç¤ºå¯åº”ç”¨è¯¥å˜æ¢çš„ä¸€ç»„ä»£ç ä½ç½®ï¼›</li><li>(t) æ˜¯ä¸€ä¸ª<strong>å˜æ¢å‡½æ•°</strong>ï¼Œå®ƒæŠŠ (L) ä¸­æŸä¸ªä»£ç ä½ç½®å¤„çš„ JavaScript æ˜ å°„ä¸º<strong>æ”¹å†™åçš„ JavaScript ä»£ç </strong>ä»¥åŠ<strong>ä¸€ä¸ªæˆ–å¤šä¸ª WebAssembly æ¨¡å—</strong>ï¼›å¹¶ä¸”</li><li>(p) æ˜¯åº”ç”¨ (t) çš„<strong>å‰ç½®æ¡ä»¶</strong>ï¼Œä»¥<strong>è°“è¯</strong>çš„å½¢å¼ä½œç”¨åœ¨æŸä¸ªä»£ç ä½ç½®åŠå…¶å‘¨å›´ä¸Šä¸‹æ–‡ä¸Šã€‚</li></ul><p>æˆ‘ä»¬ç»™å‡ºä¸ƒæ¡é’ˆå¯¹ JavaScript ä¸åŒè¯­è¨€ç‰¹æ€§çš„å˜æ¢è§„åˆ™ã€‚å®ƒä»¬å¤§ä½“åˆ†ä¸ºä¸‰ç±»ã€‚</p><ol><li><strong>æ•°æ®æ··æ·†ç±»</strong>ï¼šæ··æ·†åœ¨ä¸€ä¸ª JavaScript æ–‡ä»¶ä¸­è¢«å®šä¹‰å¹¶ä½¿ç”¨çš„æ•°æ®ã€‚æ­¤ç±»è§„åˆ™é’ˆå¯¹<strong>å­—ç¬¦ä¸²å­—é¢é‡</strong>ï¼ˆç¬¬ IV-B1 èŠ‚ï¼‰ä¸<strong>æ•°ç»„åˆå§‹åŒ–ä»£ç </strong>ï¼ˆç¬¬ IV-B2 èŠ‚ï¼‰ã€‚</li><li><strong>å‡½æ•°è°ƒç”¨æ··æ·†ç±»</strong>ï¼šéšè—å¯ç–‘çš„å‡½æ•°è°ƒç”¨ï¼ˆç¬¬ IV-B3 èŠ‚ï¼‰æˆ–<strong>ä»»æ„å‡½æ•°è°ƒç”¨</strong>ï¼ˆç¬¬ IV-B4 èŠ‚ï¼‰ã€‚</li><li><strong>æ§åˆ¶æµæ··æ·†ç±»</strong>ï¼šæ··æ·†ç»™å®šä»£ç çš„æ§åˆ¶æµã€‚æ­¤ç±»è§„åˆ™é’ˆå¯¹ <strong>if è¯­å¥</strong>ï¼ˆç¬¬ IV-B5 èŠ‚ï¼‰ã€<strong>for å¾ªç¯</strong>ï¼ˆç¬¬ IV-B6 èŠ‚ï¼‰ä»¥åŠ <strong>while å¾ªç¯</strong>ï¼ˆç¬¬ IV-B7 èŠ‚ï¼‰ã€‚</li></ol><p><strong>è¡¨ I</strong> å¯¹è¿™äº›å˜æ¢è§„åˆ™è¿›è¡Œäº†ç¤ºæ„è¯´æ˜ã€‚</p><figure><img src="/assets/images/scholar/Wobfuscator%EF%BC%9A%E9%80%9A%E8%BF%87%E9%80%89%E6%8B%A9%E6%80%A7%E5%9C%B0%E7%BF%BB%E8%AF%91%E5%88%B0WASM%E6%9D%A5%E6%B7%B7%E6%B7%86JavaScript%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/table1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>è¿™äº›å˜æ¢è§„åˆ™ä½¿ç”¨äº†è‹¥å¹² JavaScript åŸè¯­ä¸ WebAssembly è¿›è¡Œäº¤äº’ï¼š</p><ul><li><p><strong><code>instanWasm(source, impObj)</code></strong>ï¼šä» <code>source</code> å®ä¾‹åŒ–ä¸€ä¸ª WebAssembly æ¨¡å—å¹¶è¿”å›è¯¥æ¨¡å—ã€‚å¯é€‰å‚æ•° <code>impObj</code> æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«éœ€è¦å¯¼å…¥åˆ°æ‰€åˆ›å»º WebAssembly æ¨¡å—ä¸­çš„å‡½æ•°ã€‚æˆ‘ä»¬ä½¿ç”¨è¯¥åŸè¯­çš„ä¸¤ä¸ªå˜ä½“ï¼š<strong>åŒæ­¥</strong>ä¸<strong>å¼‚æ­¥</strong>å®ä¾‹åŒ–ï¼ˆè§ç¬¬ IV-C èŠ‚ï¼‰ã€‚</p></li><li><p><strong><code>loadStrFromBuf(buffer, startIndex)</code></strong>ï¼šä» <code>buffer</code> ä¸­è‡ªå­—èŠ‚åç§» <code>startIndex</code> å¼€å§‹åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ªç©ºå­—èŠ‚ï¼ˆå³ <code>\00</code>ï¼‰ä¸ºæ­¢ï¼›å…¶ä¸­ <code>buffer</code> æ˜¯ WebAssembly æ¨¡å—çš„çº¿æ€§å†…å­˜ã€‚</p></li><li><p><strong><code>loadArrFromBuf(buffer, startIndex, length)</code></strong>ï¼šä» <code>buffer</code> çš„å­—èŠ‚åç§» <code>startIndex</code> å¼€å§‹ï¼Œè¯»å–é•¿åº¦ä¸º <code>length</code> çš„ç‰‡æ®µå¹¶åˆ›å»ºä¸€ä¸ªæ•°ç»„ï¼›å…¶ä¸­ <code>buffer</code> ä¹Ÿæ˜¯ WebAssembly çš„çº¿æ€§å†…å­˜ã€‚</p></li></ul><hr><h4 id="_1-æ··æ·†å­—ç¬¦ä¸²å­—é¢é‡-obfuscating-string-literals" tabindex="-1"><a class="header-anchor" href="#_1-æ··æ·†å­—ç¬¦ä¸²å­—é¢é‡-obfuscating-string-literals"><span>1) æ··æ·†å­—ç¬¦ä¸²å­—é¢é‡ï¼ˆObfuscating String Literalsï¼‰</span></a></h4><p>JavaScript æ¶æ„è½¯ä»¶å¸¸ç”¨<strong>ç¼–ç å­—ç¬¦ä¸²</strong>æ¥éšè—æ¶æ„ä»£ç ã€‚è¿™äº›ç¼–ç å­—ç¬¦ä¸²å¯¹äºå­¦ä¹ å­—ç¬¦ä¸²æ¨¡å¼åŠå…¶ç¼–ç æ–¹æ¡ˆçš„æ¶æ„è½¯ä»¶æ£€æµ‹å™¨è‡³å…³é‡è¦ã€‚ä¸º<strong>è§„é¿</strong>å¯¹ç¼–ç å­—ç¬¦ä¸²çš„æ£€æµ‹ï¼Œæˆ‘ä»¬å®šä¹‰å˜æ¢è§„åˆ™<br><strong><code>T1-StringLiteral</code></strong>ï¼Œè®°ä¸ºä¸‰å…ƒç»„ ((L_{T1}, t_{T1}, p_{T1}))ï¼Œå…¶ä¸­ï¼š</p><ul><li><p><strong>(L_{T1})</strong>ï¼šå…è®¸åº”ç”¨è§„åˆ™ T1 çš„ä»£ç ä½ç½®ï¼Œå‡ä¸º <strong>AST</strong> ä¸­ç±»å‹ä¸º <strong><code>Literal</code></strong> ä¸”å–å€¼ä¸º<strong>å­—ç¬¦ä¸²</strong>çš„èŠ‚ç‚¹ã€‚</p></li><li><p><strong>(t_{T1})</strong>ï¼šå˜æ¢å‡½æ•°ï¼ˆåœ¨è¡¨ I çš„ <strong>T1-StringLiteral</strong> è¡Œç»™å‡ºï¼‰ã€‚ä¸ºæ··æ·†å­—ç¬¦ä¸²å­—é¢é‡ <code>&quot;lit&quot;</code>ï¼Œ(t_{T1}) ç”Ÿæˆä¸€ä¸ª WebAssembly æ¨¡å—ï¼Œåœ¨å…¶ä¸­ <strong>å®šä¹‰ä¸€æ®µ <code>memory</code> å¹¶å°†å…¶å¯¼å‡ºåˆ° JavaScript</strong>ï¼ˆç¬¬ 2 è¡Œï¼‰ã€‚è¯¥å†…å­˜ç”¨äºåœ¨<strong>åç§» 0</strong> å¤„å­˜å‚¨å­—ç¬¦ä¸²å­—é¢é‡ <code>&quot;lit&quot;</code>ï¼ˆç¬¬ 3 è¡Œï¼‰ã€‚ä¸ºåœ¨ JavaScript ä¸­é‡å»ºè¯¥å­—ç¬¦ä¸²ï¼Œå®šä¹‰å¹¶å¯¼å‡ºä¸€ä¸ªåŒ…å«è¯¥åç§»é‡çš„å˜é‡ <strong><code>$d1</code></strong>ï¼ˆç¬¬ 1 è¡Œï¼‰ã€‚æ¯ä¸ªå­—ç¬¦ä¸²éƒ½ä»¥<strong>ç©ºå­—èŠ‚</strong>ç»“æŸï¼ˆå³ <code>\00</code>ï¼‰ï¼Œå› æ­¤å¯ä»¥ä»èµ·å§‹ç´¢å¼•å¼€å§‹è¯»å–çº¿æ€§å†…å­˜ï¼Œç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ªç©ºå­—èŠ‚å³å¯å®Œæˆé‡å»ºã€‚</p><p>è‹¥è¾“å…¥çš„ JavaScript ç¨‹åºä¸­æœ‰<strong>å¤šä¸ªå­—ç¬¦ä¸²</strong>éœ€è¦å˜æ¢ï¼Œå®ƒä»¬ä¼šè¢«<strong>å­˜å‚¨åœ¨åŒä¸€ä¸ª WebAssembly æ¨¡å—</strong>ä¸­ï¼›æ­¤æ—¶ï¼Œä¸ºæ¯ä¸ªè¢«å­˜å‚¨çš„å­—ç¬¦ä¸²å¯åˆ†åˆ«å®šä¹‰å¤šä¸ªå˜é‡ï¼ˆå¦‚ <code>$d1, $d2, ...</code>ï¼‰ã€‚å˜é‡ <strong><code>buf</code></strong> æŒ‡å‘ç”± WebAssembly <strong>å¯¼å‡ºçš„å†…å­˜</strong>ï¼ˆç¬¬ 3 è¡Œï¼‰ã€‚åœ¨ç¿»è¯‘ä½ç‚¹ï¼Œå˜é‡ <strong><code>startInd</code></strong> è·å¾—å­˜å‚¨äºçº¿æ€§å†…å­˜ä¸­çš„ç›®æ ‡å­—ç¬¦ä¸²å­—é¢é‡çš„<strong>èµ·å§‹ç´¢å¼•</strong>ï¼ˆç¬¬ 5 è¡Œï¼‰ã€‚æœ€åï¼Œä½¿ç”¨åŸè¯­ <strong><code>loadStrFromBuf</code></strong> å¹¶ä»¥ <code>buf</code> ä¸ <code>startInd</code> ä¸ºå®å‚æ¥<strong>é‡å»º</strong>å­—ç¬¦ä¸² <code>&quot;lit&quot;</code>ï¼ˆç¬¬ 6 è¡Œï¼‰ã€‚</p></li><li><p><strong>(p_{T1})</strong>ï¼šå‰ç½®æ¡ä»¶ã€‚è¯¥å˜æ¢ä»…èƒ½åº”ç”¨äº <strong>JavaScript å…è®¸ç”¨å‡½æ•°è°ƒç”¨æ›¿æ¢å­—ç¬¦ä¸²å­—é¢é‡</strong> çš„ä½ç½®ã€‚å…·ä½“åœ°ï¼Œä»¥ä¸‹æƒ…å†µ<strong>ä¸é€‚ç”¨</strong>ï¼š<br> (i) å‡ºç°åœ¨ <code>import</code> æˆ– <code>require</code> è¯­å¥ä¸­çš„å­—ç¬¦ä¸²å­—é¢é‡ï¼Œå› ä¸ºåœ¨æ‰“åŒ…æ¨¡å—æ—¶è¿™ç±»å­—ç¬¦ä¸²åº”å½“æ˜¯<strong>é™æ€å·²çŸ¥</strong>çš„ï¼›<br> (ii) ä½œä¸º<strong>å±æ€§å</strong>å‡ºç°åœ¨å¯¹è±¡è¡¨è¾¾å¼ä¸­çš„å­—ç¬¦ä¸²å­—é¢é‡ï¼Œå› ä¸º<strong>å‡½æ•°è°ƒç”¨çš„è¿”å›å€¼</strong>ä¸èƒ½ç”¨ä½œ<strong>å¯¹è±¡é”®</strong>ã€‚</p></li></ul><h4 id="_2-æ··æ·†æ•°ç»„-obfuscating-arrays" tabindex="-1"><a class="header-anchor" href="#_2-æ··æ·†æ•°ç»„-obfuscating-arrays"><span>2) æ··æ·†æ•°ç»„ï¼ˆObfuscating Arraysï¼‰</span></a></h4><p>æ¶æ„æ–‡ä»¶ç»å¸¸åŒ…å«<strong>æ•°å€¼å­—é¢é‡</strong>æ•°ç»„ï¼Œè¿™äº›æ•°å€¼ä»£è¡¨å­—ç¬¦ç¼–ç ï¼Œç”¨æ¥é‡å»ºæ¶æ„å­—ç¬¦ä¸²ã€‚ä¸ºæ··æ·†è¿™ç±»æ•°ç»„ï¼Œæˆ‘ä»¬åˆ©ç”¨è¿™æ ·ä¸€ä¸ªäº‹å®ï¼šWebAssembly æ¨¡å—çš„<strong>çº¿æ€§å†…å­˜</strong>ä»¥ <strong>array buffer</strong> å½¢å¼æš´éœ²å‡ºæ¥ï¼Œè€Œå®ƒå¯ä»¥è‡ªç„¶åœ°æ˜ å°„ä¸º JavaScript çš„<strong>æ•°å€¼æ•°ç»„</strong>ã€‚æ®æ­¤æå‡ºå˜æ¢è§„åˆ™<br><strong>T2-ArrayInitialization</strong>ï¼ˆ((L_{T2}, t_{T2}, p_{T2}))ï¼‰ï¼Œå…¶ä¸­ï¼š</p><ul><li><p><strong>(L_{T2})</strong>ï¼šT2 å¯åº”ç”¨åœ¨ <strong><code>NewExpression</code></strong> ç±»å‹çš„ AST èŠ‚ç‚¹ï¼ˆä¾‹å¦‚ <code>new Array</code>ï¼‰ï¼Œæˆ–è¡¨ç¤ºæ•°ç»„å­—é¢é‡è¡¨è¾¾å¼çš„ <strong><code>ArrayExpression</code></strong> èŠ‚ç‚¹ï¼ˆä¾‹å¦‚ <code>[1,2,3]</code>ï¼‰ã€‚æ­¤å¤–ï¼Œè¯¥å˜æ¢è¿˜ä¼šæŠŠç”¨äºåˆå§‹åŒ–æ•°ç»„å…ƒç´ çš„åç»­ <strong><code>AssignmentExpression</code></strong> èµ‹å€¼è¯­å¥<strong>æ”¶æ‹¢ä¸ºä¸€æ¬¡ JavaScript å‡½æ•°è°ƒç”¨</strong>ï¼ˆå¦‚æŠŠ <code>arr[1] = 42; arr[2] = 97; ...</code> åˆå¹¶ï¼‰ã€‚</p></li><li><p><strong>(t_{T2})</strong>ï¼šå…¶å®šä¹‰è§è¡¨ I çš„ <strong>T2-ArrayInitialization</strong> ä¸€è¡Œã€‚è®¾åŸå§‹ JavaScript ä»£ç åˆ›å»ºæ•°ç»„ <code>arr</code>ï¼Œå¹¶æŠŠå…ƒç´  <code>arr[i1]</code> ä¸ <code>arr[i2]</code> åˆå§‹åŒ–ä¸ºæ•°å€¼ <code>num1</code> ä¸ <code>num2</code>ã€‚å˜æ¢åï¼Œ(t_{T2}) ç”Ÿæˆä¸€ä¸ª WebAssembly æ¨¡å—ï¼šè¯¥æ¨¡å—<strong>åˆ›å»ºä¸€æ®µ <code>memory</code> å¹¶å°†å…¶å¯¼å‡º</strong>ï¼ˆç¬¬ 1 è¡Œï¼‰ï¼›å®šä¹‰ä¸€ä¸ªå¯¼å‡ºå‡½æ•° <strong><code>$f</code></strong>ï¼ŒæŠŠ <code>num1</code> ä¸ <code>num2</code> å†™å…¥çº¿æ€§å†…å­˜ä¸­çš„æŒ‡å®šåç§» <strong><code>i1</code></strong> ä¸ <strong><code>i2</code></strong>ï¼ˆç¬¬ 2â€“8 è¡Œï¼‰ã€‚åœ¨ç¿»è¯‘ä½ç‚¹ï¼Œå˜æ¢åçš„ JavaScript ä»£ç <strong>å®ä¾‹åŒ–</strong>è¯¥ WebAssembly æ¨¡å—ï¼ˆç¬¬ 2 è¡Œï¼‰ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªå˜é‡ä»¥ä¾¿<strong>è¯»å–å¯¼å‡ºçš„å†…å­˜</strong>ï¼ˆç¬¬ 3 è¡Œï¼‰ã€‚ä¸ <strong>T1-StringLiterals</strong> ç±»ä¼¼ï¼Œè‹¥æœ‰å¤šä¸ªæ•°ç»„åˆå§‹åŒ–éœ€è¦å˜æ¢ï¼Œåœ¨ç¿»è¯‘ä½ç‚¹<strong>åªåˆ›å»ºä¸€ä¸ª WebAssembly æ¨¡å—</strong>ï¼›æ­¤æ—¶è°ƒç”¨å¯¼å‡ºå‡½æ•° <code>f</code> æŠŠ <code>num1</code> ä¸ <code>num2</code> åˆ†åˆ«å†™å…¥çº¿æ€§å†…å­˜çš„åç§» <code>i1</code> ä¸ <code>i2</code>ï¼ˆç¬¬ 5 è¡Œï¼‰ã€‚æœ€åï¼Œ<strong><code>loadArrFromBuf()</code></strong> ä»çº¿æ€§å†…å­˜ç¼“å†²åŒºå¤åˆ¶æ•°å€¼ï¼Œè¿”å›ä¸€ä¸ª <strong>JavaScript <code>Array</code> å¯¹è±¡</strong>ï¼Œå¹¶å°†å…¶èµ‹ç»™ <code>arr</code>ï¼ˆç¬¬ 6 è¡Œï¼‰ã€‚è¯¥å‡½æ•°éœ€è¦<strong>æ•°ç»„åœ¨çº¿æ€§å†…å­˜ä¸­çš„èµ·å§‹ç´¢å¼•</strong>ä¸<strong>æ•°ç»„é•¿åº¦</strong>ä¸¤ä¸ªå‚æ•°â€”â€”äºŒè€…å‡ç”± <strong>Wobfuscator</strong> è®¡ç®—å¹¶æ³¨å…¥åˆ°æ¯æ¬¡ <code>loadArrFromBuf()</code> è°ƒç”¨ä¸­ã€‚æˆ‘ä»¬ä¿è¯è¿”å›çš„å¯¹è±¡æ˜¯æ ‡å‡†çš„ JavaScript <code>Array</code>ï¼Œä»¥ä¾¿åŸå§‹ä»£ç èƒ½å¤Ÿç…§å¸¸è®¿é—® <code>Array</code> çš„æ ‡å‡†å±æ€§ä¸æ–¹æ³•ã€‚</p></li><li><p><strong>(p_{T2})</strong>ï¼šè¯¥å˜æ¢ä»…åº”ç”¨äº<strong>ç”¨æ•°å€¼å­—é¢é‡åˆå§‹åŒ–</strong>çš„æ•°ç»„ã€‚ç”±äº WebAssembly åªæœ‰<strong>æ•°å€¼å‹</strong>æ•°æ®ç±»å‹ï¼Œæˆ‘ä»¬ä»…ä½¿ç”¨ <code>.const</code> ä¸ <code>.store</code> åœ¨å†…å­˜ä¸­<strong>å­˜æ”¾æ•°å€¼å­—é¢é‡</strong>ã€‚å…·ä½“è€Œè¨€ï¼Œåªåœ¨ä»¥ä¸‹ä»»ä¸€æƒ…å½¢æ»¡è¶³æ—¶åº”ç”¨å˜æ¢ï¼š</p><ol><li><code>new Array</code> è¡¨è¾¾å¼ï¼Œéšåç´§è·Ÿä»…æ’å…¥<strong>æ•°å€¼å­—é¢é‡</strong>çš„èµ‹å€¼è¯­å¥ï¼›</li><li><code>new Array</code> è¡¨è¾¾å¼ï¼Œå…¶<strong>å®å‚å…¨ä¸ºæ•°å€¼å­—é¢é‡</strong>ï¼›</li><li>ä»…åŒ…å«<strong>æ•°å€¼å­—é¢é‡</strong>çš„ <code>ArrayExpression</code>ã€‚</li></ol></li></ul><h4 id="_3-æ··æ·†å‡½æ•°å-obfuscating-function-names" tabindex="-1"><a class="header-anchor" href="#_3-æ··æ·†å‡½æ•°å-obfuscating-function-names"><span>3) æ··æ·†å‡½æ•°åï¼ˆObfuscating Function Namesï¼‰</span></a></h4><p>ä¸€äº›å†…ç½®çš„ JavaScript å‡½æ•°ï¼ˆä¾‹å¦‚è‡­åæ˜­è‘—çš„ <code>eval</code>ï¼‰ç»å¸¸è¢«æ”»å‡»è€…æ»¥ç”¨ã€‚å› æ­¤ï¼Œæ£€æµ‹å™¨å¯èƒ½ä¼šæŠŠè¿™äº›å†…ç½®å‡½æ•°åè§†ä¸ºå¯ç–‘ï¼Œå¹¶å°†å…¶ä½œä¸ºæ¶æ„è½¯ä»¶æ£€æµ‹çš„ç‰¹å¾ä¹‹ä¸€ã€‚ä¸ºè§„é¿è¿™ç±»æ£€æµ‹ï¼Œæˆ‘ä»¬é€šè¿‡å˜æ¢è§„åˆ™<br><strong>T3-FunctionName</strong>ï¼ˆ((L_{T3}, p_{T3}, t_{T3}))ï¼‰ä» JavaScript ä»£ç ä¸­<strong>ç§»é™¤å¯ç–‘å‡½æ•°å</strong>ï¼š</p><ul><li><p><strong>(L_{T3})</strong>ï¼šT3 å¯åº”ç”¨åœ¨åŒ…å«ç‰¹å®šæ ‡è¯†ç¬¦åç§°çš„ <strong><code>CallExpression</code></strong> èŠ‚ç‚¹æˆ– <strong><code>NewExpression</code></strong> èŠ‚ç‚¹ä¸Šã€‚</p></li><li><p><strong>(t_{T3})</strong>ï¼šå…¶å®šä¹‰è§è¡¨ I çš„ <strong>T3-FunctionName</strong> ä¸€è¡Œã€‚ä»¥æ··æ·†å‡½æ•°å <code>&quot;eval&quot;</code> ä¸ºä¾‹ï¼Œ(t_{T3}) ä¼šæŠŠè¯¥å‡½æ•°å<strong>ä» JavaScript ä¸­ç§»é™¤</strong>å¹¶å°†å…¶<strong>å­˜å…¥ WebAssembly çº¿æ€§å†…å­˜</strong>ã€‚åœ¨ WebAssembly ä»£ç ä¸­ï¼š</p><ul><li>å®šä¹‰å¹¶å¯¼å‡ºä¸€ä¸ªå…¨å±€å˜é‡ <strong><code>$d1</code></strong>ï¼Œå…¶å€¼ä¸º <code>0</code>ï¼ˆç¬¬ 1 è¡Œï¼‰ï¼Œè¡¨ç¤ºçº¿æ€§å†…å­˜ä¸­å­—ç¬¦ä¸² <code>&quot;eval&quot;</code> çš„èµ·å§‹ç´¢å¼•ï¼›</li><li>åˆ›å»ºå¹¶å¯¼å‡ºä¸€æ®µ <strong><code>memory</code></strong>ï¼ˆç¬¬ 2 è¡Œï¼‰ï¼›</li><li>å®šä¹‰ä¸€ä¸ª<strong>æ•°æ®æ®µ</strong>ï¼Œåœ¨<strong>åç§» 0</strong> å¤„å†™å…¥ <code>&quot;eval&quot;</code>ï¼ˆç¬¬ 3 è¡Œï¼‰ã€‚</li></ul><p>åœ¨å˜æ¢åçš„ JavaScript ä»£ç ä¸­ï¼š</p><ul><li>å®ä¾‹åŒ–è¯¥ WebAssembly æ¨¡å—ï¼ˆç¬¬ 2 è¡Œï¼‰ï¼Œå¹¶å®šä¹‰ä¸€ä¸ªå˜é‡ç”¨äºè®¿é—®çº¿æ€§å†…å­˜ï¼ˆç¬¬ 3 è¡Œï¼‰ï¼›</li><li>å˜é‡ <strong><code>startInd</code></strong> è¢«èµ‹å€¼ä¸ºå¯¼å‡ºçš„ <strong><code>d1</code></strong>ï¼Œå³çº¿æ€§å†…å­˜ä¸­ <code>&quot;eval&quot;</code> çš„èµ·å§‹ç´¢å¼•ï¼ˆç¬¬ 5 è¡Œï¼‰ï¼›</li><li>æœ€åè°ƒç”¨ <strong><code>loadStrFromBuf</code></strong> é‡å»ºå­—ç¬¦ä¸² <code>&quot;eval&quot;</code>ï¼Œå¹¶é€šè¿‡ <code>window</code> å¯¹è±¡ä»¥è¯¥å­—ç¬¦ä¸²ï¼ˆè®°ä½œ <code>str</code>ï¼‰è°ƒç”¨ <code>eval</code>ï¼Œå…¶å®å‚ä¸åŸå§‹ <code>eval()</code> ä¸­ä½¿ç”¨çš„ç›¸åŒï¼ˆç¬¬ 6 è¡Œï¼‰ã€‚</li></ul></li><li><p><strong>(p_{T3})</strong>ï¼šè¯¥å˜æ¢å¯åº”ç”¨äº<strong>é€šè¿‡ <code>window</code> å¯¹è±¡å¯è®¿é—®çš„å…¨å±€å‡½æ•°</strong>çš„è°ƒç”¨è¡¨è¾¾å¼æˆ– new è¡¨è¾¾å¼ã€‚æˆ‘ä»¬è¯†åˆ«å‡ºæ¶æ„æ–‡ä»¶ä¸­å¸¸ç”¨çš„ 8 ä¸ªå…¨å±€å‡½æ•°ï¼Œå¹¶ä»…åœ¨æ ‡è¯†ç¬¦å±äºä¸‹åˆ—åˆ—è¡¨æ—¶åº”ç”¨è¯¥å˜æ¢ï¼š<br><code>eval</code>, <code>atob</code>, <code>btoa</code>, <code>WScript</code>, <code>unescape</code>, <code>escape</code>, <code>Function</code>, <code>ActiveXObject</code>ã€‚<br> è™½ç„¶è¿™äº›å‡½æ•°æœ¬èº«å¹¶éå¤©ç„¶æ¶æ„ï¼Œä½†æˆ‘ä»¬åˆ†æçš„è®¸å¤šæ¶æ„è½¯ä»¶æ ·æœ¬ä¼šåˆ©ç”¨å®ƒä»¬æ¥<strong>è§£ç å¹¶æ‰§è¡Œéšè—ä»£ç </strong>ã€‚</p></li></ul><h4 id="_4-æ··æ·†è°ƒç”¨-obfuscating-calls" tabindex="-1"><a class="header-anchor" href="#_4-æ··æ·†è°ƒç”¨-obfuscating-calls"><span>4) æ··æ·†è°ƒç”¨ï¼ˆObfuscating Callsï¼‰</span></a></h4><p>é™¤äº†å‰è¿°å¯ç–‘å‡½æ•°å¤–ï¼Œæˆ‘ä»¬è¿˜ä¸º<strong>ä¸€èˆ¬çš„ JavaScript å‡½æ•°è°ƒç”¨</strong>æ„é€ äº†å˜æ¢è§„åˆ™ <strong>T4-CallExpression</strong>ã€‚è¯¥å˜æ¢æŠŠ JavaScript ä¸­çš„å‡½æ•°è°ƒç”¨æ”¹å†™ä¸ºï¼š<strong>å…ˆè°ƒç”¨ä¸€ä¸ªå¯¼å‡ºçš„ WebAssembly å‡½æ•°</strong>ï¼Œè€Œè¿™ä¸ª WebAssembly å‡½æ•°å†å»<strong>è°ƒç”¨å¯¼å…¥åˆ° WebAssembly çš„ JavaScript å‡½æ•°</strong>ã€‚ä¸å®Œå…¨ä» JavaScript ä¸­ç§»é™¤å¯ç–‘å‡½æ•°åçš„ <strong>T3-FunctionName</strong> ä¸åŒï¼Œè¿™é‡Œæ˜¯<strong>æ”¹å˜è°ƒç”¨ç‚¹å¤„è¢«è°ƒç”¨å‡½æ•°çš„ä¸Šä¸‹æ–‡</strong>ï¼Œä»è€Œå½±å“åŸºäº AST çš„æ¶æ„è½¯ä»¶æ£€æµ‹å™¨åœ¨æ‰«ææ¶æ„ä»£ç æ—¶æ‰€è§åˆ°çš„è¯­å¢ƒã€‚</p><p>è¯¥å˜æ¢éœ€è¦åœ¨<strong>WebAssembly MVP å…¼å®¹æ€§</strong>ä¸<strong>å¯å˜æ¢çš„å‡½æ•°è°ƒç”¨æ•°é‡</strong>ä¹‹é—´åšæƒè¡¡ã€‚å› æ­¤æˆ‘ä»¬ç»™å‡ºä¸¤ä¸ªå˜ä½“ï¼š</p><ul><li><strong>T4-CallExpression(a)</strong>ï¼šå®Œå…¨å…¼å®¹ WebAssembly <strong>MVP</strong>ï¼ˆä¸ä½¿ç”¨ä»»ä½•è¯­è¨€æ‰©å±•ï¼‰ï¼Œ<strong>ä»…èƒ½</strong>ç”¨äº<strong>æ— è¿”å›å€¼</strong>çš„å‡½æ•°ï¼›</li><li><strong>T4-CallExpression(b)</strong>ï¼šå¯å¤„ç†<strong>æœ‰è¿”å›å€¼</strong>çš„å‡½æ•°ï¼Œä½†éœ€è¦ <strong>WebAssembly Reference Types</strong> ææ¡ˆçš„æ”¯æŒï¼ˆFirefox ä¸ Chrome é»˜è®¤å·²å¯ç”¨æ­¤ææ¡ˆï¼‰ã€‚</li></ul><hr><h5 id="t4-callexpression-a" tabindex="-1"><a class="header-anchor" href="#t4-callexpression-a"><span>T4-CallExpression(a)</span></a></h5><p><strong>è§„åˆ™</strong>ï¼š((L_{T4a}, p_{T4a}, t_{T4a}))</p><ul><li><p><strong>(L_{T4a})</strong>ï¼šä¸ºåŒ…å«<strong>è¢«è°ƒå‡½æ•°æ ‡è¯†ç¬¦</strong>åŠ<strong>å®å‚</strong>çš„ <code>CallExpression</code> èŠ‚ç‚¹ã€‚</p></li><li><p><strong>(t_{T4a})</strong>ï¼ˆè§è¡¨ I çš„ T4-CallExpression(a) è¡Œï¼‰ï¼šä¸ºæ··æ·†ä¸€æ¬¡ <code>f(a)</code> å½¢å¼çš„ JavaScript è°ƒç”¨ï¼Œ(t_{T4a}) å°†è¯¥è°ƒç”¨<strong>åŒ…è£¹è¿›ä¸€ä¸ªåŒ¿åå‡½æ•°</strong>ï¼Œå¹¶æŠŠè¿™ä¸ªåŒ¿åå‡½æ•°<strong>ä½œä¸ºå¯¼å…¥</strong>ä¼ å…¥ WebAssemblyï¼ˆç¬¬ 2 è¡Œï¼‰ã€‚åœ¨åŸå§‹è°ƒç”¨ç‚¹ï¼Œæ”¹ä¸ºè°ƒç”¨ä¸€ä¸ª WebAssembly <strong>å¯¼å‡ºå‡½æ•°</strong> <code>$f0</code>ï¼ˆç¬¬ 4 è¡Œï¼‰ã€‚åœ¨ WebAssembly ä»£ç ä¸­ï¼ŒåŒ…è£¹ JavaScript è°ƒç”¨çš„å‡½æ•°è¢«<strong>ä½œä¸º <code>$impFunc</code> å¯¼å…¥</strong>ï¼›å¯¼å‡ºå‡½æ•° <code>$f0</code> çš„å®ç°å°±æ˜¯<strong>è°ƒç”¨</strong>è¿™ä¸ªè¢«å¯¼å…¥çš„ <code>$impFunc</code>ï¼ˆç¬¬ 1â€“2 è¡Œï¼‰ã€‚</p><p>æ³¨æ„ï¼Œç”¨äºåŒ…è£¹åŸå§‹ JavaScript è°ƒç”¨çš„åŒ¿åå‡½æ•°<strong>å§‹ç»ˆå…·æœ‰ç›¸åŒçš„ç±»å‹ç­¾å</strong>ï¼šæ— å‚æ•°ã€æ— è¿”å›ï¼ˆ<code>void</code>ï¼‰ã€‚å› æ­¤ï¼ŒåŒä¸€ä¸ª WebAssembly æ¨¡å—å¯ä»¥<strong>ç¼–è¯‘ä¸€æ¬¡ï¼Œé‡å¤å¤ç”¨</strong>åˆ°æ¯ä¸ªè¢«æ›¿æ¢çš„å‡½æ•°è°ƒç”¨ä¸Šï¼›æˆ‘ä»¬åªéœ€åœ¨ä¸åŒçš„è°ƒç”¨ç‚¹æ”¹å˜å¯¼å…¥å¯¹è±¡ä¸­æ‰€åŒ…å«çš„<strong>å…·ä½“ JavaScript å‡½æ•°</strong>å³å¯ã€‚</p></li><li><p><strong>(p_{T4a})</strong>ï¼šä»…å½“è°ƒç”¨è¡¨è¾¾å¼<strong>æ²¡æœ‰è¿”å›å€¼è¢«ç”¨äºèµ‹å€¼æˆ–å…¶ä»–è¡¨è¾¾å¼</strong>æ—¶å¯ç”¨ï¼Œå› ä¸º WebAssembly çš„åŸºæœ¬æ•°æ®ç±»å‹ <code>i32, i64, f32, f64</code> <strong>æ— æ³•è¦†ç›–</strong> JavaScript å¯èƒ½çš„æ‰€æœ‰è¿”å›å€¼ç±»å‹ã€‚</p></li></ul><hr><h5 id="t4-callexpression-b" tabindex="-1"><a class="header-anchor" href="#t4-callexpression-b"><span>T4-CallExpression(b)</span></a></h5><p><strong>è§„åˆ™</strong>ï¼š((L_{T4b}, p_{T4b}, t_{T4b}))</p><ul><li><p><strong>(L_{T4b})</strong>ï¼šä¸ (L_{T4a}) ç›¸åŒã€‚</p></li><li><p><strong>(t_{T4b})</strong>ï¼ˆè§è¡¨ I çš„ T4-CallExpression(b) è¡Œï¼‰ï¼šå®éªŒæ€§çš„ <strong>WebAssembly Reference Types</strong> ææ¡ˆæ–°å¢äº†å€¼ç±»å‹ <code>externref</code>ï¼Œå¯åœ¨ WebAssembly ä¸ JavaScript ä¹‹é—´<strong>ä¼ é€’ä»»æ„ JS å€¼çš„å¼•ç”¨</strong>ã€‚åˆ©ç”¨è¯¥ç±»å‹ï¼Œå˜æ¢ä»…éœ€<strong>å¯¼å…¥è¢«å˜æ¢å‡½æ•°çš„å¼•ç”¨</strong>ã€‚å…·ä½“è€Œè¨€ï¼šå˜æ¢åçš„ JavaScript ä»£ç æŠŠå‡½æ•°å¼•ç”¨ <code>f</code> å¯¼å…¥åˆ° WebAssemblyï¼ˆç¬¬ 2 è¡Œï¼‰ã€‚åœ¨åŸå§‹çš„ <code>f(a)</code> è°ƒç”¨ç‚¹ï¼Œ<code>f</code> è¢«æ›¿æ¢ä¸º WebAssembly çš„å¯¼å‡ºå‡½æ•° <code>$f0</code>ï¼Œè¯¥å‡½æ•°<strong>æ¥æ”¶åŸè°ƒç”¨çš„å®å‚ <code>a</code></strong> å¹¶<strong>è¿”å›</strong>åŸå‡½æ•°å¯èƒ½äº§ç”Ÿçš„ä»»ä½•å€¼ï¼ˆç¬¬ 4 è¡Œï¼‰ã€‚åœ¨ WebAssembly ä»£ç ä¸­ï¼Œå¯¼å‡ºå‡½æ•° <code>$f0</code> çš„<strong>è¾“å…¥ç±»å‹</strong>ä¸<strong>è¿”å›ç±»å‹</strong>å‡ä¸º <code>externref</code>ï¼ˆç¬¬ 1 è¡Œï¼‰ï¼›åœ¨ <code>$f0</code> å†…éƒ¨ï¼Œå®ƒä»¥ä¼ å…¥çš„å€¼ä¸ºå‚æ•°è°ƒç”¨å¯¼å…¥çš„ <code>$impFunc</code>ï¼ˆç¬¬ 2â€“3 è¡Œï¼‰ã€‚<br> ç›¸æ¯” (T4a)ï¼Œè¯¥å˜ä½“çš„ä¼˜åŠ¿æ˜¯ï¼šæ”¯æŒ<strong>æ›´å¤šçš„å‡½æ•°è°ƒç”¨</strong>ï¼ˆåŒ…æ‹¬<strong>æœ‰è¿”å›å€¼</strong>çš„æƒ…å½¢ï¼‰ï¼Œå¹¶æŠŠæ›´å¤šè¡Œä¸ºè¿ç§»åˆ° WebAssembly å†…éƒ¨å®Œæˆã€‚</p></li><li><p><strong>(p_{T4b})</strong>ï¼šä»…å½“åŒæ—¶æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ—¶å¯ç”¨ï¼š<br> (i) <strong>è¢«è°ƒå‡½æ•°</strong>å†…éƒ¨<strong>ä¸åŒ…å«å¯¹ <code>this</code> çš„å¼•ç”¨</strong>ï¼›<br> (ii) <strong>è°ƒç”¨å®å‚</strong>ä¸­<strong>ä¸åŒ…å« <code>this</code> çš„å¼•ç”¨</strong>ï¼›<br> (iii) è¢«è°ƒå‡½æ•°ä¸­å¼•ç”¨åˆ°çš„å˜é‡çš„æ•°æ®ä¾èµ–<strong>ä¸åŒ…å« <code>this</code></strong>ï¼›<br> (iv) è¢«è°ƒå‡½æ•°<strong>ä¸æ˜¯å­—é¢é‡å€¼çš„æ–¹æ³•</strong>ï¼›<br> (v) è¢«è°ƒå‡½æ•°<strong>ä¸æ˜¯</strong>ç‰¹æ®Šå‡½æ•° <code>bind</code> æˆ– <code>super</code>ã€‚<br> æ¡ä»¶ (i)â€“(iv) çš„åŸå› æ˜¯ï¼šä» WebAssembly å†…éƒ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œ<code>this</code> çš„å–å€¼ä¼šè¢«æ”¹å˜ï¼Œå¯èƒ½å¯¼è‡´é”™è¯¯è¡Œä¸ºï¼›æ¡ä»¶ (v) åˆ™æºäº <code>bind</code> ä¸ <code>super</code> å¯¹è°ƒç”¨æ–¹å¼æœ‰ä¸¥æ ¼é™åˆ¶ï¼Œ<strong>æ— æ³•</strong>ä½œä¸ºå¯¼å…¥å‡½æ•°ä¼ ç»™ WebAssembly æ¨¡å—ã€‚</p></li></ul><p>ç¬”è€…æ³¨ï¼šå¯¹(iv)çš„è§£é‡Šå¦‚å›¾</p><figure><img src="/assets/images/scholar/Wobfuscator%EF%BC%9A%E9%80%9A%E8%BF%87%E9%80%89%E6%8B%A9%E6%80%A7%E5%9C%B0%E7%BF%BB%E8%AF%91%E5%88%B0WASM%E6%9D%A5%E6%B7%B7%E6%B7%86JavaScript%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/other1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_5-æ··æ·†-if-è¯­å¥-obfuscating-if-statements" tabindex="-1"><a class="header-anchor" href="#_5-æ··æ·†-if-è¯­å¥-obfuscating-if-statements"><span>5) æ··æ·† <code>if</code> è¯­å¥ï¼ˆObfuscating If Statementsï¼‰</span></a></h4><p>é€šè¿‡åˆ©ç”¨ <strong>WebAssembly</strong> çš„æ§åˆ¶æµæŒ‡ä»¤ï¼Œå¯ä»¥æŠŠ JavaScript ä¸­ <code>ifâ€“else</code> è¯­å¥çš„è¡Œä¸ºè¿ç§»åˆ° WebAssembly ä¸­ï¼Œä»è€Œ<strong>éšè—è¯­æ³•ç»“æ„</strong>åŒæ—¶<strong>ä¿æŒè¯­ä¹‰ä¸å˜</strong>ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ç»™å‡ºå˜æ¢è§„åˆ™ <strong>T5-IfStatement</strong> ((L_{T5}, p_{T5}, t_{T5}))ï¼Œå…¶ä¸­ï¼š</p><ul><li><p><strong>(L_{T5})</strong>ï¼šè¯¥è§„åˆ™é€‚ç”¨äº <strong><code>IfStatement</code></strong> èŠ‚ç‚¹ã€‚</p></li><li><p><strong>(t_{T5})</strong>ï¼šå…¶å®šä¹‰è§è¡¨ I çš„ <strong>T5-IfStatement</strong> è¡Œã€‚åœ¨ç¿»è¯‘ä½ç‚¹ï¼Œ(t_{T5})<strong>æŠŠ <code>if</code> åˆ†æ”¯ä¸ <code>else</code> åˆ†æ”¯å†…çš„ä»£ç åˆ†åˆ«åŒ…è£¹åˆ°ä¸¤ä¸ªåŒ¿åå‡½æ•°</strong>ä¸­ï¼Œå¹¶å°†è¿™ä¸¤ä¸ªåŒ¿åå‡½æ•°ä½œä¸º<strong>å¯¼å…¥å‡½æ•°</strong>ä¼ å…¥ WebAssemblyï¼ˆç¬¬ 2â€“4 è¡Œï¼‰ã€‚éšåè°ƒç”¨ä¸€ä¸ª WebAssembly <strong>å¯¼å‡ºå‡½æ•°</strong> <code>f</code>ï¼Œå¹¶æŠŠåŸ <code>if</code> æ¡ä»¶çš„ç»“æœ<strong>è½¬æ¢ä¸ºæ•´æ•°</strong>ï¼ˆ0 æˆ– 1ï¼‰ä½œä¸ºå‚æ•°ä¼ ç»™ <code>f</code>ï¼ˆç¬¬ 6 è¡Œï¼‰ã€‚</p><p>åœ¨ WebAssembly æ¨¡å—ä¸­ï¼ŒåŒ…è£¹ <code>if</code> ä¸ <code>else</code> ä»£ç çš„ä¸¤ä¸ªå‡½æ•°åˆ†åˆ«ä½œä¸º <strong><code>$imp1</code></strong> ä¸ <strong><code>$imp2</code></strong> è¢«å¯¼å…¥ï¼ˆç¬¬ 4ã€6 è¡Œï¼‰ã€‚å¯¼å‡ºå‡½æ•° <strong><code>$f</code></strong> æ¥æ”¶ä¸€ä¸ª<strong>æ•´å‹å‚æ•°</strong> <code>p</code>ï¼Œå…¶å€¼ä¸º 0 æˆ– 1ï¼Œå……å½“å¸ƒå°”å€¼ä½¿ç”¨ï¼ˆç¬¬ 1â€“7 è¡Œï¼‰ã€‚<code>$f</code> å†…éƒ¨å«æœ‰ <code>ifâ€“else</code> æŒ‡ä»¤ï¼Œç”±å‚æ•° <code>p</code> å†³å®šåˆ†æ”¯ï¼šè‹¥ <code>p â‰  0</code>ï¼Œ<code>if</code> æŒ‡ä»¤è°ƒç”¨åŒ…å«åŸ <code>if</code> åˆ†æ”¯ä»£ç çš„ <code>$imp1</code>ï¼›è‹¥ <code>p = 0</code>ï¼Œåˆ™èµ° <code>else</code> åˆ†æ”¯ï¼Œè°ƒç”¨åŒ…å«åŸ <code>else</code> ä»£ç çš„ <code>$imp2</code>ã€‚å€ŸåŠ© WebAssembly çš„ <code>ifâ€“else</code> æŒ‡ä»¤ï¼Œæˆ‘ä»¬æ—¢<strong>ä¿æŒäº†åŸæœ‰è¯­ä¹‰</strong>ï¼Œåˆ<strong>åœ¨ JavaScript å±‚é¢éšè—</strong>äº†æ§åˆ¶æµç»“æ„ã€‚</p></li><li><p><strong>(p_{T5})</strong>ï¼šåªæœ‰å½“ <code>if</code> çš„ä¸¤ä¸ªåˆ†æ”¯<strong>ä¸åŒ…å«</strong>ä»¥ä¸‹å…³é”®å­—æ—¶ï¼Œæ‰èƒ½è¿›è¡Œæ­¤å˜æ¢ï¼š<code>break</code>ã€<code>continue</code>ã€<code>return</code>ã€<code>yield</code> æˆ– <code>throw</code>ã€‚è¿™äº›å…³é”®å­—ä¸æŠŠå†…å±‚ä»£ç <strong>å°è£…ä¸ºå‡½æ•°</strong>çš„åšæ³•ä¸å…¼å®¹ã€‚</p></li></ul><hr><h4 id="_6-æ··æ·†-for-å¾ªç¯-obfuscating-for-loops" tabindex="-1"><a class="header-anchor" href="#_6-æ··æ·†-for-å¾ªç¯-obfuscating-for-loops"><span>6) æ··æ·† <code>for</code> å¾ªç¯ï¼ˆObfuscating For Loopsï¼‰</span></a></h4><p>ä¸ºæ··æ·† <code>for</code> å¾ªç¯ï¼Œæˆ‘ä»¬å®šä¹‰å˜æ¢è§„åˆ™ <strong>T6-ForStatement</strong> ((L_{T6}, p_{T6}, t_{T6}))ï¼š</p><ul><li><p><strong>(L_{T6})</strong>ï¼šå˜æ¢ä½ç½®ä¸º <strong><code>ForStatement</code></strong> èŠ‚ç‚¹ï¼ˆC é£æ ¼ <code>for</code> å¾ªç¯ï¼‰ã€‚</p></li><li><p><strong>(t_{T6})</strong>ï¼šè§è¡¨ I çš„ <strong>T6-ForStatement</strong> è¡Œã€‚åœ¨ç¿»è¯‘ä½ç‚¹ï¼Œ(t_{T6}) å°†<strong>å¾ªç¯æ¡ä»¶</strong>ã€<strong>è‡ªå¢ï¼ˆæ›´æ–°ï¼‰è¡¨è¾¾å¼</strong>ä¸<strong>å¾ªç¯ä½“</strong>åˆ†åˆ«<strong>åŒ…è£¹ä¸ºä¸‰ä¸ª JavaScript å‡½æ•°</strong>ï¼Œå¹¶æŠŠå®ƒä»¬å¯¼å…¥ WebAssembly æ¨¡å—ï¼ˆç¬¬ 3â€“8 è¡Œï¼‰ã€‚<strong>å¾ªç¯å˜é‡çš„åˆå§‹åŒ–</strong>å¯ä»¥å®‰å…¨åœ°<strong>å¤–æ</strong>åˆ°å¾ªç¯ä½œç”¨åŸŸä¹‹å¤–ï¼ˆç¬¬ 2 è¡Œï¼‰ã€‚æœ€åï¼Œè°ƒç”¨ä¸€ä¸ª WebAssembly <strong>å¯¼å‡ºå‡½æ•°</strong> <code>f</code> æ¥<strong>æ¨¡æ‹Ÿ JavaScript çš„ <code>for</code> å¾ªç¯</strong>ï¼ˆç¬¬ 11 è¡Œï¼‰ã€‚</p><p>åœ¨ WebAssembly æ¨¡å—ä¸­ï¼Œä¸Šè¿°ä¸‰ä¸ªå‡½æ•°åˆ†åˆ«ä½œä¸º <strong><code>$cond</code></strong>ï¼ˆæ¡ä»¶ï¼‰ã€<strong><code>$incre</code></strong>ï¼ˆæ›´æ–°ï¼‰ä¸ <strong><code>$body</code></strong>ï¼ˆå¾ªç¯ä½“ï¼‰è¢«å¯¼å…¥ï¼ˆç¬¬ 4ã€7ã€8 è¡Œï¼‰ã€‚å¯¼å‡ºå‡½æ•° <strong><code>$f</code></strong> å«æœ‰ä¸€ä¸ª<strong>ä»£ç å—</strong>ï¼Œå…¶æ ‡ç­¾ä¸º <strong><code>$L0</code></strong>ï¼Œè¯¥å—å†…éƒ¨åˆåŒ…å«ä¸€ä¸ªæ ‡ç­¾ä¸º <strong><code>$L1</code></strong> çš„ <strong><code>loop</code></strong> å—ï¼ˆç¬¬ 2â€“3 è¡Œï¼‰ã€‚åœ¨ <code>loop</code> ä¸­ï¼Œé¦–å…ˆè°ƒç”¨ <code>$cond</code>ï¼ˆç¬¬ 4 è¡Œï¼‰ä»¥æ±‚å¾—æµ‹è¯•æ¡ä»¶ï¼Œå¹¶ç”¨ <code>i32.eqz</code> æ£€æŸ¥ç»“æœï¼ˆç¬¬ 5 è¡Œï¼‰ã€‚è‹¥æ¡ä»¶ä¸ºå‡ï¼Œ<code>br_if $L0</code> è·³è½¬åˆ° <code>$L0</code> æœ«å°¾ï¼Œä»è€Œ<strong>ç»ˆæ­¢å¾ªç¯</strong>ï¼ˆç¬¬ 6 è¡Œï¼‰ï¼›è‹¥æ¡ä»¶ä¸ºçœŸï¼Œåˆ™ä¾æ¬¡è°ƒç”¨ <code>$body</code> ä¸ <code>$incre</code> æ‰§è¡Œå¾ªç¯ä½“ä¸æ›´æ–°ï¼ˆç¬¬ 7â€“8 è¡Œï¼‰ï¼Œéšå <code>br $L1</code> <strong>è·³å›</strong>æ ‡ç­¾ <code>$L1</code> ä»¥ç»§ç»­ä¸‹ä¸€è½®è¿­ä»£ï¼ˆç¬¬ 9 è¡Œï¼‰ã€‚</p></li><li><p><strong>(p_{T6})</strong>ï¼šä¸ (p_{T5}) <strong>ç›¸åŒ</strong>ï¼ˆå³å¾ªç¯ä½“ä¸æ›´æ–°è¡¨è¾¾å¼ä¸­ä¸å¾—å‡ºç° <code>break</code>ã€<code>continue</code>ã€<code>return</code>ã€<code>yield</code>ã€<code>throw</code>ï¼‰ã€‚</p></li></ul><hr><h4 id="_7-æ··æ·†-while-å¾ªç¯-obfuscating-while-loops" tabindex="-1"><a class="header-anchor" href="#_7-æ··æ·†-while-å¾ªç¯-obfuscating-while-loops"><span>7) æ··æ·† <code>while</code> å¾ªç¯ï¼ˆObfuscating While Loopsï¼‰</span></a></h4><p>ä¸ä¸Šæ–‡ç±»ä¼¼ï¼Œæˆ‘ä»¬ä¸º <code>while</code> å¾ªç¯ç»™å‡ºå˜æ¢è§„åˆ™ <strong>T7-WhileStatement</strong> ((L_{T7}, p_{T7}, t_{T7}))ï¼š</p><ul><li><p><strong>(L_{T7})</strong>ï¼šé€‚ç”¨äº <strong><code>WhileStatement</code></strong> èŠ‚ç‚¹ã€‚</p></li><li><p><strong>(t_{T7})</strong>ï¼šè§è¡¨ I çš„ <strong>T7-WhileStatement</strong> è¡Œï¼Œå…¶æ€»ä½“æµç¨‹ä¸ (t_{T6})<strong>ç›¸ä¼¼</strong>ã€‚ä¸»è¦å·®å¼‚åœ¨äº <code>while</code> å¾ªç¯<strong>æ²¡æœ‰æ›´æ–°è¡¨è¾¾å¼</strong>ä¸<strong>å¾ªç¯è®¡æ•°å™¨åˆå§‹åŒ–</strong>ã€‚å› æ­¤ï¼Œä»…éœ€æŠŠ<strong>å¾ªç¯æ¡ä»¶</strong>ä¸<strong>å¾ªç¯ä½“</strong>åˆ†åˆ«åŒ…è£¹æˆåŒ¿åå‡½æ•°å¹¶å¯¼å…¥ WebAssemblyï¼ˆç¬¬ 4ã€7 è¡Œï¼‰ï¼›å®šä¹‰å¹¶å¯¼å‡ºå‡½æ•° <strong><code>$f</code></strong>ï¼Œé€šè¿‡åœ¨ <code>loop</code> ä¸­<strong>è°ƒç”¨å¯¼å…¥å‡½æ•°</strong>æ¥æ¨¡æ‹Ÿ JavaScript çš„ <code>while</code>ï¼ˆç¬¬ 5 è¡Œï¼‰ã€‚</p></li><li><p><strong>(p_{T7})</strong>ï¼šä¸ (p_{T5}) å’Œ (p_{T6})<strong>ç›¸åŒ</strong>ã€‚</p></li></ul><h3 id="c-åŒæ­¥ä¸å¼‚æ­¥çš„-webassembly-å®ä¾‹åŒ–" tabindex="-1"><a class="header-anchor" href="#c-åŒæ­¥ä¸å¼‚æ­¥çš„-webassembly-å®ä¾‹åŒ–"><span>C. åŒæ­¥ä¸å¼‚æ­¥çš„ WebAssembly å®ä¾‹åŒ–</span></a></h3><p>å¯¹ç¬¬ IV-B èŠ‚ä¸­çš„æ¯æ¡å˜æ¢è§„åˆ™ï¼ˆ<strong>é™¤ T4-CallExpression(b) å¤–</strong>ï¼‰ï¼Œæˆ‘ä»¬éƒ½ç»™å‡ºäº†ä¸¤ç§å˜ä½“ï¼Œå®ƒä»¬çš„åŒºåˆ«åœ¨äºï¼šæ˜¯å¦<strong>åŒæ­¥</strong>æˆ–<strong>å¼‚æ­¥</strong>å®ä¾‹åŒ– WebAssembly æ¨¡å—â€”â€”ä¹Ÿå°±æ˜¯ <code>instanWasm()</code> åŸè¯­çš„ä¸åŒå®ç°æ–¹å¼ã€‚</p><hr><h4 id="åŒæ­¥å®ä¾‹åŒ–" tabindex="-1"><a class="header-anchor" href="#åŒæ­¥å®ä¾‹åŒ–"><span>åŒæ­¥å®ä¾‹åŒ–</span></a></h4><p>åŒæ­¥å˜ä½“ä½¿ç”¨ <code>WebAssembly.Module</code> ä¸ <code>WebAssembly.Instance</code> ä¸¤ä¸ªæ„é€ å™¨å®Œæˆå®ä¾‹åŒ–ã€‚è¦ç‚¹å¦‚ä¸‹ï¼š</p><ul><li>å°†å·²ç¼–è¯‘çš„æ¨¡å—å­—èŠ‚ä¼ å…¥ <code>WebAssembly.Module</code> æ„é€ å™¨ã€‚è¯¥æ„é€ å™¨æ¥æ”¶<strong>ç±»å‹åŒ–æ•°ç»„</strong>ä½œä¸ºè¾“å…¥ï¼Œå› æ­¤æˆ‘ä»¬æŠŠæ¨¡å—å­—èŠ‚å…ˆç¼–ç ä¸º <strong>base64</strong> å­—ç¬¦ä¸²ï¼Œå¹¶åœ¨è¿è¡Œæ—¶è§£ç ä¸º <code>Uint8Array</code> åå†ä¼ å…¥ã€‚</li><li>éšåæŠŠå¾—åˆ°çš„ <strong>æ¨¡å—å¯¹è±¡</strong>ä¸<strong>å¯¼å…¥å¯¹è±¡</strong>ä¸€èµ·ä¼ å…¥ <code>WebAssembly.Instance</code> æ„é€ å™¨ï¼Œè·å¾—çš„ <strong>å®ä¾‹å¯¹è±¡</strong>ä¾›å„ä¸ªå˜æ¢å‡½æ•°ä½¿ç”¨ã€‚</li></ul><figure><img src="/assets/images/scholar/Wobfuscator%EF%BC%9A%E9%80%9A%E8%BF%87%E9%80%89%E6%8B%A9%E6%80%A7%E5%9C%B0%E7%BF%BB%E8%AF%91%E5%88%B0WASM%E6%9D%A5%E6%B7%B7%E6%B7%86JavaScript%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/figure2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ä¸Šè¿°åšæ³•å±äºæ ‡å‡†çš„<strong>åŒæ­¥</strong>ä»£ç ï¼ŒåŸåˆ™ä¸Šå¯¹å¦‚ä½•ä¸åŸå§‹ JavaScript åº”ç”¨é›†æˆå¹¶æ— é™åˆ¶ã€‚<strong>ç„¶è€Œ</strong>ï¼Œ<code>WebAssembly.Module</code> æ„é€ å™¨ä¼š<strong>é˜»å¡ JS ä¸»çº¿ç¨‹</strong>ï¼Œå„æµè§ˆå™¨å‚å•†å¹¶ä¸æ¨èè¿™ç§æ–¹å¼ã€‚å°¤å…¶æ˜¯åœ¨ Chromium ç³»åˆ—ä¸­ï¼Œ<strong>è¾“å…¥æ¨¡å—å¤§å°è¢«é™åˆ¶ä¸º 4KB ä»¥å†…</strong>ï¼Œè¶…å‡ºåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</p><p>ä¸ºç»•è¿‡è¯¥é™åˆ¶ï¼Œæ¯ä¸ªåŒæ­¥å˜æ¢å¯ä»¥<strong>è¾“å‡ºä¸€ä¸ªæˆ–å¤šä¸ª</strong> WebAssembly æ¨¡å—ï¼š</p><ul><li><strong>ä»…äº§ç”Ÿä¸€ä¸ªæ¨¡å—/ç¿»è¯‘ç‚¹</strong>çš„è§„åˆ™ï¼šT3-FunctionNameã€T4-CallExpression(a)ã€T5-IfStatementã€T6-ForStatementã€T7-WhileStatementã€‚</li><li><strong>å¯èƒ½äº§ç”Ÿå¤šä¸ªæ¨¡å—</strong>çš„è§„åˆ™ï¼šT1-StringLiteralã€T2-ArrayInitializationã€T4-CallExpression(b)ã€‚åŸå› æ˜¯è¿™äº›è§„åˆ™åœ¨æ¨¡å—ä¸­å­˜æ”¾çš„æ•°æ®è§„æ¨¡å¯èƒ½<strong>è¶…è¿‡ 4KB</strong>ã€‚<br> å½“å•ä¸ªæ¨¡å—<strong>è¿‡å¤§</strong>ï¼ˆä¾‹å¦‚æ•°æ®æ®µåŒ…å«å¤§é‡å­—ç¬¦ä¸²å­—é¢é‡ï¼‰æ—¶ï¼Œæˆ‘ä»¬ä¼šå°†å…¶<strong>æ‹†åˆ†ä¸ºå¤šä¸ªæ¨¡å—</strong>ä»¥ä¿è¯æ¯ä¸ªæ¨¡å—ä¸è¶…è¿‡ 4KBã€‚å¯¹äº<strong>å•ä¸ªå­—ç¬¦ä¸²</strong>è‹¥è¶…è¿‡ 4KBï¼Œä¹Ÿä¼šæŠŠå…¶<strong>æ‹†åˆ†</strong>åˆ°å¤šä¸ªæ¨¡å—ä¸­ï¼Œå¹¶åœ¨<strong>å­—ç¬¦ä¸²é‡å»ºé˜¶æ®µ</strong>å†è¿›è¡Œæ‹¼æ¥ã€‚</li></ul><hr><h4 id="å¼‚æ­¥å®ä¾‹åŒ–" tabindex="-1"><a class="header-anchor" href="#å¼‚æ­¥å®ä¾‹åŒ–"><span>å¼‚æ­¥å®ä¾‹åŒ–</span></a></h4><p>æˆ‘ä»¬åŒæ—¶æ”¯æŒæµè§ˆå™¨<strong>æ¨è</strong>çš„å¼‚æ­¥å®ä¾‹åŒ–æ–¹å¼ã€‚ä¸åŒæ­¥æ–¹å¼ç›¸æ¯”ï¼Œå¼‚æ­¥æ–¹å¼å…·æœ‰å¤šé¡¹ä¼˜åŠ¿ï¼š</p><ul><li><strong>æ¨¡å—å¤§å°ä¸å—é™åˆ¶</strong>ï¼›</li><li>å…è®¸å°†ç”Ÿæˆçš„ WebAssembly æ¨¡å—<strong>å­˜æ”¾åˆ°ç‹¬ç«‹æ–‡ä»¶</strong>ï¼›</li><li>ä½¿æ¯ä¸ªå˜æ¢éƒ½å¯ä»¥åª<strong>è¾“å‡ºä¸€ä¸ª</strong> WebAssembly æ¨¡å—ã€‚</li></ul><p>åœ¨è¿™äº›å¼‚æ­¥å˜ä½“ä¸­ï¼Œ<code>instanWasm()</code> é€šè¿‡ <code>WebAssembly.instantiateStreaming()</code> å®ç°ï¼Œå¦‚å›¾3æ‰€ç¤ºã€‚è¯¥ API ä¼šåœ¨<strong>ç‹¬ç«‹çº¿ç¨‹</strong>ä¸Šå®Œæˆç¼–è¯‘ï¼Œä¸å†é˜»å¡ä¸»çº¿ç¨‹ï¼›å®ƒè¿”å›ä¸€ä¸ª <strong>Promise</strong>ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ <strong><code>await</code></strong> ç­‰å¾…å…¶<strong>è§£æå®Œæˆ</strong>åå†ç»§ç»­æ‰§è¡Œã€‚</p><figure><img src="/assets/images/scholar/Wobfuscator%EF%BC%9A%E9%80%9A%E8%BF%87%E9%80%89%E6%8B%A9%E6%80%A7%E5%9C%B0%E7%BF%BB%E8%AF%91%E5%88%B0WASM%E6%9D%A5%E6%B7%B7%E6%B7%86JavaScript%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/figure3.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>ç”±äº <code>await</code> åªèƒ½åœ¨ <strong><code>async</code> å‡½æ•°</strong>ä¸­ä½¿ç”¨ï¼Œæˆ‘ä»¬å°†å®ä¾‹åŒ–è¿‡ç¨‹åŒ…è£…åœ¨ä¸€ä¸ª <code>async</code> çš„åŒ¿åå‡½æ•°ä¸­ã€‚ç›¸åº”åœ°ï¼Œè°ƒç”¨è¯¥åŒ¿åå‡½æ•°çš„è¯­å¥ä¹Ÿå¿…é¡»åŠ ä¸Š <code>await</code>ï¼›è‹¥æŠŠæ­¤è¿‡ç¨‹æ”¾åœ¨æŸä¸ªå¤–å±‚å‡½æ•°ï¼ˆä¾‹å¦‚ <code>someFunction</code>ï¼‰ä¸­ï¼Œåˆ™è¯¥å¤–å±‚å‡½æ•°éœ€è¦æ ‡æ³¨ <strong><code>async</code></strong>ã€‚æ­¤å¤–ï¼Œä»£ç ä¸­<strong>ä»»ä½•è°ƒç”¨</strong>è¯¥å¤–å±‚å‡½æ•°çš„åœ°æ–¹ï¼Œä¹Ÿéƒ½éœ€è¦<strong>å¢åŠ  <code>await</code></strong>ã€‚</li><li>ç”±æ­¤å¯è§ï¼Œåœ¨æŸä¸€å¤„ç¿»è¯‘ä½ç‚¹å¼•å…¥ <code>async/await</code>ï¼Œä¼šä½¿è¿™äº›å…³é”®å­—<strong>æ²¿è°ƒç”¨é“¾å‘å¤–ä¼ æ’­</strong>ï¼Œå½±å“åˆ°æ•´ä¸ªæ–‡ä»¶ä¸­çš„ç›¸å…³å‡½æ•°å®šä¹‰ä¸è°ƒç”¨ç‚¹ã€‚</li></ul><p>è¿™ç§å…³é”®å­—ä¼ æ’­ä½¿å¾—<strong>å¼‚æ­¥å˜ä½“çš„è®¾è®¡ä¸å®ç°å¹¶ä¸ç®€å•</strong>ã€‚æˆ‘ä»¬é‡åˆ°äº†ä¸‰ç±»<strong>éš¾ä»¥ä¼ æ’­</strong> <code>async/await</code> çš„ä»£ç ä½ç½®ï¼š</p><ol><li><strong>ä½œä¸ºå®å‚ä¼ é€’çš„åŒ¿åå‡½æ•°</strong>ï¼ˆå¦‚ <code>.map</code> ç­‰ï¼‰â€”â€”éœ€æ ¹æ®è¢«è°ƒç”¨å‡½æ•°çš„è¿”å›ç±»å‹åˆ¤æ–­ <code>await</code> åº”æ·»åŠ åœ¨<strong>è¢«è°ƒå‡½æ•°çš„å®šä¹‰</strong>ä¸­è¿˜æ˜¯<strong>å…¶è°ƒç”¨å¤„</strong>ï¼›</li><li><strong>ç±»æ„é€ å‡½æ•°</strong>æ— æ³•è¢«æ ‡è®°ä¸º <code>async</code>â€”â€”å› æ­¤éœ€è¦åœ¨æ•´ä¸ªè°ƒç”¨é“¾ä¸­æ£€æµ‹æ˜¯å¦å­˜åœ¨æ„é€ å‡½æ•°è°ƒç”¨ï¼›</li><li>è‹¥<strong>å˜æ¢åçš„å‡½æ•°è¢«æ¨¡å—å¯¼å‡º</strong>ï¼Œåˆ™<strong>å…¶ä»–æ–‡ä»¶</strong>åœ¨å¯¼å…¥å¹¶è°ƒç”¨è¯¥å‡½æ•°æ—¶ä¹Ÿå¿…é¡»æ£€æŸ¥å¹¶ç›¸åº”åœ°æ·»åŠ  <code>async/await</code>ã€‚</li></ol><hr><h4 id="å°ç»“ä¸é™åˆ¶" tabindex="-1"><a class="header-anchor" href="#å°ç»“ä¸é™åˆ¶"><span>å°ç»“ä¸é™åˆ¶</span></a></h4><p>é™¤ <strong>T4-CallExpression(b)</strong> å¤–ï¼Œå…¶ä½™æ‰€æœ‰å˜æ¢è§„åˆ™å‡æä¾›<strong>åŒæ­¥</strong>ä¸<strong>å¼‚æ­¥</strong>ä¸¤ä¸ªå˜ä½“ã€‚T4-CallExpression(b) ä¾èµ–ä¸€ä¸ª<strong>å®éªŒæ€§çš„ WebAssembly ææ¡ˆ</strong>ï¼Œå…¶<strong>å‰ç½®æ¡ä»¶å¤æ‚</strong>ï¼›è‹¥å†å åŠ å¼‚æ­¥æ–¹å¼çš„é¢å¤–é™åˆ¶ï¼Œå¯èƒ½ä¼š<strong>ç ´ååŸå§‹è¯­ä¹‰</strong>å¹¶å¯¼è‡´é”™è¯¯çš„å˜æ¢ã€‚å¦ä¸€æ–¹é¢ï¼ŒT4-CallExpression(b) ç›¸æ¯” (a) <strong>æš´éœ²äº†æ›´å¤šç¿»è¯‘ç‚¹</strong>ï¼Œä»è€Œå¢åŠ äº†å¯èƒ½å‡ºç°çš„<strong>è¾¹ç•Œæƒ…å½¢</strong>ã€‚å› æ­¤ï¼Œå°†äºŒè€…ç»“åˆç•™ä½œ<strong>æœªæ¥å·¥ä½œ</strong>ã€‚</p><h3 id="d-åº”ç”¨å˜æ¢-applying-transformations" tabindex="-1"><a class="header-anchor" href="#d-åº”ç”¨å˜æ¢-applying-transformations"><span>D. åº”ç”¨å˜æ¢ï¼ˆApplying Transformationsï¼‰</span></a></h3><p>æˆ‘ä»¬ç°åœ¨ç»™å‡ºå°†è¿™äº›å˜æ¢åº”ç”¨åˆ°ç»™å®š JavaScript æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰çš„æ€»ä½“ç®—æ³•ã€‚ç®—æ³•çš„è¾“å…¥æ˜¯ï¼šä¸€ç»„å˜æ¢è§„åˆ™ï¼Œä»¥åŠåŸå§‹ JavaScript æ–‡ä»¶çš„ ASTã€‚ç®—æ³•åŒ…å«ä¸‰ä¸ªæ­¥éª¤ï¼šï¼ˆaï¼‰è¯†åˆ«åº”å½“æ–½åŠ å˜æ¢çš„ AST èŠ‚ç‚¹ï¼Œå³<strong>ç¿»è¯‘ç‚¹ï¼ˆtranslation sitesï¼‰</strong>ï¼›ï¼ˆbï¼‰é€šè¿‡ä¿®æ”¹è¿™äº›ç¿»è¯‘ç‚¹ä¸ºæ ¹çš„å­æ ‘æ¥<strong>é‡å†™ AST</strong>ï¼›ï¼ˆcï¼‰åœ¨ AST æ ¹éƒ¨<strong>æ·»åŠ ä»£ç </strong>ä»¥å®ä¾‹åŒ–ç”Ÿæˆçš„ WebAssembly æ¨¡å—ã€‚ç®—æ³•çš„è¾“å‡ºæ˜¯å¯¹åº”äºæ··æ·†å JavaScript ä»£ç çš„<strong>å·²å˜æ¢ AST</strong>ã€‚</p><h4 id="a-å°†-ast-èŠ‚ç‚¹è¯†åˆ«ä¸ºç¿»è¯‘ç‚¹-identifying-ast-nodes-as-translation-sites" tabindex="-1"><a class="header-anchor" href="#a-å°†-ast-èŠ‚ç‚¹è¯†åˆ«ä¸ºç¿»è¯‘ç‚¹-identifying-ast-nodes-as-translation-sites"><span>a) å°† AST èŠ‚ç‚¹è¯†åˆ«ä¸ºç¿»è¯‘ç‚¹ï¼ˆIdentifying AST Nodes as Translation Sitesï¼‰</span></a></h4><p>ä¸ºäº†è¯†åˆ«ç¿»è¯‘ç‚¹ï¼Œæˆ‘ä»¬ä»æ ¹èŠ‚ç‚¹å¼€å§‹å¯¹ AST æ‰§è¡Œ<strong>å…ˆåºéå†</strong>ã€‚å¯¹æ¯ä¸ªè®¿é—®åˆ°çš„èŠ‚ç‚¹ <code>n</code>ï¼Œç®—æ³•éƒ½ä¼šéå†å˜æ¢è§„åˆ™åˆ—è¡¨å¹¶æ£€æŸ¥å“ªäº›è§„åˆ™å¯ç”¨ã€‚è‹¥æŸä¸ªå˜æ¢è§„åˆ™ <code>(L, t, p)</code> é€‚ç”¨ï¼Œåˆ™å…¶å‰æ <code>p</code> åœ¨èŠ‚ç‚¹ <code>n</code> ä¸Šæˆç«‹ï¼Œä¸” <code>n</code> æ‰€åœ¨çš„ä½ç½®å±äºä½ç½®é›†åˆ <code>L</code>ã€‚å¯¹æ¯ä¸€æ¡å˜æ¢è§„åˆ™ï¼Œæˆ‘ä»¬éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„ç¿»è¯‘ç‚¹èŠ‚ç‚¹é›†åˆã€‚</p><h4 id="b-é‡å†™-ast-å­æ ‘-rewriting-ast-subtrees" tabindex="-1"><a class="header-anchor" href="#b-é‡å†™-ast-å­æ ‘-rewriting-ast-subtrees"><span>b) é‡å†™ AST å­æ ‘ï¼ˆRewriting AST Subtreesï¼‰</span></a></h4><p>åœ¨è¯†åˆ«å‡ºæ‰€æœ‰ç¿»è¯‘ç‚¹èŠ‚ç‚¹ä¹‹åï¼Œä¸‹ä¸€æ­¥æ˜¯é‡å†™ä»¥è¿™äº›èŠ‚ç‚¹ä¸ºæ ¹çš„å­æ ‘ã€‚ç®—æ³•ä¼šæŒ‰ç›®æ ‡<strong>å¥æ³•ç»“æ„çš„ç²’åº¦å¤§å°</strong>æ¥åº”ç”¨å„ç±»å˜æ¢ã€‚å…·ä½“è€Œè¨€ï¼Œæˆ‘ä»¬æŒ‰å¦‚ä¸‹é¡ºåºéå†å˜æ¢è§„åˆ™ï¼Œå¹¶ä¸”åœ¨è¿›å…¥ä¸‹ä¸€æ¡è§„åˆ™ä¹‹å‰ï¼Œå¯¹æ‰€æœ‰å¯åº”ç”¨çš„å­æ ‘éƒ½æ–½åŠ å½“å‰è§„åˆ™ï¼š</p><p><code>T1-StringLiteral</code>, <code>T2-ArrayInitialization</code>, <code>T3-FunctionName</code>, <code>T4-CallExpression</code>, <code>T5-IfStatement</code>, <code>T6-ForStatement</code>, <code>T7-WhileStatement</code>ã€‚</p><p>è¿™æ ·çš„æ’åºç¡®ä¿ï¼šé’ˆå¯¹<strong>æ›´ç»†ç²’åº¦</strong>å¥æ³•ç»“æ„ï¼ˆå¦‚å­—ç¬¦ä¸²ä¸æ•°ç»„å­—é¢é‡ï¼‰çš„å˜æ¢å…ˆäºé’ˆå¯¹<strong>æ›´ç²—ç²’åº¦</strong>ç»“æ„ï¼ˆå¦‚å¾ªç¯ï¼‰çš„å˜æ¢æ‰§è¡Œâ€”â€”å¦åˆ™ï¼Œå…ˆåšç²—ç²’åº¦æ”¹å†™å¯èƒ½ä¼šé˜»æ­¢åç»­ç»†ç²’åº¦å˜æ¢çš„åº”ç”¨ã€‚å¯¹äºæ¯æ¡è§„åˆ™ <code>(L, t, p)</code>ï¼Œç®—æ³•ä¼šè®¿é—®å…¶æ‰€æœ‰ç¿»è¯‘ç‚¹èŠ‚ç‚¹ï¼Œå¹¶åº”ç”¨å˜æ¢å‡½æ•° <code>t</code>ã€‚è¯¥å‡½æ•°<strong>å°±åœ°ï¼ˆin-placeï¼‰ä¿®æ”¹</strong> ASTï¼Œå¹¶äº§ç”Ÿåœ¨é‡å†™ä»£ç ä¸­è¦ä½¿ç”¨çš„ä¸€ä¸ª WebAssembly æ¨¡å—ã€‚è¯¥æ­¥éª¤çš„è¾“å‡ºæ˜¯<strong>é‡å†™åçš„ AST</strong>ä»¥åŠä¸€ç»„ WebAssembly æ¨¡å—é›†åˆ <code>W</code>ã€‚</p><h4 id="c-æ·»åŠ -webassembly-å®ä¾‹åŒ–ä»£ç -adding-webassembly-instantiation-code" tabindex="-1"><a class="header-anchor" href="#c-æ·»åŠ -webassembly-å®ä¾‹åŒ–ä»£ç -adding-webassembly-instantiation-code"><span>c) æ·»åŠ  WebAssembly å®ä¾‹åŒ–ä»£ç ï¼ˆAdding WebAssembly Instantiation Codeï¼‰</span></a></h4><p>æœ€åä¸€æ­¥æ˜¯åœ¨ä»£ç ä¸­æ·»åŠ å¯¹é›†åˆ <code>W</code> ä¸­ WebAssembly æ¨¡å—çš„<strong>å®ä¾‹åŒ–</strong>é€»è¾‘ã€‚ä¸ºæ­¤ï¼Œç®—æ³•ä¼šåœ¨è„šæœ¬å¼€å¤´ï¼ˆå³ AST çš„æ ¹éƒ¨ï¼‰æ’å…¥ç›¸åº”çš„è¯­å¥ã€‚å¯¹äº<strong>åŒæ­¥å®ä¾‹åŒ–</strong>çš„æ¨¡å—ï¼Œæˆ‘ä»¬å°† <code>W</code> ä¸­çš„æ¯ä¸ªæ¨¡å—ç¼–ç ä¸º <strong>base64</strong> å­—ç¬¦ä¸²ï¼Œå¹¶åŠ å…¥è§£ç ä¸å®ä¾‹åŒ–è¿™äº›æ¨¡å—çš„è¯­å¥ã€‚å¯¹äº<strong>å¼‚æ­¥å®ä¾‹åŒ–</strong>çš„æ¨¡å—ï¼Œæˆ‘ä»¬æŠŠæ¨¡å—åºåˆ—åŒ–åˆ°<strong>å•ç‹¬æ–‡ä»¶</strong>ï¼Œå¹¶åœ¨ä»£ç ä¸­å‘èµ·ç›¸åº”çš„ <code>fetch</code> è¯·æ±‚ã€‚å¯¹å¼‚æ­¥ç¿»è¯‘ï¼Œç®—æ³•è¿˜ä¼šåœ¨ AST æ ¹éƒ¨å‘¨å›´é¢å¤–æ·»åŠ  <strong><code>async wrapper</code></strong>ï¼ˆè§ç¬¬ IV-A èŠ‚ï¼‰ï¼Œä»¥ä¾¿åç»­ä»£ç èƒ½å¤Ÿä½¿ç”¨å¼‚æ­¥å…³é”®å­—ã€‚</p><h2 id="_5-å®ç°" tabindex="-1"><a class="header-anchor" href="#_5-å®ç°"><span>5. å®ç°</span></a></h2><p>æˆ‘ä»¬ç”¨Node.jsï¼ˆv14.17.2ï¼‰å’ŒTypeScriptå®ç°äº†Wobfuscatorã€‚è¯¥å·¥å…·ä¾é Esprimaï¼ˆv4.0.1ï¼‰[3]å’ŒEspreeï¼ˆv7.3.1ï¼‰[2]åŒ…æ¥è§£æJavaScriptæ–‡ä»¶ï¼Œå¹¶ä¾é Escodegenï¼ˆ2.0.0ï¼‰[1]å°†è½¬æ¢åçš„ASTè½¬æ¢å›JavaScriptæ–‡ä»¶ã€‚Wabt.jsï¼ˆ1.0.23ï¼‰[8]åŒ…ç”¨äºç”Ÿæˆæ··æ·†ä¸­ä½¿ç”¨çš„WebAssemblyæ¨¡å—ã€‚</p><p>æˆ‘ä»¬çš„è¯„ä¼°æ•°æ®å·²å¼€æºï¼šhttps://github.com/js2wasm-obfuscator/translator. æˆ‘ä»¬æ ¹æ®è¦æ±‚æä¾›Wobfusctorçš„å®ç°ã€‚æˆ‘ä»¬è®¤ä¸ºï¼Œè¿™ä¸€ç­–ç•¥æœ€å¤§é™åº¦åœ°å‡å°‘äº†æ¶æ„ä½¿ç”¨çš„å¨èƒï¼ŒåŒæ—¶ä¹Ÿå¸®åŠ©ç ”ç©¶äººå‘˜ç‹¬ç«‹å¤åˆ¶æˆ‘ä»¬çš„ç»“æœï¼Œç¡®è®¤ç°æœ‰æ¶æ„è½¯ä»¶æ£€æµ‹å™¨çš„å·²è¯†åˆ«å¼±ç‚¹ï¼Œå¹¶ä¸ºæœªæ¥æ”¹è¿›æ¶æ„è½¯ä»¶æ£€æµ‹å™¨ç ”ç©¶å¥ å®šåŸºç¡€ã€‚</p><h2 id="_6-è¯„ä¼°" tabindex="-1"><a class="header-anchor" href="#_6-è¯„ä¼°"><span>6. è¯„ä¼°</span></a></h2><p>æˆ‘ä»¬è¯„ä¼°äº†WobfusctoråŠå…¶ä½¿ç”¨æœºä¼šç¿»è¯‘åˆ°WebAssemblyæ¥æ··æ·†æ¶æ„JavaScriptçš„èƒ½åŠ›ï¼Œä»¥åŠä»¥ä¸‹ä¸»è¦ç ”ç©¶é—®é¢˜ï¼š</p><ul><li>RQ1â€“æœ‰æ•ˆæ€§ï¼šè¯¥æ–¹æ³•åœ¨è§„é¿æœ€å…ˆè¿›çš„JavaScriptæ¶æ„è½¯ä»¶æ£€æµ‹å™¨æ–¹é¢æœ‰å¤šæœ‰æ•ˆï¼Œå“ªäº›è½¬æ¢æœ€æœ‰æ•ˆï¼Ÿæˆ‘ä»¬çš„æ–¹æ³•ä¸å…¶ä»–æœ€å…ˆè¿›çš„æ··æ·†å™¨ç›¸æ¯”å¦‚ä½•ï¼Ÿ</li><li>RQ2â€“æ­£ç¡®æ€§ï¼šæˆ‘ä»¬çš„ä»£ç è½¬æ¢æ˜¯å¦ä¿ç•™äº†è½¬æ¢ä»£ç çš„è¯­ä¹‰ï¼Ÿ</li><li>RQ3â€“æ•ˆç‡ï¼šè½¬æ¢ä¼šå¸¦æ¥å¤šå°‘è¿è¡Œæ—¶å’Œä»£ç å¤§å°å¼€é”€ï¼Œåº”ç”¨è½¬æ¢éœ€è¦å¤šé•¿æ—¶é—´ï¼Ÿ</li></ul><p>ä¸ºäº†ç ”ç©¶è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬å¯¹æˆ‘ä»¬çš„è½¬æ¢åœ¨é€ƒé¿æ£€æµ‹æ–¹é¢çš„æœ‰æ•ˆæ€§è¿›è¡Œäº†å…¨é¢åˆ†æã€‚æˆ‘ä»¬åœ¨æ¶æ„å’Œè‰¯æ€§æ–‡ä»¶çš„å¤§å‹æ•°æ®é›†ä¸Šè¯„ä¼°äº†é’ˆå¯¹Wobfuscatorçš„æœ€å…ˆè¿›çš„æ£€æµ‹å·¥å…·ã€‚æˆ‘ä»¬é€šè¿‡å°†æˆ‘ä»¬çš„æ–¹æ³•ä¸æœ€å…ˆè¿›çš„å¼€æºæ··æ·†å·¥å…·è¿›è¡Œæ¯”è¾ƒï¼Œæ¥è¯„ä¼°Wobfuscatoräº§ç”Ÿçš„æ··æ·†ä¼˜åŠ¿ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨å¹¿æ³›ä½¿ç”¨å’Œæˆç†Ÿçš„npmæ¨¡å—çš„å¹¿æ³›æµ‹è¯•å¥—ä»¶æ¥éªŒè¯æˆ‘ä»¬å·¥å…·çš„æ­£ç¡®æ€§ï¼Œå¹¶è¯æ˜è¿è¡Œæ—¶å’Œä»£ç å¤§å°å¼€é”€åœ¨ç°å®ä¸–ç•Œä¸­æ˜¯å¯ä»¥æ¥å—çš„ã€‚</p><h3 id="a-å®éªŒé…ç½®" tabindex="-1"><a class="header-anchor" href="#a-å®éªŒé…ç½®"><span>A. å®éªŒé…ç½®</span></a></h3><p>1ï¼‰ æ•°æ®é›†ï¼šç”±äºä¸åŒçš„è¦æ±‚ï¼Œæˆ‘ä»¬ä¸ºä¸åŒçš„ç ”ç©¶é—®é¢˜ä½¿ç”¨ä¸åŒçš„JavaScriptç¨‹åºæ•°æ®é›†ã€‚ä¸ºäº†å›ç­”RQ1ï¼Œæˆ‘ä»¬éœ€è¦è®­ç»ƒæœ€å…ˆè¿›çš„JavaScriptæ¶æ„è½¯ä»¶æ£€æµ‹å™¨ï¼Œå¹¶å°†å…¶åº”ç”¨äºå¤§é‡çœŸå®ä¸–ç•Œçš„è‰¯æ€§å’Œæ¶æ„JavaScriptä»£ç ã€‚è¡¨äºŒæ€»ç»“äº†æˆ‘ä»¬ä½¿ç”¨çš„æ•°æ®é›†ã€‚è‰¯æ€§ä»£ç ç”±æ¥è‡ªJS150kæ•°æ®é›†çš„149677ä¸ªæ–‡ä»¶ç»„æˆ[49]ã€‚æ¶æ„ä»£ç ç”±43499ä¸ªæ ·æœ¬ç»„æˆï¼Œå…¶ä¸­2674ä¸ªæ ·æœ¬æ¥è‡ªVirusTotal[7]ï¼Œ39450ä¸ªæ ·æœ¬æ¥è‡ªHynek Petrak JavaScriptæ¶æ„è½¯ä»¶é›†åˆ[47]ï¼Œ1375ä¸ªæ ·æœ¬æ¥è‡ªGeeksOnSecurityæ¶æ„JavaScriptæ•°æ®é›†[11]ã€‚è¿™äº›æ•°æ®é›†æŒ‰å…¶åŒ…å«çš„æ¶æ„è½¯ä»¶ç±»åˆ«è¿›ä¸€æ­¥ç»†åˆ†ï¼Œå¦‚ç‰¹æ´›ä¼Šæœ¨é©¬ã€å‹’ç´¢è½¯ä»¶ã€æ»´ç®¡ã€‚æˆ‘ä»¬åœ¨è¡¨IXçš„å‰å››åˆ—ä¸­åˆ—å‡ºäº†æ¶æ„æ•°æ®é›†çš„ç»†åˆ†ã€‚</p><figure><img src="/assets/images/scholar/Wobfuscator%EF%BC%9A%E9%80%9A%E8%BF%87%E9%80%89%E6%8B%A9%E6%80%A7%E5%9C%B0%E7%BF%BB%E8%AF%91%E5%88%B0WASM%E6%9D%A5%E6%B7%B7%E6%B7%86JavaScript%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/table2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>å›ç­”RQ2å’ŒRQ3éœ€è¦åœ¨åº”ç”¨è½¬æ¢ä¹‹å‰å’Œä¹‹åæ‰§è¡Œä»£ç ã€‚æˆ‘ä»¬ä½¿ç”¨NPMä¸Šæµè¡Œçš„å¤§å‹JavaScripté¡¹ç›®åŠå…¶æµ‹è¯•å¥—ä»¶çš„æ•°æ®é›†ã€‚ä¸ºäº†ç¡®å®šåˆé€‚çš„é¡¹ç›®ï¼Œæˆ‘ä»¬ä»æœ€ä¾èµ–çš„NPMæ¨¡å—[12]ä¸­é€‰æ‹©äº†å…­ä¸ªåŒ…å«å¹¿æ³›æµ‹è¯•å¥—ä»¶çš„æ¨¡å—ï¼ˆè¡¨Vçš„ç¬¬ä¸€åˆ—ï¼‰ã€‚</p><p>2ï¼‰ JavaScriptæ¶æ„è½¯ä»¶æ£€æµ‹å™¨ï¼šæˆ‘ä»¬é’ˆå¯¹å››ç§æœ€å…ˆè¿›çš„ã€é™æ€çš„ã€åŸºäºå­¦ä¹ çš„JavaScriptæ¶æ„è½¯ä»¶æ¢æµ‹å™¨æ¥è¯„ä¼°æˆ‘ä»¬çš„æ··æ·†æŠ€æœ¯ã€‚ä¸ºäº†è®­ç»ƒå®ƒä»¬ï¼Œæˆ‘ä»¬å°†è‰¯æ€§å’Œæ¶æ„æ•°æ®é›†åˆ†ä¸ºè®­ç»ƒé›†ã€éªŒè¯é›†å’Œæµ‹è¯•é›†ï¼Œåˆ†åˆ«åŒ…å«70%ã€15%å’Œ15%çš„æ ·æœ¬ã€‚æˆ‘ä»¬æŒ‰ç…§æ¯ä¸ªé¡¹ç›®æä¾›çš„æ­¥éª¤ï¼Œç”¨æ‰€éœ€çš„é…ç½®è®­ç»ƒæ£€æµ‹æ¨¡å‹ã€‚</p><p>Cujo[50]æ˜¯ä¸€ç§æ··åˆJavaScriptæ¶æ„è½¯ä»¶æ£€æµ‹å™¨ï¼Œç”¨äºæ£€æµ‹é©±åŠ¨å™¨ä¸‹è½½æ”»å‡»ã€‚å®ƒå¯¹ç½‘ç«™ä¸Šè¿è¡Œçš„JavaScriptæ–‡ä»¶è¿›è¡Œè¯æ³•åˆ†æï¼Œå¹¶é€šè¿‡ç›‘æ§æŠ½è±¡çš„è¿è¡Œæ—¶è¡Œä¸ºè¿›è¡ŒåŠ¨æ€åˆ†æã€‚å¯¹äºæˆ‘ä»¬çš„è¯„ä¼°ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†é™æ€æ£€æµ‹éƒ¨åˆ†ï¼Œè¯¥éƒ¨åˆ†åŸºäºFassç­‰äºº[18]æä¾›çš„Cujoçš„é‡æ–°å®ç°ã€‚</p><p>Zozzle[24]æ˜¯ä¸€ä¸ªä¸»è¦æ˜¯é™æ€çš„æµè§ˆå™¨å†…æ£€æµ‹å·¥å…·ï¼Œå®ƒä½¿ç”¨ä»JavaScript ASTè·å¾—çš„è¯­æ³•ä¿¡æ¯ï¼Œå¦‚æ ‡è¯†ç¬¦åç§°å’Œä»£ç ä½ç½®ï¼Œæ¥è¯†åˆ«æ¶æ„ä»£ç ã€‚è¿™äº›ç‰¹å¾è¢«è¾“å…¥åˆ°è´å¶æ–¯åˆ†ç±»å™¨ä¸­ï¼Œä»¥å°†æ ·æœ¬æ ‡è®°ä¸ºè‰¯æ€§æˆ–æ¶æ„ã€‚æˆ‘ä»¬ä¾èµ–äºFassç­‰äºº[19]æä¾›çš„Zozzleçš„é‡æ–°å®ç°ã€‚</p><p>JaSt[28]æ˜¯ä¸€ç§æ¶æ„JavaScriptçš„é™æ€æ£€æµ‹å™¨ï¼Œå®ƒä½¿ç”¨æ¥è‡ªASTçš„è¯­æ³•ä¿¡æ¯æ¥ç”Ÿæˆè¿ç»­èŠ‚ç‚¹çš„nå…ƒè¯­æ³•ï¼Œä»¥è¯†åˆ«æŒ‡ç¤ºæ¶æ„è¡Œä¸ºçš„æ¨¡å¼ã€‚æˆ‘ä»¬ä½¿ç”¨é¡¹ç›®GitHubé¡µé¢ä¸Šæä¾›çš„å®ç°[16]ã€‚</p><p>JStap[27]æ˜¯ä¸€ç§é™æ€æ¶æ„è½¯ä»¶æ£€æµ‹å™¨ï¼Œæ ¹æ®é…ç½®åˆ›å»ºASTã€æ§åˆ¶æµå›¾ï¼ˆCFGï¼‰å’Œç¨‹åºä¾èµ–å›¾ï¼ˆPDGï¼‰ï¼Œåˆ©ç”¨è¯­æ³•ã€æ§åˆ¶æµå’Œæ•°æ®æµä¿¡æ¯ã€‚è¯¥å·¥å…·é€šè¿‡æ„é€ èŠ‚ç‚¹çš„nå…ƒè¯­æ³•æˆ–å°†ASTèŠ‚ç‚¹ç±»å‹ä¸å…¶ç›¸åº”çš„æ ‡è¯†ç¬¦/æ–‡å­—å€¼ç»„åˆæ¥æå–ç‰¹å¾ã€‚åœ¨æˆ‘ä»¬çš„è¯„ä¼°ä¸­ï¼Œæˆ‘ä»¬é‡ç‚¹å…³æ³¨å…·æœ‰nå…ƒè¯­æ³•å’Œå€¼ç‰¹å¾æå–æ¨¡å¼çš„PDGä»£ç æŠ½è±¡ã€‚æˆ‘ä»¬ä½¿ç”¨GitHubä¸Šæä¾›çš„å®ç°[17]ã€‚</p><p>3ï¼‰ JavaScriptæ··æ·†å·¥å…·ï¼šæˆ‘ä»¬å°†Wobfuscatorä¸å››ç§æœ€å…ˆè¿›çš„å¼€æºJavaScriptæ··æ·†å·¥å…·è¿›è¡Œäº†æ¯”è¾ƒã€‚JavaScriptæ··æ·†å™¨[4]æ˜¯ä¸€ä¸ªJavaScriptæ··æ·†å·¥å…·ï¼Œæ”¯æŒå¤šç§æ··æ·†æŠ€æœ¯ï¼ŒåŒ…æ‹¬å˜é‡é‡å‘½åã€æ­»ä»£ç æ³¨å…¥å’Œæ§åˆ¶æµæ‰å¹³åŒ–ã€‚Gnirts[15]ä¸“æ³¨äºåœ¨JavaScriptæ–‡ä»¶ä¸­ä¿®æ”¹å­—ç¬¦ä¸²æ–‡å­—ã€‚Jfogs[70]æ˜¯ä¸€ä¸ªæ··æ·†å·¥å…·ï¼Œä¸“æ³¨äºä»è°ƒç”¨ç«™ç‚¹ä¸­åˆ é™¤å‡½æ•°è°ƒç”¨æ ‡è¯†ç¬¦å’Œå‚æ•°ã€‚JSObfu[5]æ˜¯ä¸€ä¸ªæ··æ·†å™¨ï¼Œæ”¯æŒå°†å‡½æ•°æ ‡è¯†ç¬¦å’Œå­—ç¬¦ä¸²æ–‡å­—è½¬æ¢ä¸ºè®¡ç®—ä¸ºå¸¸é‡çš„è¡¨è¾¾å¼ã€‚æ­¤æ··æ·†å™¨è¿˜æ”¯æŒå­—ç¬¦è½¬ä¹‰ã€ç©ºç™½åˆ é™¤ç­‰ã€‚</p><p>åœ¨åŒ…å«Intel Core i7çš„å°å¼æœºä¸Šè¿›è¡Œçš„æ‰€æœ‰å®éªŒCPU@3.20GHzè¿è¡ŒUbuntu 20.04çš„32 GBå†…å­˜ã€‚</p><h3 id="b-èº²é¿æ¢æµ‹çš„æœ‰æ•ˆæ€§-rq1" tabindex="-1"><a class="header-anchor" href="#b-èº²é¿æ¢æµ‹çš„æœ‰æ•ˆæ€§-rq1"><span>B. èº²é¿æ¢æµ‹çš„æœ‰æ•ˆæ€§ï¼ˆRQ1ï¼‰</span></a></h3><h4 id="_1-æˆ‘ä»¬æ–¹æ³•çš„æœ‰æ•ˆæ€§-effectiveness-of-our-approach" tabindex="-1"><a class="header-anchor" href="#_1-æˆ‘ä»¬æ–¹æ³•çš„æœ‰æ•ˆæ€§-effectiveness-of-our-approach"><span>1) æˆ‘ä»¬æ–¹æ³•çš„æœ‰æ•ˆæ€§ï¼ˆEffectiveness of Our Approachï¼‰</span></a></h4><p>ä¸ºè¯„ä¼° <strong>Wobfuscator</strong> é€ƒé¿é™æ€æ¶æ„ JavaScript æ£€æµ‹å™¨çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬å°†å„æ£€æµ‹å™¨åœ¨<strong>åŸå§‹è¾“å…¥ç¨‹åº</strong>ä¸Šçš„è¡¨ç°ï¼Œä¸<strong>åº”ç”¨æ··æ·†ä¹‹å</strong>çš„è¡¨ç°è¿›è¡Œå¯¹æ¯”ã€‚ç”±äºè¿™äº›æ£€æµ‹å™¨æŠŠæ¯ä¸ªç¨‹åºåˆ†ç±»ä¸º<strong>è‰¯æ€§</strong>æˆ–<strong>æ¶æ€§</strong>ï¼Œå› æ­¤å¯é‡‡ç”¨äºŒåˆ†ç±»å™¨çš„å¸¸ç”¨åº¦é‡ï¼š<strong>ç²¾ç¡®ç‡ï¼ˆprecisionï¼‰<strong>ä¸</strong>å¬å›ç‡ï¼ˆrecallï¼‰</strong>ã€‚ç²¾ç¡®ç‡ç­‰äº<strong>çœŸæ­£ä¾‹ï¼ˆTPï¼‰</strong>ï¼ˆè¢«æ­£ç¡®è¯†åˆ«ä¸ºæ¶æ„çš„ç¨‹åºæ•°ï¼‰é™¤ä»¥<strong>è¢«æ ‡è®°ä¸ºæ¶æ„çš„æ€»æ•°</strong>ï¼ˆæ— è®ºæ­£ç¡®ä¸å¦ï¼‰ï¼›å¬å›ç‡ç­‰äº<strong>çœŸæ­£ä¾‹</strong>é™¤ä»¥<strong>æ•°æ®é›†ä¸­æ‰€æœ‰æ¶æ„ç¨‹åºçš„æ•°é‡</strong>ã€‚å³ï¼š</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Prec</mtext><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi></mrow></mfrac><mo separator="true">,</mo><mspace width="2em"></mspace><mtext>Rec</mtext><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex"> \text{Prec}=\frac{TP}{TP+FP},\qquad \text{Rec}=\frac{TP}{TP+FN}. </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">Prec</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">TP</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">FP</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">TP</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">Rec</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">TP</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">FN</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">TP</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">.</span></span></span></span></span></p><p>ä¸€ä¸ªå¥½çš„æ¶æ„è½¯ä»¶æ£€æµ‹å™¨åº”å½“åŒæ—¶å…·æœ‰<strong>é«˜ç²¾ç¡®ç‡</strong>ä¸<strong>é«˜å¬å›ç‡</strong>ã€‚<strong>ä½ç²¾ç¡®ç‡</strong>æ„å‘³ç€<strong>è¯¯æŠ¥ï¼ˆFPï¼‰<strong>å¾ˆå¤šï¼Œä¼šå¯¼è‡´ç³»ç»Ÿå»æ‹¦æˆªå¹¶ç ´åè‰¯æ€§çš„è„šæœ¬å’Œå¸¸ç”¨ç½‘ç«™ï¼Œè¿™æ ·çš„å·¥å…·ä¸ä¼šè¢«çœŸå®ç”¨æˆ·é‡‡çº³ã€‚<strong>ä½å¬å›ç‡</strong>æ„å‘³ç€å®é™…çš„æ¶æ„ç¨‹åºåªæœ‰å°‘æ•°è¢«å‘ç°ï¼Œä»è€Œé™åˆ¶äº†æ£€æµ‹å™¨çš„å®ç”¨æ€§ã€‚æˆ‘ä»¬çš„æ··æ·†çš„ä¸»è¦ç›®æ ‡ï¼Œæ˜¯</strong>é™ä½æ£€æµ‹å™¨çš„å¬å›ç‡</strong>ã€‚</p><p>éƒ¨åˆ†æ£€æµ‹å™¨æ— æ³•è§£ææŸäº›<strong>åŸå§‹</strong>ä¸<strong>å˜æ¢å</strong>çš„ä»£ç æ ·æœ¬ï¼ŒåŸå› åœ¨äºå®ƒä»¬å¯¹ JavaScript è¯­è¨€çš„æ”¯æŒå·²è¿‡æ—¶æˆ–ä¸å®Œæ•´ã€‚ç”±äºè¿™æ˜¯æ£€æµ‹å™¨<strong>å®ç°ç»†èŠ‚</strong>æ‰€è‡´ï¼ˆè€Œéæ£€æµ‹æ–¹æ³•æœ¬èº«çš„ç»“æœï¼‰ï¼Œæˆ‘ä»¬é€‰æ‹©<strong>å°†è¿™äº›æ ·æœ¬æ’é™¤</strong>åœ¨è®¡æ•°ä¹‹å¤–ï¼Œè€Œä¸æ˜¯æŠŠå®ƒä»¬è®°ä½œè¯¯æŠ¥æˆ–æ¼æŠ¥ã€‚å› æ­¤ï¼Œå„æ£€æµ‹å™¨åœ¨ä¸åŒå˜æ¢ä¸‹çš„å¬å›ç‡åˆ†æ¯ä¼šæœ‰æ‰€ä¸åŒã€‚</p><h5 id="ç»“æœ-results" tabindex="-1"><a class="header-anchor" href="#ç»“æœ-results"><span>ç»“æœï¼ˆResultsï¼‰</span></a></h5><figure><img src="/assets/images/scholar/Wobfuscator%EF%BC%9A%E9%80%9A%E8%BF%87%E9%80%89%E6%8B%A9%E6%80%A7%E5%9C%B0%E7%BF%BB%E8%AF%91%E5%88%B0WASM%E6%9D%A5%E6%B7%B7%E6%B7%86JavaScript%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/table3.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>è¡¨ III</strong> ç»™å‡ºäº†ç¬¬ VI-A2 èŠ‚æ‰€è¿°å„æ£€æµ‹å™¨ï¼ˆåˆ—ï¼‰åœ¨è¿è¡Œæˆ‘ä»¬æ··æ·†åçš„ä»£ç ï¼ˆè¡Œï¼‰æ—¶çš„<strong>å¬å›ç‡</strong>ã€‚<strong>ç¬¬ä¸€è¡Œ</strong>ç»™å‡ºçš„æ˜¯åœ¨<strong>æœªè¿›è¡Œæ··æ·†</strong>æƒ…å†µä¸‹æ¯ä¸ªæ£€æµ‹å™¨çš„å¬å›ç‡ï¼Œä½œä¸º<strong>åŸºçº¿</strong>ã€‚è¡¨æ ¼çš„ä¸­é—´éƒ¨åˆ†å±•ç¤ºäº†<strong>é€ç±»å˜æ¢å•ç‹¬åº”ç”¨</strong>æ—¶çš„ç»“æœâ€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡åªåº”ç”¨ä¸€ç§å˜æ¢ã€‚ä¾‹å¦‚ï¼Œ<strong>ç¬¬äºŒè¡Œ</strong>æ˜¾ç¤ºï¼šå°†<strong>åŒæ­¥å˜æ¢</strong>æŠ€æœ¯ <strong>T1-StringLiteral</strong> åº”ç”¨äºæ¶æ„æ ·æœ¬æµ‹è¯•é›†æ—¶ï¼Œ<strong>Cujo</strong> çš„å¬å›ç‡ä¸º <strong>0.61</strong>ï¼Œç›¸è¾ƒäºåŸºçº¿ <strong>0.98</strong> æœ‰æ˜¾è‘—ä¸‹é™ã€‚ç»“æœè¡¨æ˜ï¼š<strong>ä¸åŒçš„ç¿»è¯‘/å˜æ¢æŠ€æœ¯å¯¹ä¸åŒæ£€æµ‹å™¨çš„æŠ‘åˆ¶æ•ˆæœå¹¶ä¸ç›¸åŒ</strong>ã€‚å¯¹æ¯ä¸ªæ£€æµ‹å™¨ï¼Œæˆ‘ä»¬å°†<strong>æœ€å°çš„å¬å›ç‡</strong>åŠ ç²—ï¼Œä»¥çªå‡º<strong>å•ä¸€å˜æ¢</strong>ä¸‹çš„æœ€ä½³è¡¨ç°ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å‘ç° <strong>T1-StringLiteral</strong> å¯¹ <strong>Cujoã€Zozzle</strong> ä»¥åŠ <strong>JStap çš„ values æ¨¡å¼</strong>æ•ˆæœæœ€å¥½ï¼›<strong>T4-CallExpression(a)</strong> å¯¹ <strong>JaSt</strong> æ•ˆæœæœ€ä½³ï¼Œè€Œ <strong>T4-CallExpression(b)</strong> åˆ™å¯¹ <strong>JStap çš„ n-grams æ¨¡å¼</strong>æ•ˆæœæœ€ä½³ã€‚ç”±äº<strong>æ¯æ¡å˜æ¢è§„åˆ™</strong>è‡³å°‘èƒ½é™ä½<strong>æŸä¸€ä¸ª</strong>æ£€æµ‹å™¨çš„å¬å›ç‡ï¼Œ<strong>æ‰€æœ‰å˜æ¢</strong>éƒ½æ˜¯æˆ‘ä»¬æ–¹æ³•æœ‰æ•ˆæ€§çš„<strong>å…³é”®ç»„æˆéƒ¨åˆ†</strong>ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬è§£é‡Šä¸ºä½•æŸäº›æ£€æµ‹å·¥å…·æ›´ä¸é€‚åº”æŸäº›å˜æ¢ã€‚<strong>Cujo</strong> å¯¹æ¶æ„æ–‡ä»¶åš<strong>è¯æ³•çº§</strong>åˆ†æï¼Œå®ƒä¼šå­¦ä¹ åˆ°å¯æŒ‡ç¤ºæ¶æ„è¡Œä¸ºçš„å­—ç¬¦ä¸²ç‰¹å¾ï¼›è€Œ <strong>T1-StringLiteral</strong> ä¼š<strong>ç§»é™¤è¿™äº›æ ‡è¯†ç¬¦</strong>ï¼Œä½¿å¾— Cujo æ— æ³•åœ¨æ–‡ä»¶ä¸­æ‰¾åˆ°å¯ç–‘çš„è¯å…ƒã€‚<strong>Zozzle</strong> è¯†åˆ«çš„æ˜¯<strong>å¥æ³•ç‰¹å¾</strong>çš„æ¶æ„ç»„åˆåŠå…¶ä¸Šä¸‹æ–‡ï¼›ç”±äº <strong>T1-StringLiteral</strong> ä¼šç§»é™¤æ¶æ„å­—ç¬¦ä¸²ï¼ˆå¦‚ shellcodeã€åŠ¨æ€ä»£ç ï¼‰çš„å¤§é‡ä½¿ç”¨ï¼Œé‚£äº›é«˜åº¦ä¾èµ–è¿™äº›å­—ç¬¦ä¸²çš„æ¶æ„æ ·æœ¬ä¼šä» AST ä¸­<strong>ç§»é™¤å…³é”®æŒ‡ç¤ºæ€§ç‰¹å¾</strong>ï¼Œä»è€Œ<strong>é€ƒé¿ Zozzle</strong>ã€‚<strong>JaSt</strong> ä½¿ç”¨ <strong>AST è¯­æ³•èŠ‚ç‚¹çš„ n-grams</strong>ï¼ˆé»˜è®¤é•¿åº¦ä¸º 4ï¼‰æ¥æ£€æµ‹æ¶æ„æ¨¡å¼ï¼›<strong>T4-CallExpression(a)</strong> ä¼šæŠŠä¸€ä¸ªå•ä¸€çš„ <code>CallExpression</code> èŠ‚ç‚¹æ›¿æ¢ä¸º<strong>å¤šä¸ªèŠ‚ç‚¹</strong>ï¼Œç”¨äºå¤„ç† WebAssembly æ¨¡å—çš„å®ä¾‹åŒ–ã€‚ç”±äºè¿™ç§ç¿»è¯‘å¼•å…¥çš„<strong>èŠ‚ç‚¹æ•°</strong>å¤§äºæ»‘åŠ¨çª—å£çš„é•¿åº¦ï¼Œå®ƒä¼š<strong>æ‰°ä¹±å·²çŸ¥æ¶æ„ n-gram æ¨¡å¼</strong>çš„æ£€æµ‹ã€‚<strong>JStapï¼ˆn-grams æ¨¡å¼ï¼‰<strong>ä¼šåœ¨è¾“å…¥æ–‡ä»¶çš„ AST ä¸Šæ„é€ </strong>ç¨‹åºä¾èµ–å›¾ï¼ˆPDGï¼‰</strong>ï¼Œé€šè¿‡åœ¨ AST ä¸Šæ·»åŠ è¡¨ç¤ºæ•°æ®æµçš„è¾¹æ¥å®ç°ï¼›è€Œ <strong>T4-CallExpression(b)</strong>ï¼ˆä»¥åŠå…¶ä»–å˜æ¢ï¼‰ä¼šæŠŠæ•°æ®æµ<strong>æ”¹é“</strong>è‡³ç”Ÿæˆçš„ WebAssembly æ¨¡å—ä¸­ï¼Œä»è€Œ<strong>å‰Šå¼±</strong> JStap èƒ½å¤Ÿæå–çš„ n-gram ç‰¹å¾ï¼Œå½±å“å…¶æ•°æ®æµåˆ†æã€‚<strong>JStapï¼ˆvalues æ¨¡å¼ï¼‰<strong>å¯¹ <strong>T1-StringLiteral</strong> çš„å½±å“å°¤ä¸ºæ•æ„Ÿï¼Œå› ä¸ºå®ƒåœ¨é€‰æ‹©è¦æå–çš„ç‰¹å¾æ—¶</strong>ä¾èµ–å­—é¢é‡</strong>ï¼›è€Œ <strong>T1-StringLiteral</strong> ä¼šç§»é™¤éƒ¨åˆ†å­—é¢é‡ã€‚</p><p>è¡¨ III çš„ä¸‹åŠéƒ¨åˆ†å±•ç¤ºäº†<strong>ä¸€æ¬¡æ€§åº”ç”¨æ‰€æœ‰å˜æ¢è§„åˆ™</strong>æ—¶çš„ç»“æœã€‚æˆ‘ä»¬æŠ¥å‘Šäº†ä¸‰ç§å˜æ¢ç»„åˆï¼š</p><ul><li><strong>â€œAll sync (using T4(a))â€</strong> ä¸ <strong>â€œAll sync (using T4(b))â€</strong>ï¼šåˆ†åˆ«è¡¨ç¤º<strong>æ‰€æœ‰åŒæ­¥ç±»</strong>å˜æ¢ï¼Œä½†åœ¨ T4 è§„åˆ™ä¸­åˆ†åˆ«ä½¿ç”¨ <strong>T4(a)</strong> æˆ– <strong>T4(b)</strong>ã€‚</li><li><strong>â€œAll asyncâ€</strong>ï¼šè¡¨ç¤ºè¡¨ I ä¸­çš„æ‰€æœ‰å˜æ¢ï¼ˆé™¤ T4(b) ä¹‹å¤–ï¼‰éƒ½é‡‡ç”¨å…¶<strong>å¼‚æ­¥ç‰ˆæœ¬</strong>ã€‚</li></ul><p>æˆ‘ä»¬å‘ç°ï¼Œå°†æ‰€æœ‰å˜æ¢è§„åˆ™ç»„åˆèµ·æ¥ä¼š<strong>æ˜¾è‘—é™ä½å„æ£€æµ‹å™¨çš„å¬å›ç‡</strong>ã€‚å…·ä½“è€Œè¨€ï¼Œåœ¨ â€œAll sync (using T4(a))â€ è¿™ä¸€ç»„å˜æ¢ä¸‹ï¼Œ<strong>Cujoã€Zozzleã€JaStã€JStapï¼ˆNGramsï¼‰ä»¥åŠ JStapï¼ˆValuesï¼‰</strong> çš„å¬å›ç‡åˆ†åˆ«ä¸º <strong>0.18ã€0.63ã€0.22ã€0.00 å’Œ 0.18</strong>ã€‚ç»¼åˆå…¶æ€§èƒ½ä»¥åŠä¸ <strong>WebAssembly MVP</strong> è¯­è¨€çš„å…¼å®¹æ€§ï¼Œæˆ‘ä»¬é€‰æ‹© <strong>â€œAll sync (using T4(a))â€</strong> ä½œä¸º <strong>Wobfuscator</strong> çš„<strong>é»˜è®¤é…ç½®</strong>ã€‚å›¾ 4 å¯¹è¯¥é…ç½®ï¼ˆâ€œAll sync (using T4(a))â€ï¼‰çš„ç»“æœåšäº†å¯è§†åŒ–ã€‚</p><figure><img src="/assets/images/scholar/Wobfuscator%EF%BC%9A%E9%80%9A%E8%BF%87%E9%80%89%E6%8B%A9%E6%80%A7%E5%9C%B0%E7%BF%BB%E8%AF%91%E5%88%B0WASM%E6%9D%A5%E6%B7%B7%E6%B7%86JavaScript%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/figure4.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><hr><p>æˆ‘ä»¬çš„ä¸»è¦ç›®æ ‡æ˜¯<strong>é™ä½æ£€æµ‹å™¨çš„å¬å›ç‡</strong>ï¼Œä½†æˆ‘ä»¬ä¹ŸåŒæ—¶è¯„ä¼°äº†<strong>ç²¾ç¡®ç‡</strong>ã€‚å„ç±»å˜æ¢çš„ç²¾ç¡®ç‡è§è¡¨ VIIã€‚å¯¹å¤§å¤šæ•°å·²åº”ç”¨çš„å˜æ¢è€Œè¨€ï¼Œç²¾ç¡®ç‡ä¿æŒåœ¨ <strong>0.9 åˆ° 1.0</strong> ä¹‹é—´ã€‚ç„¶è€Œï¼ŒæŸäº›å…·ä½“å˜æ¢ä¼šå¯¹æŸäº›æ£€æµ‹å™¨çš„ç²¾ç¡®ç‡äº§ç”Ÿè¾ƒå¤§å½±å“ï¼Œä¾‹å¦‚ï¼š<strong>â€œAll sync (using T4(a))â€</strong> ä¼šå°† <strong>JStapï¼ˆNGramsï¼‰</strong> çš„ç²¾ç¡®ç‡é™è‡³ <strong>0.5</strong>ã€‚è¿™è¡¨æ˜ï¼Œå°½ç®¡<strong>é™ä½ç²¾ç¡®ç‡å¹¶éæˆ‘ä»¬çš„ä¸»è¦ç›®æ ‡</strong>ï¼ŒWobfuscator ä»<strong>å¯èƒ½é™ä½</strong>æŸäº›æ£€æµ‹å™¨çš„ç²¾ç¡®ç‡ã€‚</p><h4 id="_2-ä¸å…¶ä»–æ··æ·†å™¨çš„æ¯”è¾ƒ" tabindex="-1"><a class="header-anchor" href="#_2-ä¸å…¶ä»–æ··æ·†å™¨çš„æ¯”è¾ƒ"><span>2ï¼‰ ä¸å…¶ä»–æ··æ·†å™¨çš„æ¯”è¾ƒ</span></a></h4><p>ä¸ºäº†æ¼”ç¤ºWobfuscatorä¸å½“å‰å¯ç”¨çš„JavaScriptæ··æ·†å™¨çš„å¯¹æ¯”ï¼Œæˆ‘ä»¬åœ¨ç¬¬VI-B1èŠ‚ä¸­ä½¿ç”¨çš„åŒä¸€æ•°æ®é›†ä¸Šè¯„ä¼°äº†å››ç§æ··æ·†å·¥å…·ã€‚æˆ‘ä»¬æ”¶é›†äº†äº”ä¸ªæ¶æ„è½¯ä»¶æ£€æµ‹å·¥å…·åœ¨å¯¹æ¯ä¸ªå·¥å…·æ··æ·†çš„æ•°æ®é›†è¿›è¡Œè¯„ä¼°æ—¶è·å¾—çš„ç²¾ç¡®åº¦å’Œå¬å›ç‡å€¼ã€‚ä¸ç¬¬VI-B1èŠ‚ç±»ä¼¼ï¼Œä¸€äº›æ£€æµ‹å™¨æ— æ³•è§£ææŸäº›æ¨¡ç³Šæ–‡ä»¶ï¼Œå¯¼è‡´åŒä¸€æ£€æµ‹å™¨åˆ—ä¸­çš„å€¼å…·æœ‰ä¸åŒçš„åˆ†æ¯ã€‚</p><h5 id="ç»“æœ-results-1" tabindex="-1"><a class="header-anchor" href="#ç»“æœ-results-1"><span>ç»“æœï¼ˆResultsï¼‰</span></a></h5><p>è¡¨å››æ˜¾ç¤ºäº†åœ¨ç¬¬VI-A3èŠ‚ï¼ˆè¡Œï¼‰ä¸­æè¿°çš„å››ç§æ··æ·†å·¥å…·ä¸­çš„æ¯ä¸€ç§æ··æ·†çš„ä»£ç ä¸Šè¿è¡Œæ—¶æ£€æµ‹å·¥å…·ï¼ˆåˆ—ï¼‰çš„å¬å›å€¼ã€‚æœ€åä¸€è¡Œæ˜¾ç¤ºäº†Wobfuscatorè·å¾—çš„æœ€ä½³å¬å›å€¼ã€‚</p><figure><img src="/assets/images/scholar/Wobfuscator%EF%BC%9A%E9%80%9A%E8%BF%87%E9%80%89%E6%8B%A9%E6%80%A7%E5%9C%B0%E7%BF%BB%E8%AF%91%E5%88%B0WASM%E6%9D%A5%E6%B7%B7%E6%B7%86JavaScript%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/table4.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ç»“æœè¡¨æ˜ï¼Œåœ¨æ¶æ„è½¯ä»¶æ£€æµ‹å™¨çš„å¬å›ç‡é™ä½æ–¹é¢ï¼ŒWobfusctorä¼˜äºå½“å‰çš„æ··æ·†å™¨ã€‚å”¯ä¸€çš„ä¾‹å¤–å‘ç”Ÿåœ¨Jfogså¯¹JaStè¿›è¡Œè¯„ä¼°æ—¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒJfogsçš„0.00å¬å›ç‡è¶…è¿‡äº†Wobfusctorçš„0.18å¬å›ç‡ã€‚Jfogsçš„æ··æ·†ä¸»è¦æ˜¯ç”¨æ–°çš„ä¸­é—´å˜é‡æ›¿æ¢æ ‡è¯†ç¬¦å’Œæ–‡å­—ï¼Œå› æ­¤Wobfuscatorå¯ç”¨äºè¡¥å……Jfogsã€‚</p><p>ä¾‹å¦‚ï¼ŒJfogså°†å­—ç¬¦ä¸²æ–‡å­—ç§»åŠ¨åˆ°å˜é‡ä¸­ï¼Œä½†å®ƒä¸ä¼šæ›´æ”¹æˆ–åˆ é™¤æ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²ã€‚ä½¿ç”¨T1 StringLiteralè½¬æ¢ï¼Œå¯ä»¥ä»JavaScriptæ–‡ä»¶ä¸­å®Œå…¨åˆ é™¤å­—ç¬¦ä¸²æ–‡å­—ï¼Œä»è€Œå‡å°‘æ£€æµ‹å™¨å¯ç”¨çš„è¯­æ³•ä¿¡æ¯ã€‚</p><h4 id="_3-æŒ‰æ¶æ„è½¯ä»¶ç±»å‹ç»†åˆ†ç»“æœ" tabindex="-1"><a class="header-anchor" href="#_3-æŒ‰æ¶æ„è½¯ä»¶ç±»å‹ç»†åˆ†ç»“æœ"><span>3ï¼‰ æŒ‰æ¶æ„è½¯ä»¶ç±»å‹ç»†åˆ†ç»“æœ</span></a></h4><p>æ¶æ„æ•°æ®é›†åŒ…å«å‡ ç§ä¸åŒç±»åˆ«çš„æ¶æ„è½¯ä»¶ï¼ŒåŒ…æ‹¬åŠ å¯†çŸ¿å·¥ã€ç‰¹æ´›ä¼Šæœ¨é©¬å’Œæ»´ç®¡ã€‚æˆ‘ä»¬æä¾›äº†æ•°æ®é›†ä¸­åŒ…å«çš„æ¶æ„è½¯ä»¶ç±»åˆ«çš„ç»†åˆ†ã€‚VirusTotalæä¾›AVæ‰«æç¨‹åºæŠ¥å‘Šçš„æ¶æ„è½¯ä»¶ç±»å‹ã€‚æˆ‘ä»¬é€šè¿‡å°†ç±»ä¼¼çš„ç»„åˆå¹¶åœ¨ä¸€èµ·æ¥å‡å°‘æ¶æ„è½¯ä»¶ç±»åˆ«çš„æ•°é‡ï¼Œä¾‹å¦‚åˆå¹¶JS:Trojanã€‚Gnaeuså’ŒJSï¼šç‰¹æ´›ä¼Šæœ¨é©¬ã€‚å°†ä»£ç†ç¨‹åºå½’å…¥ç‰¹æ´›ä¼Šæœ¨é©¬ç±»åˆ«ã€‚å¯¹äºGeeksOnSecurityï¼Œæˆ‘ä»¬ä½¿ç”¨ç›®å½•åæ¥è¯†åˆ«å“ªäº›æ ·æœ¬æ˜¯æ¼æ´åˆ©ç”¨å·¥å…·åŒ…ï¼Œå“ªäº›æ˜¯JavaScriptæ»´ç®¡ã€‚Hynek Petrakæ•°æ®é›†ä¸æä¾›æ ·æœ¬çš„å…ƒæ•°æ®ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨ClamAVæ‰«ææ–‡ä»¶ä»¥è·å–æ¶æ„è½¯ä»¶ç±»åˆ«ã€‚ä¸ºäº†è¯æ˜Wobfuscatoråœ¨æ··æ·†ä¸€ç»„ä¸åŒçš„æ¶æ„è½¯ä»¶æ ·æœ¬æ–¹é¢çš„æœ‰æ•ˆæ€§ï¼Œæˆ‘ä»¬æµ‹é‡äº†æ•°æ®é›†ä¸­ä¸åŒæ¶æ„è½¯ä»¶ç±»åˆ«çš„æ¶æ„è½¯ä»¶æ£€æµ‹å™¨å¬å›ç‡çš„é™ä½ã€‚å‡ºäºç¯‡å¹…åŸå› ï¼Œæˆ‘ä»¬ä»…åˆ—å‡ºæ‰€æœ‰è½¬æ¢ä¸­æ¶æ„è½¯ä»¶ç±»åˆ«ä¸­è§‚å¯Ÿåˆ°çš„æœ€ä½å¬å›ç‡ã€‚</p><p>ç»“æœï¼šè¡¨IXçš„ç¬¬5-9åˆ—æ˜¾ç¤ºäº†å½“æ¥è‡ªæ¯ä¸ªæ¶æ„è½¯ä»¶ç±»åˆ«ï¼ˆè¡Œï¼‰çš„æ ·æœ¬è¢«æ··æ·†æ—¶ï¼Œæ¶æ„è½¯ä»¶æ£€æµ‹å™¨ï¼ˆåˆ—ï¼‰è·å¾—çš„å¬å›å€¼ã€‚é™¤äº†å¬å›ç‡å¤–ï¼Œæ¯ä¸ªå•å…ƒæ ¼è¿˜åˆ—å‡ºäº†æ£€æµ‹å™¨æ­£ç¡®æ ‡è®°ä¸ºæ¶æ„çš„æ–‡ä»¶æ•°é‡ï¼Œä»¥åŠæ£€æµ‹å™¨åœ¨è¯¥ç±»åˆ«ä¸­æµ‹è¯•çš„æ¶æ„æ–‡ä»¶æ•°é‡ã€‚æ ‡æœ‰â€œ-â€çš„åˆ—è¡¨ç¤ºæ£€æµ‹å™¨æ— æ³•è§£ææ¶æ„è½¯ä»¶ç±»åˆ«ä¸­çš„ä»»ä½•æµ‹è¯•æ–‡ä»¶ã€‚å¯¹äºç½‘ç»œé’“é±¼æ¶æ„è½¯ä»¶ç±»åˆ«ï¼Œæˆ‘ä»¬çš„æµ‹è¯•æ•°æ®é›†ä¸­æ²¡æœ‰å‡ºç°æ ·æœ¬ï¼Œå› æ­¤æ²¡æœ‰å¯ç”¨çš„å¬å›å€¼ã€‚äº”ä¸ªæœ€å¤§çš„æ¶æ„è½¯ä»¶ç»„ï¼ˆDownloaderã€Misc.ã€Trojanã€malwareå’ŒExploitï¼‰çš„ç»“æœè¡¨æ˜ï¼ŒWobfuscatorå¯ä»¥æ˜¾è‘—é™ä½ä¸åŒæ¶æ„è½¯ä»¶ç±»åˆ«çš„å¬å›ç‡ã€‚</p><h3 id="c-è½¬æ¢çš„æ­£ç¡®æ€§-rq2" tabindex="-1"><a class="header-anchor" href="#c-è½¬æ¢çš„æ­£ç¡®æ€§-rq2"><span>C. è½¬æ¢çš„æ­£ç¡®æ€§ï¼ˆRQ2ï¼‰</span></a></h3><p>æˆ‘ä»¬åº”ç”¨çš„è½¬æ¢æ”¹å˜äº†ç¨‹åºçš„å¥æ³•ç»“æ„ã€‚å½“ç„¶ï¼Œè¿™æ ·çš„æ›´æ”¹å¯èƒ½ä¼šå½±å“ç¨‹åºè¯­ä¹‰ï¼Œå¯èƒ½ä¼šä½¿æ¨¡ç³Šç¨‹åºçš„è¡Œä¸ºä¸åŸå§‹ç¨‹åºä¸åŒï¼Œä»è€Œç ´ååŠŸèƒ½çš„æ­£ç¡®æ€§ã€‚è¿™å°±å¼•å‡ºäº†ä¸¤ä¸ªç›¸äº’çŸ›ç›¾çš„é—®é¢˜ï¼šé¦–å…ˆï¼Œæˆ‘ä»¬æ˜¯å¦ä¿æŒäº†è¾“å…¥ç¨‹åºçš„åŠŸèƒ½æ­£ç¡®æ€§ï¼Œå³æˆ‘ä»¬çš„ä»£ç è½¬æ¢æ˜¯å¦ä¿æŒäº†è¯­ä¹‰ï¼Ÿç¬¬äºŒï¼Œå¤šä¹…åº”ç”¨ä¸€æ¬¡è½¬æ¢ï¼Ÿä¸ºäº†éªŒè¯ç¨‹åºçš„æ­£ç¡®æ€§ï¼Œæˆ‘ä»¬åˆ©ç”¨äº†ç°æœ‰å¹¿æ³›ä½¿ç”¨çš„JavaScripté¡¹ç›®çš„å…¨é¢æµ‹è¯•å¥—ä»¶ã€‚æˆ‘ä»¬å°†è½¬æ¢åº”ç”¨äºæµ‹è¯•ä»£ç ï¼Œç„¶åéªŒè¯è½¬æ¢åçš„ä»£ç æ˜¯å¦ä»ç„¶é€šè¿‡æµ‹è¯•ã€‚è§£å†³ç¬¬äºŒä¸ªé—®é¢˜ï¼Œä¸€ä¸ªç®€å•çš„æ­£ç¡®æ€§è§£å†³æ–¹æ¡ˆæ˜¯åªè½¬æ¢ä¸€å°éƒ¨åˆ†ä»£ç ä½ç½®ï¼Œä»¥ç‰ºç‰²æ›´å°‘çš„ä»£ç æ··æ·†ä¸ºä»£ä»·æ¥ä¿ç•™è¯­ä¹‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¿˜è¯„ä¼°äº†åº”ç”¨æ¯ä¸ªè½¬æ¢è§„åˆ™çš„é¢‘ç‡ã€‚</p><p>è½¬æ¢çš„åŒæ­¥å’Œå¼‚æ­¥å˜ä½“ä¹‹é—´çš„éªŒè¯è®¾ç½®ä¸åŒã€‚åœ¨åŒæ­¥çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°å°†è½¬æ¢åº”ç”¨äºä»»ä½•ç°æœ‰ä»£ç ã€‚ä¸ºäº†éªŒè¯å¼‚æ­¥è½¬æ¢çš„æ­£ç¡®æ€§ï¼Œå¿…é¡»ä¿®æ”¹é¡¹ç›®ä»¥æ”¯æŒå¼‚æ­¥æ‰§è¡Œï¼Œå¦‚ç¬¬IV-CèŠ‚æ‰€è¿°ã€‚ç”±äºè‡ªåŠ¨å°†ä»»æ„JavaScriptä»£ç è½¬æ¢ä¸ºå¼‚æ­¥ä»£ç å¹¶éæ˜“äº‹ï¼Œæˆ‘ä»¬è½¬è€Œå…³æ³¨ä¸€ä¸ªå·²ç»å¼‚æ­¥çš„NPMé¡¹ç›®ï¼Œå³èŠ‚ç‚¹è·å–ï¼Œå› æ­¤ç®€åŒ–äº†å¼‚æ­¥è½¬æ¢çš„åº”ç”¨ã€‚æˆ‘ä»¬ä½¿ç”¨æ­¤é¡¹ç›®æ¥éªŒè¯å¼‚æ­¥å˜ä½“ï¼Œå¹¶ä½¿ç”¨å…¶ä»–äº”ä¸ªé¡¹ç›®æ¥éªŒè¯åŒæ­¥å˜ä½“ã€‚</p><p>ç»“æœï¼šæµ‹è¯•å¥—ä»¶è¿è¡Œçš„ç»“æœå¦‚è¡¨5æ‰€ç¤ºã€‚è¯¥è¡¨åˆ—å‡ºäº†æµ‹è¯•é¡¹ç›®ã€å…¶ç‰ˆæœ¬ä»¥åŠåº”ç”¨è§„åˆ™T1-T7çš„ç¿»è¯‘ç«™ç‚¹çš„æ•°é‡ã€‚æœ€åä¸¤åˆ—åˆ—å‡ºäº†æµ‹è¯•å¥—ä»¶ä¸­çš„æµ‹è¯•æ€»æ•°ï¼Œä»¥åŠå—è‡³å°‘ä¸€ä¸ªè½¬æ¢å½±å“çš„æµ‹è¯•æ•°é‡ã€‚æ¯ä¸ªé¡¹ç›®ä¸­çš„æ‰€æœ‰æµ‹è¯•éƒ½æˆåŠŸé€šè¿‡ï¼Œè¡¨æ˜æˆ‘ä»¬çš„æ··æ·†æ˜¯è¯­ä¹‰ä¿ç•™çš„ã€‚</p><figure><img src="/assets/images/scholar/Wobfuscator%EF%BC%9A%E9%80%9A%E8%BF%87%E9%80%89%E6%8B%A9%E6%80%A7%E5%9C%B0%E7%BF%BB%E8%AF%91%E5%88%B0WASM%E6%9D%A5%E6%B7%B7%E6%B7%86JavaScript%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/table5.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>è¡¨Vçš„ç¬¬4-11åˆ—æ˜¾ç¤ºäº†ä¸è½¬æ¢ç›¸å…³çš„å¯ç”¨ä»£ç ä½ç½®æ€»æ•°ä¸­æ»¡è¶³è½¬æ¢å…ˆå†³æ¡ä»¶çš„è½¬æ¢ä»£ç ä½ç½®çš„æ•°é‡ï¼Œæ— è®ºå®ƒä»¬æ˜¯å¦æ»¡è¶³å…ˆå†³æ¡ä»¶ã€‚è¡¨Vçš„æœ€åä¸¤åˆ—æ˜¾ç¤ºï¼Œåœ¨äº”ä¸ªæµ‹è¯•å¥—ä»¶ä¸­çš„2017ä¸ªå•å…ƒæµ‹è¯•ä¸­ï¼Œ1844ä¸ªï¼ˆ91.42%ï¼‰ä¾èµ–äºè‡³å°‘å—ä¸€ä¸ªè½¬æ¢è§„åˆ™å½±å“çš„å‡½æ•°ã€‚ç»“æœè¡¨æ˜ï¼Œæˆ‘ä»¬çš„è½¬æ¢è§„åˆ™é€‚ç”¨äºç°å®ä¸–ç•Œä¸­ä½¿ç”¨çš„ä»£ç ä½ç½®ã€‚</p><h3 id="d-è¿è¡Œæ—¶å’Œä»£ç å¤§å°æ–¹é¢çš„æ•ˆç‡-rq3" tabindex="-1"><a class="header-anchor" href="#d-è¿è¡Œæ—¶å’Œä»£ç å¤§å°æ–¹é¢çš„æ•ˆç‡-rq3"><span>D. è¿è¡Œæ—¶å’Œä»£ç å¤§å°æ–¹é¢çš„æ•ˆç‡ï¼ˆRQ3ï¼‰</span></a></h3><p>æˆ‘ä»¬æå‡ºçš„Wobfuscatorè½¬æ¢åœ¨WebAssemblyæ¨¡å—ä¸­é‡æ–°å®ç°äº†åŸç”ŸJavaScriptåŠŸèƒ½ï¼Œä¾‹å¦‚è°ƒç”¨å‡½æ•°ã€æ‰§è¡Œwhileå¾ªç¯ã€åˆå§‹åŒ–æ•°ç»„ç­‰ã€‚å› æ­¤ï¼Œè¿™å°†å¯¹ç¿»è¯‘ç¨‹åºçš„æ€§èƒ½äº§ç”Ÿå½±å“ã€‚ä¸ºäº†é‡åŒ–è½¬æ¢å¯¹æ€§èƒ½çš„å½±å“ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ç¬¬VI-CèŠ‚ä¸­æè¿°çš„å…­ä¸ªæ¨¡å—çš„æµ‹è¯•å¥—ä»¶ã€‚æ­¤å¤–ï¼Œè¿˜åˆ†æäº†è½¬æ¢å¼•èµ·çš„ä»£ç å¤§å°å¢åŠ ï¼ŒåŒ…æ‹¬æ·»åŠ çš„JavaScriptå’ŒWebAssemblyä»£ç ã€‚</p><p>1ï¼‰ ç¿»è¯‘è¿è¡Œæ—¶ï¼šé¦–å…ˆï¼Œæˆ‘ä»¬æµ‹é‡å¯¹é¡¹ç›®æ–‡ä»¶æ‰§è¡Œè½¬æ¢æ‰€éœ€çš„æ—¶é—´ã€‚æ—¶é—´æ˜¯ç”¨Linuxä¸­å¯ç”¨çš„timeå‘½ä»¤æµ‹é‡çš„ï¼Œå¹³å‡é‡å¤10æ¬¡ã€‚æˆ‘ä»¬é€šè¿‡å°†é¡¹ç›®ä¸­ä½¿ç”¨çš„æ¯ä¸ªJavaScriptæ–‡ä»¶çš„è½¬æ¢æ—¶é—´ç›¸åŠ æ¥è®¡ç®—é¡¹ç›®çš„æ€»è½¬æ¢æ—¶é—´ã€‚è½¬æ¢æ—¶é—´ç»“æœå¦‚è¡¨VIæ‰€ç¤ºã€‚</p><figure><img src="/assets/images/scholar/Wobfuscator%EF%BC%9A%E9%80%9A%E8%BF%87%E9%80%89%E6%8B%A9%E6%80%A7%E5%9C%B0%E7%BF%BB%E8%AF%91%E5%88%B0WASM%E6%9D%A5%E6%B7%B7%E6%B7%86JavaScript%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/table6.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>è¯¥è¡¨æ˜¾ç¤ºï¼Œå¯¹äºæœ€å¤§çš„é¡¹ç›®Lodashï¼Œå®ƒæœ‰21178è¡Œä»£ç ï¼Œåº”ç”¨æ‰€æœ‰åŒæ­¥è½¬æ¢çš„å¹³å‡æ—¶é—´ä¸º29.58ç§’ã€‚å¯¹äºæœ€å°çš„é¡¹ç›®ï¼ŒåŒ…å«319è¡Œä»£ç çš„Chalkï¼Œåº”ç”¨è½¬æ¢çš„å¹³å‡æ—¶é—´ä»…ä¸º0.81ç§’ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å‘ç°åœ¨è¡¨VIä¸­çš„æ‰€æœ‰é¡¹ç›®ä¸­ï¼Œåº”ç”¨æ‰€æœ‰è½¬æ¢çš„å¹³å‡æ—¶é—´ä»…ä¸º8.92ç§’ã€‚è¿™äº›ä½è½¬æ¢æ—¶é—´è¡¨æ˜ï¼ŒWobfuscatorå¯¹äºJavaScriptæ··æ·†æ˜¯å®ç”¨çš„ã€‚</p><p>2ï¼‰ æ‰§è¡Œæ—¶é—´å¼€é”€ï¼šæ‰§è¡Œå¼€é”€æ—¶é—´æ˜¯æŒ‡å®Œæˆè½¬æ¢é¡¹ç›®çš„æµ‹è¯•å¥—ä»¶æ‰§è¡Œæ‰€éœ€çš„è¿è¡Œæ—¶é—´çš„å¢åŠ ã€‚æˆ‘ä»¬ä½¿ç”¨timeå‘½ä»¤æ¥æµ‹é‡åº”ç”¨è½¬æ¢å‰åé¡¹ç›®æµ‹è¯•å¥—ä»¶çš„è¿è¡Œæ—¶é—´ï¼ŒæŠ¥å‘Šåæ¬¡é‡å¤æµ‹é‡çš„å¹³å‡å€¼ã€‚æ‰§è¡Œæ—¶é—´ç»“æœå¦‚è¡¨å…­æ‰€ç¤ºã€‚æˆ‘ä»¬çš„è½¬å‹å¢åŠ äº†æ€§èƒ½å¼€é”€ï¼Œä»å¢åŠ 3.24%åˆ°å¢åŠ 2079%ä¸ç­‰ã€‚è™½ç„¶æœ€é«˜å¼€é”€æ•°å­—å¾ˆå¤§ï¼Œä½†å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªå¤§å‹è¿è¡Œæ—¶æºäºå¼‚æ­¥é¡¹ç›®ä¸­çš„ä¸€ä¸ªæµ‹è¯•ï¼Œè¯¥æµ‹è¯•åŒæ—¶å°†å¼‚æ­¥å‡½æ•°åº”ç”¨äº1048576ä¸ªå…ƒç´ çš„é›†åˆã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ¶æ„è½¯ä»¶æ ·æœ¬ä¸å¤ªå¯èƒ½éµå¾ªå¯¼è‡´å¦‚æ­¤å¤§å¼€é”€çš„æ‰§è¡Œæ¨¡å¼ã€‚å¹³å‡è€Œè¨€ï¼ŒWobfuscatorå¢åŠ äº†31.07%çš„æ€§èƒ½å¼€é”€ã€‚</p><p>3ï¼‰ ä»£ç å¤§å°å¼€é”€ï¼šä»£ç å¤§å°å¼€é”€æ˜¯æŒ‡é¡¹ç›®ä¸­æ‰€æœ‰ä»£ç æ–‡ä»¶ä¹‹é—´åŸå§‹æ–‡ä»¶å’Œè½¬æ¢è¾“å‡ºä¹‹é—´çš„ä»£ç å¤§å°çš„å¢åŠ ã€‚è¡¨VIåˆ—å‡ºäº†ä»£ç å¤§å°ä¸åŸå§‹å¤§å°ç›¸æ¯”çš„å¢é•¿ç™¾åˆ†æ¯”ã€‚å¹³å‡è€Œè¨€ï¼Œåœ¨é¡¹ç›®ä¸­åº”ç”¨æ‰€æœ‰è½¬æ¢åï¼Œä»£ç å¤§å°å¢åŠ äº†170.42%ã€‚æ€»ä½“è€Œè¨€ï¼Œä»£ç å¤§å°å¼€é”€å¯¹äºå®é™…åº”ç”¨æ¥è¯´æ˜¯å¯ä»¥æ¥å—çš„ã€‚</p><h2 id="_7-discussion" tabindex="-1"><a class="header-anchor" href="#_7-discussion"><span>7. Discussion</span></a></h2><p>æœ¬èŠ‚è®¨è®ºäº†é˜²å¾¡åŸºäºWebAssemblyçš„æ··æ·†çš„å±€é™æ€§å’Œå¯èƒ½çš„ç¼“è§£æªæ–½ã€‚</p><h3 id="a-limitations" tabindex="-1"><a class="header-anchor" href="#a-limitations"><span>A. Limitations</span></a></h3><p>WobfusctoråŸºäºé™æ€åˆ†ææ¥å®šä½æ¶æ„è½¯ä»¶æ£€æµ‹å™¨ï¼Œå°½ç®¡å®ƒå¯ä»¥æœ‰æ•ˆåœ°ç»•è¿‡å®ƒä»¬ï¼Œä½†å¯¹äºåŸºäºåŠ¨æ€åˆ†æçš„æ£€æµ‹å™¨æ¥è¯´ï¼Œå®ƒä¸å¤ªå¯èƒ½åŒæ ·æœ‰æ•ˆã€‚è¿™äº›è½¬æ¢å°†ä¸€äº›è¡Œä¸ºè½¬ç§»åˆ°WebAssemblyä¸­ï¼ŒåŒæ—¶ä¿æŒæœ€ç»ˆçš„è¿è¡Œæ—¶è¡Œä¸ºä¸å˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¾‹å¦‚ï¼Œè§‚å¯Ÿç½‘ç«™è¿›è¡Œçš„æµè§ˆå™¨APIè°ƒç”¨çš„åŠ¨æ€æ£€æµ‹å™¨å°†è§‚å¯Ÿåˆ°ç›¸åŒçš„è¡Œä¸ºï¼Œæ— è®ºæˆ‘ä»¬æ˜¯å¦æ··æ·†ã€‚ç„¶è€Œï¼Œåœ¨å®è·µä¸­ï¼Œé™æ€æ£€æµ‹å™¨æ›´å®¹æ˜“éƒ¨ç½²ï¼ˆä¾‹å¦‚ï¼Œä½œä¸ºç½‘ç»œä»£ç†æˆ–æµè§ˆå™¨æ‰©å±•ï¼‰ï¼Œè€Œè§‚å¯ŸåŠ¨æ€è¡Œä¸ºçš„è®¾ç½®æ›´å¤æ‚ï¼Œè¿è¡Œæ—¶æˆæœ¬æ›´é«˜ã€‚</p><p>å¦ä¸€ä¸ªé™åˆ¶æ˜¯ï¼Œè¯¥æ–¹æ³•ä»…å¯¹æŸäº›ç»™å®šä»£ç åº”ç”¨è½¬æ¢ã€‚å¦‚æœä»£ç ä½ç½®ä¸æ»¡è¶³ç‰¹å®šè½¬æ¢çš„å…ˆå†³æ¡ä»¶ï¼Œåˆ™æ— æ³•è½¬æ¢ã€‚ä¿å®ˆåœ°ä¿æŠ¤è½¬æ¢å¯¹äºç¡®ä¿æˆ‘ä»¬çš„æ–¹æ³•ä¿ç•™ç»™å®šä»£ç çš„è¯­ä¹‰è‡³å…³é‡è¦ï¼Œä½†ä¹Ÿé™åˆ¶äº†å®ƒçš„é€‚ç”¨æ€§ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬çš„æ··æ·†ä¾èµ–äºæµè§ˆå™¨ä¸­å¯ç”¨çš„WebAssemblyã€‚ç”±äº94%çš„å·²å®‰è£…æµè§ˆå™¨æ”¯æŒWebAssemblyï¼Œè¿™ç§é™åˆ¶åœ¨å®è·µä¸­å¯èƒ½æ˜¯å¯ä»¥æ¥å—çš„ã€‚ä¸ºäº†ç¡®ä¿æ··æ·†çš„æ¶æ„è½¯ä»¶æŒ‰é¢„æœŸè¿è¡Œï¼Œæ”»å‡»è€…å¯ä»¥æ£€æŸ¥WebAssemblyæ”¯æŒï¼Œå¹¶ä»…åœ¨æ”¯æŒè¯¥è¯­è¨€çš„æƒ…å†µä¸‹åŠ è½½æ··æ·†çš„ä»£ç ã€‚</p><h3 id="b-mitigations" tabindex="-1"><a class="header-anchor" href="#b-mitigations"><span>B. Mitigations</span></a></h3><p>å°½ç®¡æˆ‘ä»¬è¿›è¡Œäº†æ··æ·†ï¼Œä½†æˆ‘ä»¬è®¨è®ºäº†ä¸‰ç§æ—¨åœ¨æ£€æµ‹æ¶æ„è½¯ä»¶çš„ç¼“è§£ç­–ç•¥ã€‚ç¬¬ä¸€ç§æ˜¯åŸºäºåŠ¨æ€åˆ†æçš„æ¶æ„è½¯ä»¶æ£€æµ‹ã€‚å› ä¸ºæˆ‘ä»¬çš„æ–¹æ³•ä¿ç•™äº†åŸå§‹çš„JavaScriptè¡Œä¸ºï¼Œæ‰€ä»¥åŠ¨æ€æ£€æµ‹å™¨å…³æ³¨çš„è®¸å¤šè¿è¡Œæ—¶ç‰¹å¾[53]ä¸å—æ··æ·†çš„å½±å“ã€‚WebAssemblyä»£ç é€šè¿‡JavaScriptè°ƒç”¨web APIï¼Œè¿™æ„å‘³ç€ä»»ä½•å°è£…APIå‡½æ•°æˆ–åœ¨æµè§ˆå™¨ä¸­æˆªå–è¿™äº›å‡½æ•°çš„è¿è¡Œæ—¶åˆ†æéƒ½å¯ä»¥çœ‹åˆ°è¯¥è°ƒç”¨ã€‚ç„¶è€Œï¼ŒåŠ¨æ€æ¶æ„è½¯ä»¶æ£€æµ‹å™¨é€šå¸¸ä¼šå¸¦æ¥ä¸å¯å¿½è§†çš„è¿è¡Œæ—¶å¼€é”€ï¼Œå¹¶å¯èƒ½é”™è¿‡åœ¨ç‰¹å®šé…ç½®ä¸­éšè—å…¶æ¶æ„è¡Œä¸ºçš„æ¶æ„è½¯ä»¶ã€‚</p><p>ç¬¬äºŒç§ç¼“è§£ç­–ç•¥æ˜¯åŸºäºé˜²å¾¡è€…çŸ¥é“æˆ‘ä»¬æ··æ·†çš„ç»†èŠ‚ã€‚ç”±äºæ··æ·†ä»£ç ä¸­çš„WebAssemblyä½¿ç”¨ï¼ˆä¾‹å¦‚åŠ è½½è®¸å¤šå°æ¨¡å—ï¼‰å¯èƒ½æ˜¯å¼‚å¸¸çš„ï¼Œå› æ­¤å¯ä»¥å®šä¹‰å¯å‘å¼è§„åˆ™æ¥æ£€æµ‹æ˜¯å¦åº”ç”¨äº†Wobfusctorã€‚åŒæ ·ï¼Œå¯ä»¥åœ¨ç”¨äºå­¦ä¹ æ¶æ„è½¯ä»¶åˆ†ç±»å™¨çš„è®­ç»ƒæ•°æ®ä¸­åŒ…å«ç”¨æˆ‘ä»¬çš„æŠ€æœ¯æ··æ·†çš„ä»£ç ã€‚è¿™äº›ç¼“è§£æªæ–½çš„ä¸»è¦ç¼ºç‚¹æ˜¯æ··æ·†å¹¶ä¸æ„å‘³ç€æ¶æ„ã€‚æ··æ·†ä»£ç æ˜¯æœ‰æ­£å½“ç†ç”±çš„ï¼Œä¾‹å¦‚ä¿æŠ¤çŸ¥è¯†äº§æƒã€‚å› æ­¤ï¼Œå°†æˆ‘ä»¬çš„æŠ€æœ¯æˆ–ä»»ä½•å…¶ä»–æ··æ·†æŠ€æœ¯æ··æ·†çš„æ‰€æœ‰ä»£ç å½’ç±»ä¸ºæ¶æ„ä»£ç å¯èƒ½ä¼šå¯¼è‡´ä¸å¯æ¥å—çš„å¤§é‡è¯¯æŠ¥ã€‚</p><p>æœ€åï¼Œç¬¬ä¸‰ç§ç¼“è§£ç­–ç•¥æ˜¯è”åˆåˆ†æJavaScriptå’ŒWebAssemblyã€‚å¯¹äºåŸºäºä¼ ç»Ÿç¨‹åºåˆ†æï¼ˆé™æ€æˆ–åŠ¨æ€ï¼‰çš„æ£€æµ‹å™¨ï¼Œè”åˆåˆ†æå°†è§£é‡Šæ•°æ®å’Œæ§åˆ¶å¦‚ä½•åœ¨ä¸¤ç§è¯­è¨€ä¹‹é—´æµåŠ¨ã€‚åŒæ ·ï¼ŒåŸºäºå­¦ä¹ çš„æ£€æµ‹å™¨ï¼Œå¦‚æˆ‘ä»¬è¯„ä¼°ä¸­ä½¿ç”¨çš„æ£€æµ‹å™¨ï¼Œå¯ä»¥å°†ä¸¤ç§è¯­è¨€çš„ä»£ç è¾“å…¥åˆ°å®ƒä»¬çš„æ¨¡å‹ä¸­ã€‚æˆ‘ä»¬ä¸çŸ¥é“æœ‰ä»»ä½•æ”¯æŒWebAssemblyçš„ç°æœ‰æ¶æ„è½¯ä»¶æ£€æµ‹å™¨ï¼Œä½†å¸Œæœ›æˆ‘ä»¬çš„å·¥ä½œèƒ½å¤Ÿæé«˜äººä»¬å¯¹è”åˆåˆ†ææœ‰ç”¨çš„è®¤è¯†ã€‚</p><h2 id="_8-ç›¸å…³å·¥ä½œ" tabindex="-1"><a class="header-anchor" href="#_8-ç›¸å…³å·¥ä½œ"><span>8. ç›¸å…³å·¥ä½œ</span></a></h2><p><strong>æ··æ·†ç ”ç©¶å’ŒæŠ€æœ¯</strong>ï¼šæ··æ·†æŠ€æœ¯å·²åœ¨å„ç§ç¼–ç¨‹è¯­è¨€å’Œè½¯ä»¶é¢†åŸŸä¸­è¢«è§‚å¯Ÿåˆ°ç”¨äºæ¶æ„å’Œè‰¯æ€§ç›®çš„ã€‚å…ˆå‰çš„ç ”ç©¶å¯¹åº”ç”¨äºæ¶æ„ä»£ç çš„æ··æ·†æŠ€æœ¯è¿›è¡Œäº†åˆ†ç±»[69]ï¼Œè€Œå…¶ä»–ç ”ç©¶åˆ™æ¯”è¾ƒäº†ä¸åŒæ··æ·†æŠ€æœ¯çš„æœ‰æ•ˆæ€§[22]ã€[32]ã€[61]ã€‚ä¸€äº›ç ”ç©¶é€šè¿‡è°ƒæŸ¥ç°å®ä¸–ç•Œä¸­æ¶æ„å’Œè‰¯æ€§æ–‡ä»¶ä¸­ä½¿ç”¨çš„æ··æ·†æŠ€æœ¯ï¼Œåˆ†æäº†æ··æ·†æŠ€æœ¯åœ¨JavaScriptä»£ç ä¸­çš„ä½¿ç”¨æƒ…å†µ[66]ï¼Œ[55]ã€‚</p><p>å¾ˆå°‘æœ‰ç ”ç©¶æå‡ºå¯¹JavaScriptä»£ç è¿›è¡Œæ–°çš„æ··æ·†æ”»å‡»ã€‚Fassç­‰äºº[26]æ„å»ºäº†HideNoSeekï¼Œå®ƒå°†æ¶æ„ç¨‹åºçš„ASTé‡å†™ä¸ºå·²çŸ¥è‰¯æ€§ç¨‹åºçš„ASTï¼Œä»¥é¿å…è¢«æ£€æµ‹åˆ°ã€‚ä½œè€…å¯¹91020ä¸ªæ ·æœ¬è¿›è¡Œäº†HideNoSeekæŠ—VirusTotalã€Yaraã€JaStã€Zozzleå’ŒCujoçš„è¯„ä¼°ã€‚æ¨¡ç³ŠæŠ€æœ¯èƒ½å¤Ÿå®ç°99.98%çš„æ¢æµ‹å™¨å‡é˜´æ€§ç‡ã€‚</p><p><strong>æ¶æ„è½¯ä»¶æ£€æµ‹</strong>ï¼šå­¦æœ¯ç ”ç©¶ä¸­çš„ä¸€ä¸ªæ´»è·ƒé¢†åŸŸäº§ç”Ÿäº†é™æ€åˆ†ææŠ€æœ¯ï¼Œæ—¨åœ¨å³ä½¿åœ¨å­˜åœ¨æ··æ·†ä»£ç çš„æƒ…å†µä¸‹ä¹Ÿèƒ½è¯†åˆ«æ¶æ„è¡Œä¸ºã€‚</p><p>ä¸€ç±»é™æ€æ£€æµ‹å·¥å…·ä½¿ç”¨ä»JavaScriptæ–‡ä»¶ä¸­å¯¼å‡ºçš„è¯æ±‡å’Œå¥æ³•ä¿¡æ¯æ¥è¯†åˆ«æŒ‡ç¤ºæ¶æ„ä»£ç çš„ç‰¹å¾[50]ã€[24]ã€[16]ã€[20]ã€[54]ã€‚æŠ€æœ¯é€šè¿‡ç»“åˆæ§åˆ¶æµå’Œæ•°æ®æµåˆ†æ[27]æˆ–é€šè¿‡æ·»åŠ åŠ¨æ€åˆ†ææ¥ç¡®è®¤æ¶æ„è½¯ä»¶çš„å­˜åœ¨[67]ï¼Œ[59]ï¼Œä»¥æ­¤è¯­æ³•ä¿¡æ¯ä¸ºåŸºç¡€ã€‚å…¶ä»–é™æ€æ£€æµ‹æŠ€æœ¯é€šè¿‡æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ æ–¹æ³•åˆ†æJavaScriptæºä»£ç [63]ï¼Œ[46]ã€‚Wobfusctorä¼šå½±å“è¿™äº›æ£€æµ‹å™¨çš„æ£€æµ‹ç‡ï¼Œå› ä¸ºå®ƒå‡å°‘äº†å¯ç”¨çš„å¥æ³•ä¿¡æ¯ã€‚æ­¤å¤–ï¼Œä¸€äº›è¡Œä¸ºè¢«è½¬ç§»åˆ°WebAssemblyæ¨¡å—ï¼Œè¿™äº›æ£€æµ‹å™¨ä¼šå¿½ç•¥è¿™äº›æ¨¡å—ã€‚</p><p>å…¶ä»–æ¶æ„è½¯ä»¶æ£€æµ‹æŠ€æœ¯åŠ¨æ€åˆ†æç¨‹åºä»¥è¯†åˆ«æ¶æ„è¡Œä¸ºã€‚ä¸€äº›æŠ€æœ¯ä¾§é‡äºæ”¶é›†è¿è¡Œæ—¶ç»Ÿè®¡æ•°æ®æ¥æ„å»ºè¯†åˆ«æ¶æ„è½¯ä»¶çš„æ¨¡å‹[23]ã€[53]ã€[68]ã€‚å…¶ä»–æŠ€æœ¯åˆ©ç”¨ç¬¦å·æ‰§è¡Œ[39]æˆ–å¼ºåˆ¶æ‰§è¡Œ[38]æ¥è§¦å‘éšè—åœ¨å¤æ‚è¾“å…¥åºåˆ—åé¢çš„æ¶æ„è½¯ä»¶ã€‚Wobfusctorä¸å¤ªå¯èƒ½é™ä½å¯¹è¿™äº›æ£€æµ‹å™¨çš„æ£€æµ‹ç‡ï¼Œå› ä¸ºæˆ‘ä»¬ä¸ä¼šæ˜¾è‘—æ”¹å˜è¿è¡Œæ—¶çš„è¡Œä¸ºã€‚</p><p><strong>æ··æ·†æ£€æµ‹</strong>ï¼šä¸€äº›ç°æœ‰çš„å·¥ä½œåªä¸“æ³¨äºæ£€æµ‹æ··æ·†ï¼Œè€Œä¸æ˜¯æ··æ·†çš„æ¶æ„è½¯ä»¶ã€‚NOFUS[35]å’ŒJSOD[13]ä½¿ç”¨å¥æ³•å’Œä¸Šä¸‹æ–‡ä¿¡æ¯ä½œä¸ºæœºå™¨å­¦ä¹ åˆ†ç±»å™¨æ£€æµ‹æ··æ·†çš„ç‰¹å¾ã€‚Sarkerç­‰äºº[53]é€šè¿‡æ£€æµ‹æµè§ˆå™¨APIå¹¶ç¡®å®šè·Ÿè¸ªçš„APIè°ƒç”¨æ˜¯å¦å¯¹åº”äºé™æ€ä»£ç ä½ç½®ï¼Œå¼€å‘äº†ä¸€ç§æ··åˆæ–¹æ³•ã€‚</p><p><strong>WebAssemblyå’ŒWebAssemblySecurity</strong>ï¼šHaasç­‰äºº[31]è§£é‡Šäº†å°†æ–°çš„å­—èŠ‚ç è¯­è¨€å¼•å…¥Webçš„åŠ¨æœºå’Œå¥½å¤„ã€‚ä¸€äº›ä½œå“ç ”ç©¶äº†WebAssemblyçš„å®‰å…¨æ–¹é¢ï¼Œä¾‹å¦‚æµè§ˆå™¨ä¸­æœªç»è¯·æ±‚çš„åŠ å¯†æŒ–æ˜[40]ã€[45]ã€[52]ä»¥åŠå¦‚ä½•æ£€æµ‹å’Œé˜²å¾¡å®ƒ[37]ã€[51]ã€[62]ã€‚Lehmannç­‰äººè¡¨æ˜ï¼Œæºä»£ç çº§å†…å­˜æ¼æ´å¯èƒ½ä¼šä¼ æ’­åˆ°WebAssemblyäºŒè¿›åˆ¶æ–‡ä»¶[41]ï¼Œè¿™æ˜¯ä¸€ä¸ªå½±å“è®¸å¤šç°å®ä¸–ç•ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„é—®é¢˜[33]ã€‚ç„¶è€Œï¼Œè¿™ä¸¤é¡¹å·¥ä½œéƒ½æ²¡æœ‰ä½¿ç”¨WebAssemblyæ¥éšè—ä»»æ„çš„JavaScriptè¡Œä¸ºã€‚æœªæ¥JavaScriptå’ŒWebAssemblyçš„è”åˆæ¶æ„ä»£ç æ£€æµ‹å™¨å¯ä»¥åŸºäºWasabiæ¡†æ¶[42]æˆ–WebAssembly[29]çš„æ±¡æŸ“è·Ÿè¸ªæ¡†æ¶[57]æ„å»ºã€‚</p><h2 id="_9-ç»“è®º" tabindex="-1"><a class="header-anchor" href="#_9-ç»“è®º"><span>9. ç»“è®º</span></a></h2><p>è®¸å¤šå·¥ä½œéƒ½é›†ä¸­åœ¨ä½¿ç”¨é™æ€åˆ†æè¯†åˆ«JavaScriptæ¶æ„è½¯ä»¶ä¸Šã€‚ç„¶è€Œï¼Œè¿™äº›æŠ€æœ¯å¿½ç•¥äº†æ”»å‡»è€…å¯ç”¨çš„æœ€æ–°webæ ‡å‡†ï¼Œå³WebAssemblyã€‚ä¸ºäº†ç»•è¿‡é™æ€æ£€æµ‹å™¨ï¼Œæˆ‘ä»¬æå‡ºäº†Wobfuscatorï¼Œè¿™æ˜¯ä¸€ç§åŸºäºä¸€ç»„ä¸ƒæ¡è½¬æ¢è§„åˆ™çš„æ··æ·†æ–¹æ³•ï¼Œå¯ä»¥å°†JavaScriptä»£ç çš„ç‰¹å®šéƒ¨åˆ†æœºä¼šä¸»ä¹‰åœ°è½¬æ¢ä¸ºåŠŸèƒ½ç›¸åŒçš„WebAssemblyæ¨¡å—ã€‚æˆ‘ä»¬é’ˆå¯¹å››ç§æœ€å…ˆè¿›çš„é™æ€JavaScriptæ¶æ„è½¯ä»¶æ£€æµ‹å™¨è¯„ä¼°äº†æˆ‘ä»¬çš„è½¬æ¢ï¼Œå¹¶è¡¨æ˜æˆ‘ä»¬çš„æ–¹æ³•æœ‰æ•ˆåœ°å‡å°‘äº†å¯¹çœŸå®æ¶æ„è½¯ä»¶æ ·æœ¬çš„å¬å›ã€‚æˆ‘ä»¬è¯æ˜ï¼Œæˆ‘ä»¬çš„æŠ€æœ¯ä¼˜äºä»…åŸºäºJavaScriptçš„å…¶ä»–æ··æ·†å·¥å…·ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨å…­ä¸ªNPMåŒ…çš„æµ‹è¯•å¥—ä»¶æ¥éªŒè¯æˆ‘ä»¬çš„è½¬æ¢çš„æ­£ç¡®æ€§ï¼Œå¹¶å±•ç¤ºå®ƒä»¬çš„ä½æ€§èƒ½å¼€é”€ã€‚æˆ‘ä»¬çš„ç»“æœè¡¨æ˜ï¼Œå½“å‰çš„é™æ€æ£€æµ‹å™¨å¯¹å®ç°è·¨è¯­è¨€ä»£ç æ··æ·†çš„æŠ€æœ¯æ— æ•ˆï¼Œè¿™æ¿€åŠ±äº†æœªæ¥åº”å¯¹è¿™ä¸€æŒ‘æˆ˜çš„å·¥ä½œã€‚</p><figure><img src="/assets/images/scholar/Wobfuscator%EF%BC%9A%E9%80%9A%E8%BF%87%E9%80%89%E6%8B%A9%E6%80%A7%E5%9C%B0%E7%BF%BB%E8%AF%91%E5%88%B0WASM%E6%9D%A5%E6%B7%B7%E6%B7%86JavaScript%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/table7-8.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="references" tabindex="-1"><a class="header-anchor" href="#references"><span>References</span></a></h2><h2 id="citations" tabindex="-1"><a class="header-anchor" href="#citations"><span>Citations</span></a></h2><h3 id="xmal-a-lightweight-memory-based-explainable-obfuscated-malware-detector" tabindex="-1"><a class="header-anchor" href="#xmal-a-lightweight-memory-based-explainable-obfuscated-malware-detector"><span>XMal: A lightweight memory-based explainable obfuscated-malware detector</span></a></h3><blockquote><p>Computers &amp; Security 2023ã€CCF B</p></blockquote><h3 id="finding-the-dwarf-recovering-precise-types-from-webassembly-binaries" tabindex="-1"><a class="header-anchor" href="#finding-the-dwarf-recovering-precise-types-from-webassembly-binaries"><span>Finding the Dwarf: Recovering Precise Types from WebAssembly Binaries</span></a></h3><blockquote><p>PLDI 2022ã€CCF A</p></blockquote></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/iXanadu13/iXanadu13.github.io/edit/main/src/posts/scholar/Wobfuscatorï¼šé€šè¿‡é€‰æ‹©æ€§åœ°ç¿»è¯‘åˆ°WASMæ¥æ··æ·†JavaScriptæ¶æ„è½¯ä»¶.md" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><span class="vp-meta-info" data-allow-mismatch="text">2025/10/12 03:57:52</span></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: xanadu13@qq.com">Xanadu13</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/posts/scholar/Emerging_Threat_of_Web-Enabled_LLMs.html" aria-label="When LLMs Go Online: The Emerging Threat of Web-Enabled LLMs"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>When LLMs Go Online: The Emerging Threat of Web-Enabled LLMs</div></a><a class="route-link auto-link next" href="/posts/scholar/%E5%9F%BA%E4%BA%8E%E8%BD%AF%E4%BB%B6%E7%9A%84%E7%94%9F%E5%AD%98%E6%9C%BA%E5%88%B6%E4%BF%9D%E6%8A%A4.html" aria-label="åŸºäºè½¯ä»¶çš„ç”Ÿå­˜æœºåˆ¶ä¿æŠ¤"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">åŸºäºè½¯ä»¶çš„ç”Ÿå­˜æœºåˆ¶ä¿æŠ¤<span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span></div></a></nav><div id="comment" class="giscus-wrapper input-top vp-comment" vp-comment style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">Made with â¤ï¸</div><div class="vp-copyright">Copyright Â© 2026 Xanadu13 </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-Bb1W1urA.js" defer></script>
  </body>
</html>
