<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.18" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.59" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://iXanadu13.github.io/posts/scholar/RustSan%EF%BC%9ARetrofitting%20AddressSanitizer%20for%20Efficient%20Sanitization%20of%20Rust.html"><meta property="og:site_name" content="Xanadu13's Blog"><meta property="og:title" content="RustSan: Retrofitting AddressSanitizer for Efficient Sanitization of Rust"><meta property="og:description" content="RustSan: Retrofitting AddressSanitizer for Efficient Sanitization of Rust è®ºæ–‡æ”¶å½•äºç¬¬33å±Š USENIX Security Symposiumï¼ˆUSENIX Security â€™24ï¼ŒCCF Aï¼‰ çš„ä¼šè®®è®ºæ–‡é›†ï¼Œé“¾æ¥ï¼šhttps://www.usenix.org/confere..."><meta property="og:type" content="article"><meta property="og:image" content="https://iXanadu13.github.io/assets/images/scholar/RustSan/figure1.png"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-10-17T11:53:39.000Z"><meta property="article:published_time" content="2025-10-15T00:00:00.000Z"><meta property="article:modified_time" content="2025-10-17T11:53:39.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"RustSan: Retrofitting AddressSanitizer for Efficient Sanitization of Rust","image":["https://iXanadu13.github.io/assets/images/scholar/RustSan/figure1.png","https://iXanadu13.github.io/assets/images/scholar/RustSan/figure2.png","https://iXanadu13.github.io/assets/images/scholar/RustSan/listing1.png","https://iXanadu13.github.io/assets/images/scholar/RustSan/figure3.png","https://iXanadu13.github.io/assets/images/scholar/RustSan/table1.png","https://iXanadu13.github.io/assets/images/scholar/RustSan/table3.png","https://iXanadu13.github.io/assets/images/scholar/RustSan/figure4.png","https://iXanadu13.github.io/assets/images/scholar/RustSan/figure5.png","https://iXanadu13.github.io/assets/images/scholar/RustSan/table4.png","https://iXanadu13.github.io/assets/images/scholar/RustSan/table5.png","https://iXanadu13.github.io/assets/images/scholar/RustSan/table6.png","https://iXanadu13.github.io/assets/images/scholar/RustSan/figure6.png"],"datePublished":"2025-10-15T00:00:00.000Z","dateModified":"2025-10-17T11:53:39.000Z","author":[{"@type":"Person","name":"Xanadu13","url":"https://github.com/iXanadu13"}]}</script><link rel="icon" href="/skyblock.png"><title>RustSan: Retrofitting AddressSanitizer for Efficient Sanitization of Rust | Xanadu13's Blog</title><meta name="description" content="RustSan: Retrofitting AddressSanitizer for Efficient Sanitization of Rust è®ºæ–‡æ”¶å½•äºç¬¬33å±Š USENIX Security Symposiumï¼ˆUSENIX Security â€™24ï¼ŒCCF Aï¼‰ çš„ä¼šè®®è®ºæ–‡é›†ï¼Œé“¾æ¥ï¼šhttps://www.usenix.org/confere...">
    <link rel="preload" href="/assets/style-5cE57DiZ.css" as="style"><link rel="stylesheet" href="/assets/style-5cE57DiZ.css">
    <link rel="modulepreload" href="/assets/app-CbaX5e1n.js"><link rel="modulepreload" href="/assets/RustSanï¼šRetrofitting AddressSanitizer for Efficient Sanitization of Rust.html-nPs5RA4L.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-BU_7n8-C.js" as="script"><link rel="prefetch" href="/assets/intro.html-DZCbt6Lq.js" as="script"><link rel="prefetch" href="/assets/compiler_principle.html-DahNWUaJ.js" as="script"><link rel="prefetch" href="/assets/ensp-win11.html-DLpljpmX.js" as="script"><link rel="prefetch" href="/assets/git.html-HKff7pRG.js" as="script"><link rel="prefetch" href="/assets/install-rabbitmq.html-DJItHXZ4.js" as="script"><link rel="prefetch" href="/assets/interview.html-Bg7AQsTS.js" as="script"><link rel="prefetch" href="/assets/linux-cmd.html-BWOMW_X9.js" as="script"><link rel="prefetch" href="/assets/nodejs.html-GH-c5U1w.js" as="script"><link rel="prefetch" href="/assets/tsconfig-json-error.html-DMWaOZzn.js" as="script"><link rel="prefetch" href="/assets/vmware-macOS.html-DiGNSr8X.js" as="script"><link rel="prefetch" href="/assets/yapi.html-CE6Q1Pg4.js" as="script"><link rel="prefetch" href="/assets/å»è™šæ‹ŸåŒ–.html-CW2pJBgw.js" as="script"><link rel="prefetch" href="/assets/Catalan.html-DEllh9eV.js" as="script"><link rel="prefetch" href="/assets/LIS.html-BVjYvAMW.js" as="script"><link rel="prefetch" href="/assets/disjoint-set.html-B0hQrwEa.js" as="script"><link rel="prefetch" href="/assets/jd0802t2.html-BXuAPyNz.js" as="script"><link rel="prefetch" href="/assets/jd0809t1.html-DjCFa4Ip.js" as="script"><link rel="prefetch" href="/assets/kmp.html-DdLaP68x.js" as="script"><link rel="prefetch" href="/assets/longestPalindrome.html-Cufnejxz.js" as="script"><link rel="prefetch" href="/assets/sieve.html-Dg7oLjoy.js" as="script"><link rel="prefetch" href="/assets/sort.html-n_59EV9h.js" as="script"><link rel="prefetch" href="/assets/Round-1044-div2.html-BfBpfRah.js" as="script"><link rel="prefetch" href="/assets/basic.html-D7NELQtY.js" as="script"><link rel="prefetch" href="/assets/c-union.html-BzrlUj48.js" as="script"><link rel="prefetch" href="/assets/compile-time-obf.html-CBxbA2tw.js" as="script"><link rel="prefetch" href="/assets/meta-program.html-BMyv8gPb.js" as="script"><link rel="prefetch" href="/assets/priority_queue.html-xQB6CU_k.js" as="script"><link rel="prefetch" href="/assets/shared_ptr.html-C5iKJNxj.js" as="script"><link rel="prefetch" href="/assets/mysql-devide.html-BPfZNi98.js" as="script"><link rel="prefetch" href="/assets/1010.html-Di8WAHK1.js" as="script"><link rel="prefetch" href="/assets/1028.html-DWH0Pvx-.js" as="script"><link rel="prefetch" href="/assets/1058-ä¸‘æ•°.html-BprRTO1L.js" as="script"><link rel="prefetch" href="/assets/1213-disjoint-set.html-RYiXwKJ0.js" as="script"><link rel="prefetch" href="/assets/3743-merge-sort.html-CGlgGoTC.js" as="script"><link rel="prefetch" href="/assets/ExecutorService.html-CTGXb2Cu.js" as="script"><link rel="prefetch" href="/assets/classfile-format.html-BO7bI_A7.js" as="script"><link rel="prefetch" href="/assets/log-in-java.html-DmituM93.js" as="script"><link rel="prefetch" href="/assets/sync.html-CMISqYp7.js" as="script"><link rel="prefetch" href="/assets/P1106-åˆ æ•°é—®é¢˜.html-De1jL930.js" as="script"><link rel="prefetch" href="/assets/P1175-è¡¨è¾¾å¼çš„è½¬æ¢.html-D6A7eKMk.js" as="script"><link rel="prefetch" href="/assets/P1323-åˆ æ•°é—®é¢˜2.html-CADXwBwz.js" as="script"><link rel="prefetch" href="/assets/P1462-é€šå¾€å¥¥æ ¼ç‘ç›çš„é“è·¯.html-IcYjQf4q.js" as="script"><link rel="prefetch" href="/assets/P1807-æœ€é•¿è·¯.html-DfP3nAmX.js" as="script"><link rel="prefetch" href="/assets/P3916-å›¾çš„éå†.html-BJzMLL8H.js" as="script"><link rel="prefetch" href="/assets/difficulties.html-CfCK87nS.js" as="script"><link rel="prefetch" href="/assets/tricks.html-TNHQy7C_.js" as="script"><link rel="prefetch" href="/assets/C2RustSafe.html-C1SJ5Q9y.js" as="script"><link rel="prefetch" href="/assets/CFHiderï¼šåŸºäºIntel SGXçš„æ§åˆ¶æµæ··æ·†.html-BA0JQE5T.js" as="script"><link rel="prefetch" href="/assets/Do-not-Write-but-Return.html-DLRpO9Ll.js" as="script"><link rel="prefetch" href="/assets/EVOC2RUSTï¼šç”¨äºé¡¹ç›®çº§Cåˆ°Rustè½¬æ¢çš„éª¨æ¶å¼•å¯¼æ¡†æ¶.html-DumI7yp0.js" as="script"><link rel="prefetch" href="/assets/Emerging_Threat_of_Web-Enabled_LLMs.html-bbb0UE0-.js" as="script"><link rel="prefetch" href="/assets/Ownership_Guided_C_to_Rust_Translation.html-CY7COe1G.js" as="script"><link rel="prefetch" href="/assets/RansomSentryï¼šä½¿ç”¨åŸºäºç¼–è¯‘å™¨çš„æ£€æµ‹å·¥å…·å¯¹Androidå‹’ç´¢è½¯ä»¶è¿›è¡Œè¿è¡Œæ—¶æ£€æµ‹.html-BJ7dl6Ms.js" as="script"><link rel="prefetch" href="/assets/Translingual_Obfuscation.html-BUW5nzoC.js" as="script"><link rel="prefetch" href="/assets/Wobfuscatorï¼šé€šè¿‡é€‰æ‹©æ€§åœ°ç¿»è¯‘åˆ°WASMæ¥æ··æ·†JavaScriptæ¶æ„è½¯ä»¶.html--EWzS20z.js" as="script"><link rel="prefetch" href="/assets/å…³äºLLMåº”ç”¨ç¨‹åºå•†åº—çš„ï¼ˆå†…éƒ¨ï¼‰å®‰å…¨æ€§.html-DA-C1Pwx.js" as="script"><link rel="prefetch" href="/assets/åæ··æ·†ï¼šé€†å‘æ··æ·†åçš„ä»£ç .html-DWeEx1Zv.js" as="script"><link rel="prefetch" href="/assets/åŸºäºè½¯ä»¶çš„ç”Ÿå­˜æœºåˆ¶ä¿æŠ¤.html-KZZmVm7C.js" as="script"><link rel="prefetch" href="/assets/è‡ªåŠ¨ç¨‹åºç¿»è¯‘çš„ç¨‹åºéª¨æ¶.html-993aSSts.js" as="script"><link rel="prefetch" href="/assets/é€šè¿‡è¯­ä¹‰ä¿æŒä»£ç è½¬æ¢æŒ‘æˆ˜åŸºäºæœºå™¨å­¦ä¹ çš„å…‹éš†æ£€æµ‹å™¨.html-CTiGzoJB.js" as="script"><link rel="prefetch" href="/assets/é€šè¿‡é™æ€åˆ†ææ”¹è¿›è‡ªåŠ¨Cåˆ°Rustçš„è½¬æ¢.html-BTb6AxDx.js" as="script"><link rel="prefetch" href="/assets/WSL-memo.html-D9XvNu9S.js" as="script"><link rel="prefetch" href="/assets/centos.html-B5Pb9gnC.js" as="script"><link rel="prefetch" href="/assets/docker-in-WSL.html-DhQLLnww.js" as="script"><link rel="prefetch" href="/assets/kali-linux-in-WSL.html-BucMK8bW.js" as="script"><link rel="prefetch" href="/assets/kali-wsl-autostart.html-H1hEr8DG.js" as="script"><link rel="prefetch" href="/assets/ssh-in-WSL.html-CoKhG4YP.js" as="script"><link rel="prefetch" href="/assets/404.html-C_rzgqNy.js" as="script"><link rel="prefetch" href="/assets/index.html-3D68_Tyc.js" as="script"><link rel="prefetch" href="/assets/index.html-DVS5zY0t.js" as="script"><link rel="prefetch" href="/assets/index.html-g-V_YkSM.js" as="script"><link rel="prefetch" href="/assets/index.html-BYn6iN6E.js" as="script"><link rel="prefetch" href="/assets/index.html-446Kd1rk.js" as="script"><link rel="prefetch" href="/assets/index.html-C2PeCEYJ.js" as="script"><link rel="prefetch" href="/assets/index.html-B_zWIBwO.js" as="script"><link rel="prefetch" href="/assets/index.html-CGIwL75r.js" as="script"><link rel="prefetch" href="/assets/index.html-DxScnUfr.js" as="script"><link rel="prefetch" href="/assets/index.html-3HxP8t8-.js" as="script"><link rel="prefetch" href="/assets/index.html-CBfJZHe0.js" as="script"><link rel="prefetch" href="/assets/index.html-CM_C0DXe.js" as="script"><link rel="prefetch" href="/assets/index.html-DUsUxUuM.js" as="script"><link rel="prefetch" href="/assets/index.html-B7KC6D2B.js" as="script"><link rel="prefetch" href="/assets/index.html-CleDjQzt.js" as="script"><link rel="prefetch" href="/assets/index.html-Bg-MYRSc.js" as="script"><link rel="prefetch" href="/assets/index.html-Bs5UiLxo.js" as="script"><link rel="prefetch" href="/assets/index.html-CzC-zNeV.js" as="script"><link rel="prefetch" href="/assets/index.html-Dzh7yp9o.js" as="script"><link rel="prefetch" href="/assets/index.html-DqXP_LAL.js" as="script"><link rel="prefetch" href="/assets/index.html-rrYp54Z0.js" as="script"><link rel="prefetch" href="/assets/index.html-BAZ3iVI-.js" as="script"><link rel="prefetch" href="/assets/index.html-F8nejYNw.js" as="script"><link rel="prefetch" href="/assets/index.html-zt2ugedx.js" as="script"><link rel="prefetch" href="/assets/index.html-CIuSn8Vm.js" as="script"><link rel="prefetch" href="/assets/index.html-D8RMj36M.js" as="script"><link rel="prefetch" href="/assets/index.html-B5jX_O31.js" as="script"><link rel="prefetch" href="/assets/index.html-ztQsgG4X.js" as="script"><link rel="prefetch" href="/assets/index.html-D0Rz_pvY.js" as="script"><link rel="prefetch" href="/assets/index.html-ChAdOPzN.js" as="script"><link rel="prefetch" href="/assets/index.html-DwQwtcff.js" as="script"><link rel="prefetch" href="/assets/index.html-DlWD4DrV.js" as="script"><link rel="prefetch" href="/assets/index.html-DVagSuBV.js" as="script"><link rel="prefetch" href="/assets/index.html-BY7iMdd3.js" as="script"><link rel="prefetch" href="/assets/index.html-0IdvgpHA.js" as="script"><link rel="prefetch" href="/assets/index.html-Dmj11OyA.js" as="script"><link rel="prefetch" href="/assets/index.html-BR-PTRvl.js" as="script"><link rel="prefetch" href="/assets/index.html-t1LUR_tW.js" as="script"><link rel="prefetch" href="/assets/index.html-INhg7Cbd.js" as="script"><link rel="prefetch" href="/assets/index.html-DwWwRT7m.js" as="script"><link rel="prefetch" href="/assets/index.html-CZaheE2b.js" as="script"><link rel="prefetch" href="/assets/index.html-KNKhSe6L.js" as="script"><link rel="prefetch" href="/assets/index.html-eg1lA6sZ.js" as="script"><link rel="prefetch" href="/assets/index.html-HEF6S7fI.js" as="script"><link rel="prefetch" href="/assets/index.html-Ce_EY5Mo.js" as="script"><link rel="prefetch" href="/assets/index.html-BivwAGzT.js" as="script"><link rel="prefetch" href="/assets/index.html-BERF2y9Z.js" as="script"><link rel="prefetch" href="/assets/index.html-DrpFW1mU.js" as="script"><link rel="prefetch" href="/assets/index.html-BoBZ_AWB.js" as="script"><link rel="prefetch" href="/assets/index.html-JL5OTakA.js" as="script"><link rel="prefetch" href="/assets/index.html-BRH7xL0L.js" as="script"><link rel="prefetch" href="/assets/index.html-cd3M7shp.js" as="script"><link rel="prefetch" href="/assets/index.html-BmsCWdyK.js" as="script"><link rel="prefetch" href="/assets/index.html-DyEIeNDG.js" as="script"><link rel="prefetch" href="/assets/index.html-Di8QcuUe.js" as="script"><link rel="prefetch" href="/assets/index.html-CMdi4Jcm.js" as="script"><link rel="prefetch" href="/assets/index.html-B0gs0x0n.js" as="script"><link rel="prefetch" href="/assets/index.html-BNPsmzfz.js" as="script"><link rel="prefetch" href="/assets/index.html-PT9oX87W.js" as="script"><link rel="prefetch" href="/assets/index.html-ClNab3P2.js" as="script"><link rel="prefetch" href="/assets/index.html-SRVABI5d.js" as="script"><link rel="prefetch" href="/assets/index.html-CVVuP025.js" as="script"><link rel="prefetch" href="/assets/index.html-DlP6HPa5.js" as="script"><link rel="prefetch" href="/assets/index.html-DhbbqNOh.js" as="script"><link rel="prefetch" href="/assets/index.html-CVXM2acC.js" as="script"><link rel="prefetch" href="/assets/index.html-UDKtBetv.js" as="script"><link rel="prefetch" href="/assets/index.html-DJPxFcbG.js" as="script"><link rel="prefetch" href="/assets/index.html-DoJaYF9a.js" as="script"><link rel="prefetch" href="/assets/giscus-BZxmVUME.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-GXRgw7eJ.js" as="script"><link rel="prefetch" href="/assets/SearchResult-C5PxbpMS.js" as="script"><link rel="prefetch" href="/assets/setupDevtools-7MC2TMWH-inGSh-OI.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/" aria-label="å¸¦æˆ‘å›å®¶"><img class="vp-nav-logo" src="/assets/icon/xmn.png" alt><!----><span class="vp-site-name hide-in-pad">Xanadu13&#39;s Blog</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="åšå®¢ä¸»é¡µ"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->åšå®¢ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/article/" aria-label="æ–‡ç« "><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->æ–‡ç« <!----></a></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/iXanadu13/iXanadu13.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="slimsearch-button" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="slimsearch-placeholder">æœç´¢</div><div class="slimsearch-key-hints"><kbd class="slimsearch-key">Ctrl</kbd><kbd class="slimsearch-key">K</kbd></div></button><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/" aria-label="åšå®¢ä¸»é¡µ"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->åšå®¢ä¸»é¡µ<!----></a></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header active"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">æ–‡ç« </span><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Algo</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Codeforces</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Cpp</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Database</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Hdoj</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Java</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/linux-cmd.html" aria-label="LinuxæŒ‡ä»¤å¤‡å¿˜å½•"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->LinuxæŒ‡ä»¤å¤‡å¿˜å½•<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Luogu</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/nodejs.html" aria-label="Nodejsä¸­æŠ¥é”™â€œError: spawn EINVALâ€"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Nodejsä¸­æŠ¥é”™â€œError: spawn EINVALâ€<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/install-rabbitmq.html" aria-label="RabbitMQå®‰è£…è¸©å‘è®°å½•"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->RabbitMQå®‰è£…è¸©å‘è®°å½•<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Rust</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Scholar</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/CFHider%EF%BC%9A%E5%9F%BA%E4%BA%8EIntel%20SGX%E7%9A%84%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B7%B7%E6%B7%86.html" aria-label="CFHider: Control Flow Obfuscation with Intel SGX"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->CFHider: Control Flow Obfuscation with Intel SGX<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/%E9%80%9A%E8%BF%87%E8%AF%AD%E4%B9%89%E4%BF%9D%E6%8C%81%E4%BB%A3%E7%A0%81%E8%BD%AC%E6%8D%A2%E6%8C%91%E6%88%98%E5%9F%BA%E4%BA%8E%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%9A%84%E5%85%8B%E9%9A%86%E6%A3%80%E6%B5%8B%E5%99%A8.html" aria-label="Challenging Machine Learning-based Clone Detectors via Semantic-preserving Code Transformations"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Challenging Machine Learning-based Clone Detectors via Semantic-preserving Code Transformations<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/%E5%8F%8D%E6%B7%B7%E6%B7%86%EF%BC%9A%E9%80%86%E5%90%91%E6%B7%B7%E6%B7%86%E5%90%8E%E7%9A%84%E4%BB%A3%E7%A0%81.html" aria-label="Deobfuscation: Reverse Engineering Obfuscated Code"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Deobfuscation: Reverse Engineering Obfuscated Code<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/Do-not-Write-but-Return.html" aria-label="Donâ€™t Write, but Return: Replacing Output Parameters with Algebraic Data Types in C-to-Rust Translation"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Donâ€™t Write, but Return: Replacing Output Parameters with Algebraic Data Types in C-to-Rust Translation<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/EVOC2RUST%EF%BC%9A%E7%94%A8%E4%BA%8E%E9%A1%B9%E7%9B%AE%E7%BA%A7C%E5%88%B0Rust%E8%BD%AC%E6%8D%A2%E7%9A%84%E9%AA%A8%E6%9E%B6%E5%BC%95%E5%AF%BC%E6%A1%86%E6%9E%B6.html" aria-label="EVOC2RUST: A Skeleton-guided Framework for Project-Level C-to-Rust Translation"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->EVOC2RUST: A Skeleton-guided Framework for Project-Level C-to-Rust Translation<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/%E9%80%9A%E8%BF%87%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E6%94%B9%E8%BF%9B%E8%87%AA%E5%8A%A8C%E5%88%B0Rust%E7%9A%84%E8%BD%AC%E6%8D%A2.html" aria-label="Improving Automatic C-to-Rust Translation with Static Analysis"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Improving Automatic C-to-Rust Translation with Static Analysis<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/C2RustSafe.html" aria-label="In Rust We Trust â€“ A Transpiler from Unsafe C to Safer Rust"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->In Rust We Trust â€“ A Transpiler from Unsafe C to Safer Rust<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/%E5%85%B3%E4%BA%8ELLM%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%95%86%E5%BA%97%E7%9A%84%EF%BC%88%E5%86%85%E9%83%A8%EF%BC%89%E5%AE%89%E5%85%A8%E6%80%A7.html" aria-label="On the (In)Security of LLM App Stores"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->On the (In)Security of LLM App Stores<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/Ownership_Guided_C_to_Rust_Translation.html" aria-label="Ownership Guided C to Rust Translation"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Ownership Guided C to Rust Translation<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/%E8%87%AA%E5%8A%A8%E7%A8%8B%E5%BA%8F%E7%BF%BB%E8%AF%91%E7%9A%84%E7%A8%8B%E5%BA%8F%E9%AA%A8%E6%9E%B6.html" aria-label="Program Skeletons for Automated Program Translation"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Program Skeletons for Automated Program Translation<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/RansomSentry%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E7%BC%96%E8%AF%91%E5%99%A8%E7%9A%84%E6%A3%80%E6%B5%8B%E5%B7%A5%E5%85%B7%E5%AF%B9Android%E5%8B%92%E7%B4%A2%E8%BD%AF%E4%BB%B6%E8%BF%9B%E8%A1%8C%E8%BF%90%E8%A1%8C%E6%97%B6%E6%A3%80%E6%B5%8B.html" aria-label="RansomSentry: Runtime Detection of Android Ransomware With Compiler-Based Instrumentation"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->RansomSentry: Runtime Detection of Android Ransomware With Compiler-Based Instrumentation<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/posts/scholar/RustSan%EF%BC%9ARetrofitting%20AddressSanitizer%20for%20Efficient%20Sanitization%20of%20Rust.html" aria-label="RustSan: Retrofitting AddressSanitizer for Efficient Sanitization of Rust"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->RustSan: Retrofitting AddressSanitizer for Efficient Sanitization of Rust<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/Translingual_Obfuscation.html" aria-label="Translingual Obfuscation"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Translingual Obfuscation<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/Emerging_Threat_of_Web-Enabled_LLMs.html" aria-label="When LLMs Go Online: The Emerging Threat of Web-Enabled LLMs"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->When LLMs Go Online: The Emerging Threat of Web-Enabled LLMs<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/Wobfuscator%EF%BC%9A%E9%80%9A%E8%BF%87%E9%80%89%E6%8B%A9%E6%80%A7%E5%9C%B0%E7%BF%BB%E8%AF%91%E5%88%B0WASM%E6%9D%A5%E6%B7%B7%E6%B7%86JavaScript%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6.html" aria-label="Wobfuscator: Obfuscating JavaScript Malware via Opportunistic Translation to WebAssembly"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Wobfuscator: Obfuscating JavaScript Malware via Opportunistic Translation to WebAssembly<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/scholar/%E5%9F%BA%E4%BA%8E%E8%BD%AF%E4%BB%B6%E7%9A%84%E7%94%9F%E5%AD%98%E6%9C%BA%E5%88%B6%E4%BF%9D%E6%8A%A4.html" aria-label="åŸºäºè½¯ä»¶çš„ç”Ÿå­˜æœºåˆ¶ä¿æŠ¤"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->åŸºäºè½¯ä»¶çš„ç”Ÿå­˜æœºåˆ¶ä¿æŠ¤<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Wsl</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/yapi.html" aria-label="Yapiå®‰è£…æ•™ç¨‹"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Yapiå®‰è£…æ•™ç¨‹<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/vmware-macOS.html" aria-label="åœ¨VMwareä¸­å®‰è£…MacOSè™šæ‹Ÿæœº"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->åœ¨VMwareä¸­å®‰è£…MacOSè™šæ‹Ÿæœº<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/compiler_principle.html" aria-label="ç¼–è¯‘åŸç†æœŸæœ«å¤ä¹ ç¬”è®°"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->ç¼–è¯‘åŸç†æœŸæœ«å¤ä¹ ç¬”è®°<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/%E5%8E%BB%E8%99%9A%E6%8B%9F%E5%8C%96.html" aria-label="è™šæ‹Ÿæœºå»è™šæ‹ŸåŒ–"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->è™šæ‹Ÿæœºå»è™šæ‹ŸåŒ–<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/tsconfig-json-error.html" aria-label="è§£å†³vscodeæŠ¥é”™ï¼šæ‰¾ä¸åˆ°â€œcookieâ€çš„ç±»å‹å®šä¹‰æ–‡ä»¶ã€‚ç¨‹åºåŒ…å«è¯¥æ–‡ä»¶æ˜¯å› ä¸º: éšå¼ç±»å‹åº“ &quot;cookie&quot; çš„å…¥å£ç‚¹ts"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->è§£å†³vscodeæŠ¥é”™ï¼šæ‰¾ä¸åˆ°â€œcookieâ€çš„ç±»å‹å®šä¹‰æ–‡ä»¶ã€‚ç¨‹åºåŒ…å«è¯¥æ–‡ä»¶æ˜¯å› ä¸º: éšå¼ç±»å‹åº“ &quot;cookie&quot; çš„å…¥å£ç‚¹ts<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/ensp-win11.html" aria-label="è§£å†³åœ¨windows 11ä¸­æ— æ³•ä½¿ç”¨eNSPçš„é—®é¢˜"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->è§£å†³åœ¨windows 11ä¸­æ— æ³•ä½¿ç”¨eNSPçš„é—®é¢˜<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/git.html" aria-label="è®°å½•æœ‰å…³Gitçš„å‘½ä»¤"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->è®°å½•æœ‰å…³Gitçš„å‘½ä»¤<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/interview.html" aria-label="é¢è¯•çœŸé¢˜æ•´ç†"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->é¢è¯•çœŸé¢˜æ•´ç†<!----></a></li></ul></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/intro.html" aria-label="ä»‹ç»é¡µ"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span><!--]-->ä»‹ç»é¡µ<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>RustSan: Retrofitting AddressSanitizer for Efficient Sanitization of Rust</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/iXanadu13" target="_blank" rel="noopener noreferrer">Xanadu13</a></span><span property="author" content="Xanadu13"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2025å¹´10æœˆ15æ—¥</span><meta property="datePublished" content="2025-10-15T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 58 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT58M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color8 clickable" role="navigation">Rust</span><!--]--><meta property="articleSection" content="Rust"></span><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc" vp-toc><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#æ‘˜è¦">æ‘˜è¦</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1-å¼•è¨€">1. å¼•è¨€</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-èƒŒæ™¯-background">2. èƒŒæ™¯ï¼ˆBackgroundï¼‰</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-1-addresssanitizer">2.1 AddressSanitizer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-2-rust-çš„å®‰å…¨æ¨¡å‹-rust-safety-model">2.2 Rust çš„å®‰å…¨æ¨¡å‹ï¼ˆRust safety modelï¼‰</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_3-rustsan-æ¦‚è§ˆ">3. RUSTSAN æ¦‚è§ˆ</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-1-å®šä¹‰ä¸å†…å­˜æ ¡éªŒæ¨¡å‹">3.1 å®šä¹‰ä¸å†…å­˜æ ¡éªŒæ¨¡å‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-2-è·¨-ir-åˆ†æ-cross-ir-analysis">3.2 è·¨ IR åˆ†æï¼ˆCross-IR analysisï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-3-rustsan-çš„å½±å­å†…å­˜æ–¹æ¡ˆ-rustsan-shadow-memory-scheme">3.3 RustSan çš„å½±å­å†…å­˜æ–¹æ¡ˆï¼ˆRustSan shadow memory schemeï¼‰</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4-è·¨-ir-rust-çš„-hir-mir-åˆ†æ">4. è·¨ IRï¼šRust çš„ HIR/MIR åˆ†æ</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-1-èƒŒæ™¯-rust-çš„-hir-mir">4.1 èƒŒæ™¯ï¼šRust çš„ HIR/MIR</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-2-è¯­å¥çº§å†…å­˜è®¿é—®è·Ÿè¸ª-statement-level-memory-access-tracking">4.2 è¯­å¥çº§å†…å­˜è®¿é—®è·Ÿè¸ªï¼ˆStatement-level memory access trackingï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-3-é€’å½’å®‰å…¨ä½œç”¨åŸŸåˆ†æ-recursive-safety-scope-analysis">4.3 é€’å½’å®‰å…¨ä½œç”¨åŸŸåˆ†æï¼ˆRecursive safety scope analysisï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-4-åˆ†é…å‡½æ•°è¯†åˆ«-allocation-function-identification">4.4 åˆ†é…å‡½æ•°è¯†åˆ«ï¼ˆAllocation function identificationï¼‰</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_5-è·¨-ir-llvm-ir-åˆ†æ">5. è·¨ IRï¼šLLVM IR åˆ†æ</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-1-å¯¹è±¡ä¸è®¿é—®ç‚¹çš„åˆ†ç±»æµæ°´çº¿-object-and-site-classification-pipeline">5.1 å¯¹è±¡ä¸è®¿é—®ç‚¹çš„åˆ†ç±»æµæ°´çº¿ï¼ˆObject and site classification pipelineï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-2-åˆ†é…ç‚¹å®‰å…¨æ€§çš„è¯†åˆ«-allocation-site-safety-identification">5.2 åˆ†é…ç‚¹å®‰å…¨æ€§çš„è¯†åˆ«ï¼ˆAllocation site safety identificationï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-3-å°†åˆ†ææŠ€æœ¯é€‚é…åˆ°-rust-adapting-analysis-techniques-to-rust">5.3 å°†åˆ†ææŠ€æœ¯é€‚é…åˆ° Rustï¼ˆAdapting analysis techniques to Rustï¼‰</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_6-rustsan-çš„å½±å­å†…å­˜æ–¹æ¡ˆ-shadow-memory-scheme">6. RustSan çš„å½±å­å†…å­˜æ–¹æ¡ˆï¼ˆshadow memory schemeï¼‰</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-1-æ„ŸçŸ¥å®‰å…¨æ€§çš„å¯¹è±¡åˆ†é…-safety-aware-object-allocation">6.1 æ„ŸçŸ¥å®‰å…¨æ€§çš„å¯¹è±¡åˆ†é…ï¼ˆSafety-aware object allocationï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-2-é€‰æ‹©æ€§æ’æ¡©-selective-instrumentation">6.2 é€‰æ‹©æ€§æ’æ¡©ï¼ˆSelective instrumentationï¼‰</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_7-è¯„ä¼°-evaluation">7. è¯„ä¼°ï¼ˆEvaluationï¼‰</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-1-unsafe-rust-çš„ä½¿ç”¨ç»Ÿè®¡-unsafe-rust-usage-statistics">7.1 unsafe Rust çš„ä½¿ç”¨ç»Ÿè®¡ï¼ˆUnsafe Rust usage statisticsï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-2-æ£€æµ‹èƒ½åŠ›-é€‰æ‹©æ€§æ’æ¡©çš„ç¨³å¥æ€§-detection-capability-robustness-of-selective-instrumentation">7.2 æ£€æµ‹èƒ½åŠ›ï¼šé€‰æ‹©æ€§æ’æ¡©çš„ç¨³å¥æ€§ï¼ˆDetection capability: robustness of selective instrumentationï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-3-æ£€æµ‹èƒ½åŠ›-è·¨å®‰å…¨çº§åˆ«çš„å¯¹è±¡è®¿é—®-detection-capability-cross-safety-object-access">7.3 æ£€æµ‹èƒ½åŠ›ï¼šè·¨å®‰å…¨çº§åˆ«çš„å¯¹è±¡è®¿é—®ï¼ˆDetection capability: cross-safety object accessï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-4-ä½¿ç”¨-rustsan-çš„ç¼–è¯‘æ—¶é—´-compile-time-with-rustsan">7.4 ä½¿ç”¨ RustSan çš„ç¼–è¯‘æ—¶é—´ï¼ˆCompile time with RustSanï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-5-å¾®åŸºå‡†-microbenchmarks">7.5 å¾®åŸºå‡†ï¼ˆMicrobenchmarksï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-6-é€šç”¨åº”ç”¨ä¸­çš„è¿è¡Œæ—¶å¼€é”€-runtime-overhead-in-general-applications">7.6 é€šç”¨åº”ç”¨ä¸­çš„è¿è¡Œæ—¶å¼€é”€ï¼ˆRuntime overhead in general applicationsï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-7-æ¨¡ç³Šæµ‹è¯•-fuzzing">7.7 æ¨¡ç³Šæµ‹è¯•ï¼ˆFuzzingï¼‰</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_8-å®‰å…¨æ€§ä¸ç¨³å¥æ€§è®¨è®º">8. å®‰å…¨æ€§ä¸ç¨³å¥æ€§è®¨è®º</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_8-1-å®è¯éªŒè¯-empirical-validation">8.1 å®è¯éªŒè¯ï¼ˆEmpirical validationï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_8-2-å®šæ€§åˆ†æ-qualitative-analysis">8.2 å®šæ€§åˆ†æï¼ˆQualitative analysisï¼‰</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_9-ç›¸å…³å·¥ä½œ-related-work">9. ç›¸å…³å·¥ä½œï¼ˆRelated Workï¼‰</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_9-1-é¢å‘å†…å­˜ç¼ºé™·æ£€æµ‹çš„-sanitizer">9.1 é¢å‘å†…å­˜ç¼ºé™·æ£€æµ‹çš„ Sanitizer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_9-2-é¢å‘æ€§èƒ½çš„-sanitizer-ä¼˜åŒ–">9.2 é¢å‘æ€§èƒ½çš„ Sanitizer ä¼˜åŒ–</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_9-3-rust-ç¨‹åºåŠ å›º">9.3 Rust ç¨‹åºåŠ å›º</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_10-ç»“è®º-conclusion">10 ç»“è®ºï¼ˆConclusionï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#é™„å½•">é™„å½•</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#a-cve-case-study">A. CVE case study</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#b-taint-source-reduction-with-hir-mir-analysis">B. Taint source reduction with HIR/MIR analysis</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#c-heap-allocator-microbenchmark">C. Heap allocator microbenchmark</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#citation">Citation</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content" vp-content><h1 id="rustsan-retrofitting-addresssanitizer-for-efficient-sanitization-of-rust" tabindex="-1"><a class="header-anchor" href="#rustsan-retrofitting-addresssanitizer-for-efficient-sanitization-of-rust"><span>RustSan: Retrofitting AddressSanitizer for Efficient Sanitization of Rust</span></a></h1><p>è®ºæ–‡æ”¶å½•äºç¬¬33å±Š USENIX Security Symposiumï¼ˆUSENIX Security â€™24ï¼ŒCCF Aï¼‰ çš„ä¼šè®®è®ºæ–‡é›†ï¼Œé“¾æ¥ï¼š<a href="https://www.usenix.org/conference/usenixsecurity24/presentation/cho-kyuwon" target="_blank" rel="noopener noreferrer">https://www.usenix.org/conference/usenixsecurity24/presentation/cho-kyuwon</a>ã€‚</p><p><a href="https://github.com/sslab-skku/RustSan" target="_blank" rel="noopener noreferrer">Github</a></p><h2 id="æ‘˜è¦" tabindex="-1"><a class="header-anchor" href="#æ‘˜è¦"><span>æ‘˜è¦</span></a></h2><p>Rust æ­£åœ¨ä½œä¸ºä¸€ç§å®‰å…¨çš„ç³»ç»Ÿç¼–ç¨‹è¯­è¨€è¿…é€Ÿæ™®åŠï¼Œå‡­å€Ÿå…¶å¼ºç±»å‹ä¸å†…å­˜å®‰å…¨ä¿è¯è€Œå—åˆ°å…³æ³¨ã€‚ç„¶è€Œï¼ŒRust çš„ä¿éšœå¹¶éç‰¢ä¸å¯ç ´ã€‚ä½¿ç”¨ <em>unsafe Rust</em>ï¼ˆRust çš„ä¸€ä¸ªå­å˜ä½“ï¼‰æ—¶ï¼Œç¨‹åºå‘˜å¯ä»¥æš‚æ—¶è·³å‡º Rust ä¸¥æ ¼çš„è¯­è¨€è¯­ä¹‰ï¼Œä»¥å®‰å…¨æ¢å–çµæ´»æ€§ï¼›ä½† <code>unsafe</code> ä»£ç å—ä¸­çš„å†…å­˜é”™è¯¯ä¼šå¯¹ç¨‹åºå®‰å…¨é€ æˆæ·±è¿œå½±å“ã€‚å› æ­¤ï¼Œä¼ ç»Ÿçš„åŠ¨æ€å†…å­˜é”™è¯¯æ£€æµ‹ï¼ˆå¦‚æ¨¡ç³Šæµ‹è¯• <em>fuzzing</em>ï¼‰å·²æˆä¸º Rust ç”Ÿæ€ä¸­çš„å¸¸è§å®è·µï¼Œå¹¶é€šè¿‡ä¸æ–­æŠ«éœ²çš„ CVE æˆ˜æœè¯æ˜äº†å…¶æœ‰æ•ˆæ€§ã€‚</p><p><strong>RustSan</strong> æ˜¯å¯¹ AddressSanitizerï¼ˆASanï¼‰çš„â€œæ”¹é€ å¼â€è®¾è®¡ï¼Œç”¨äºé«˜æ•ˆæ£€æµ‹ Rust ç¨‹åºä¸­çš„åŠ¨æ€å†…å­˜é”™è¯¯ã€‚æˆ‘ä»¬çš„è§‚å¯Ÿæ˜¯ï¼šå°† ASan ç¼–è¯‘æ’æ¡©åˆ° Rust ç¨‹åºåï¼Œè®¸å¤šè¢«æ’æ¡©çš„å†…å­˜è®¿é—®ç‚¹åœ¨ Rust è¯­ä¹‰ä¿è¯ä¸‹å®é™…ä¸Šæ˜¯<strong>å†—ä½™</strong>çš„ï¼Œå³è¿™äº›ä½ç½®çš„å†…å­˜å®‰å…¨åœ¨è¯­ä¹‰ä¸Šä»ç„¶æˆç«‹ã€‚RustSan çš„åšæ³•æ˜¯ï¼šè¯†åˆ«å¹¶ä»…å¯¹é‚£äº›<strong>å¿…ç„¶</strong>æˆ–<strong>å¯èƒ½</strong>ç ´å Rust å®‰å…¨ä¿è¯çš„ä½ç½®è¿›è¡Œæ’æ¡©ï¼ŒåŒæ—¶åœ¨<strong>å®‰å…¨ä½ç½®</strong>ç§»é™¤æ’æ¡©ã€‚ä¸ºæ­¤ï¼ŒRustSan é‡‡ç”¨è·¨ IR çš„ç¨‹åºåˆ†æï¼Œä»¥ç²¾ç¡®è¿½è¸ª <code>unsafe</code> ä½ç½®ï¼Œå¹¶æ‰©å±•äº† ASan çš„å½±å­å†…å­˜æ–¹æ¡ˆï¼Œç”¨äºæ£€æŸ¥ Rust æ‰€éœ€çš„<strong>éå‡åŒ€å†…å­˜è®¿é—®</strong>ï¼ˆnon-uniform memory accessï¼‰éªŒè¯æœºåˆ¶ã€‚æˆ‘ä»¬åœ¨ 57 ä¸ª Rust crate ä¸Šï¼Œå¯¹ RustSan çš„æ£€æµ‹èƒ½åŠ›ä¸æ€§èƒ½è¿›è¡Œäº†å…¨é¢è¯„ä¼°ã€‚RustSan æˆåŠŸæ£€æµ‹å‡º 31 ä¸ªå®é™… CVE æ¡ˆä¾‹ä¸­çš„<strong>å…¨éƒ¨</strong>å†…å­˜é”™è¯¯ã€‚åœ¨é€šç”¨åŸºå‡†ä¸­ï¼ˆ20 ä¸ª crateï¼‰ï¼Œç›¸è¾ƒ ASanï¼ŒRustSan çš„æ€§èƒ½å¹³å‡<strong>æå‡ 62.3%</strong>ã€‚åœ¨å¯¹ 6 ä¸ª crate çš„æ¨¡ç³Šæµ‹è¯•å®éªŒä¸­ï¼ŒRustSan çš„å¹³å‡æ€§èƒ½<strong>æå‡ 23.52%</strong>ï¼Œæœ€é«˜å¯è¾¾<strong>57.08%</strong>ã€‚</p><hr><h2 id="_1-å¼•è¨€" tabindex="-1"><a class="header-anchor" href="#_1-å¼•è¨€"><span>1. å¼•è¨€</span></a></h2><p>Rust ä½œä¸ºä¸€ç§å®ç”¨çš„<strong>å®‰å…¨</strong>ç³»ç»Ÿç¼–ç¨‹è¯­è¨€æ­£æ—¥ç›Šå—åˆ°æ¬¢è¿ã€‚å®ƒé€šè¿‡ä¸¥æ ¼çš„<strong>ç¼–è¯‘æœŸè§„åˆ™</strong>ä¸è½»é‡çš„<strong>è¿è¡ŒæœŸæ£€æŸ¥</strong>æ¥ä¿è¯å†…å­˜å®‰å…¨ã€‚è®¸å¤šæ–°é¡¹ç›®å·²å°† Rust ä½œä¸ºä¸»è¦ç¼–ç¨‹è¯­è¨€ï¼ˆä¾‹å¦‚æ–‡çŒ® [2, 4â€“8, 17, 21, 41]ï¼‰ã€‚æ­¤å¤–ï¼ŒLinux å†…æ ¸ä¸­å¯¹ Rust åŸºç¡€è®¾æ–½çš„çº³å…¥ [2] ä¹Ÿæ˜¯ Rust æŒç»­è¢«å¹¿æ³›é‡‡çº³çš„é‡Œç¨‹ç¢‘äº‹ä»¶ã€‚</p><p>ç„¶è€Œï¼Œè¿™äº›å®‰å…¨ä¿è¯å¹¶éæ²¡æœ‰ä»£ä»·ã€‚Rust é€šè¿‡æ–½åŠ ä¸¥æ ¼çš„è¯­è¨€è¯­ä¹‰ï¼Œè¦æ±‚ç¨‹åºå‘˜ä¸ä¹‹â€œåˆä½œâ€ã€‚å€Ÿæ­¤ï¼Œè¯­è¨€è®¾è®¡ä¸ç¨‹åºå‘˜å…±åŒäº§å‡ºèƒ½å¤Ÿè¢«ç¼–è¯‘å™¨ä¸æœ€å°åŒ–è¿è¡Œæ—¶æ£€æŸ¥æ‰€éªŒè¯çš„ä»£ç ã€‚Rust çš„å®‰å…¨æ¨¡å‹åœ¨æŸäº›éœ€è¦ç²¾ç»†åŒ–æŒæ§çš„åœºæ™¯é‡Œå¯èƒ½è¿‡äºä¸¥æ ¼ã€‚ä¸ºæ­¤ï¼ŒRust æä¾›äº†ä¸€ä¸ªå˜ä½“ <strong>unsafe Rust</strong>ï¼Œå®ƒå­˜åœ¨äºä½¿ç”¨ <code>unsafe</code> å…³é”®å­—å£°æ˜çš„ä»£ç å—ä¸­ã€‚ä¸åœ¨ Rust ä¸­è¢«ç¦æ­¢çš„è¡Œä¸ºç›¸æ¯”ï¼ˆä¾‹å¦‚åŸå§‹æŒ‡é’ˆè®¿é—®ã€ç»•è¿‡ä¸¥æ ¼çš„æ‰€æœ‰æƒæ£€æŸ¥ [9]ï¼‰ï¼Œ<code>unsafe</code> å…è®¸ä¸å—é™åˆ¶åœ°è®¿é—®è¿™äº›è¯­è¨€è¯­ä¹‰ã€‚åœ¨æŸäº›ç¨‹åºä¸­ï¼ˆä¾‹å¦‚ä¸ä½å±‚ç»„ä»¶äº¤äº’ï¼‰ï¼Œæˆ–å½“ç¨‹åºå‘˜ä¸ºäº†çµæ´»æ€§è€Œé€‰æ‹©ä»¥å®‰å…¨æ¢å–æ•ˆç‡æ—¶ï¼Œä½¿ç”¨ <code>unsafe</code> å¾€å¾€æ˜¯ä¸å¯é¿å…çš„ã€‚</p><p>å…ˆå‰çš„ç ”ç©¶å·²ç»è€ƒå¯Ÿäº†åœ¨ Rust ä¸­ä½¿ç”¨ <code>unsafe</code> çš„å¸¸è§å®è·µï¼Œä»¥åŠåœ¨ Rust ç¨‹åºä¸­ä½¿ç”¨ <code>unsafe</code> çš„å½±å“ [22, 56]ã€‚è¿™äº›å·¥ä½œå‘ç°ï¼šåœ¨ Rust ç¨‹åºä¸­ï¼Œå‡ ä¹<strong>æ‰€æœ‰</strong>å†…å­˜é”™è¯¯éƒ½æºè‡ª <code>unsafe Rust</code> çš„ä½¿ç”¨ [56]ã€‚ä½œä¸ºå›åº”ï¼Œç ”ç©¶è€…æå‡ºäº†ç”¨äºå‘ç° Rust å†…å­˜é”™è¯¯çš„<strong>é™æ€åˆ†æ</strong>æ–¹æ³• [14, 26, 36, 37]ï¼Œä»¥åŠåœ¨è¿è¡Œæ—¶å°†<strong>å®‰å…¨ Rust</strong>ä¸<strong>ä¸å®‰å…¨ Rust</strong>éš”ç¦»çš„æ–¹æ¡ˆ [15, 31, 33, 38, 45]ã€‚</p><p>é™æ€åˆ†ææ–¹æ³•åœ¨æ£€æµ‹<strong>é«˜åº¦å¤æ‚çš„ç¼ºé™·</strong>æˆ–<strong>ä»…åœ¨è¿è¡Œæ—¶æš´éœ²</strong>çš„é—®é¢˜æ–¹é¢èƒ½åŠ›æœ‰é™ã€‚è¿è¡Œæ—¶éš”ç¦»æ¡†æ¶ä¸ºè¯†åˆ« Rust ç¨‹åºä¸­ä¸å®‰å…¨çš„å­ç¨‹åºé›†åˆã€ä»¥ä¿æŠ¤å®‰å…¨ Rust éƒ¨åˆ†å¥ å®šäº†åŸºç¡€ã€‚è¿è¡Œæ—¶éš”ç¦»æ˜¯<strong>éåˆ¶å½±å“</strong>è€Œé<strong>ç›´æ¥æ£€æµ‹</strong>æ¥è‡ª <code>unsafe Rust</code> çš„å†…å­˜é”™è¯¯ã€‚æ­¤å¤–ï¼Œå·²æœ‰éš”ç¦»æ–¹æ¡ˆå¾€å¾€ä¾èµ–ç¡¬ä»¶ç‰¹æ€§ï¼ˆä¾‹å¦‚ Memory Protection Keyï¼ŒMPKï¼‰[15, 31]ï¼Œä»è€Œé˜»ç¢äº†å¯ç§»æ¤æ€§ã€‚éšç€â€œå®‰å…¨è¯­è¨€â€å…´èµ·ï¼Œäººä»¬æ­£åŠªåŠ›æ”¹é€ æ—¢æœ‰æŠ€æœ¯ä»¥åœ¨ Rust ä¸­å®ç°åŠ¨æ€æ£€æµ‹ã€‚ä½†æ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œ<strong>ä¸“ä¸º Rust è®¾è®¡</strong>ä¸”<strong>å¯ç§»æ¤</strong>çš„åŠ¨æ€å†…å­˜é”™è¯¯æ£€æµ‹å·¥å…·ï¼ˆå³ <strong>sanitizers</strong>ï¼‰ä»ç„¶ç¼ºä¹ã€‚</p><p>äº‹å®ä¸Šï¼ŒRust ç¤¾åŒºå·²ç»å¹¿æ³›é‡‡ç”¨ <strong>fuzzing</strong> æ¥æµ‹è¯• Rustï¼Œå¹¶æŠ¥å‘Šäº†å¤§é‡ Rust ç¨‹åºçš„å†…å­˜å®‰å…¨æ¼æ´ [1, 3, 13]ã€‚Rust ç¼–è¯‘å™¨é€šè¿‡ç¼–è¯‘é€‰é¡¹æ”¯æŒç”¨ <strong>AddressSanitizer (ASan)</strong> ä¸å…¶ä»– sanitizer ç¼–è¯‘ Rust ç¨‹åº [3]ã€‚ä¸å¹¸çš„æ˜¯ï¼Œç°æœ‰çš„åŠ¨æ€æµ‹è¯•å®è·µä¸åŸºç¡€è®¾æ–½æ˜¯ä»<strong>ä¸å®‰å…¨è¯­è¨€</strong>ï¼ˆå¦‚ C/C++ï¼‰æ²¿è¢­è€Œæ¥ï¼Œå¹¶<strong>æœªå……åˆ†è€ƒè™‘</strong> Rust å†…å­˜é”™è¯¯çš„ç‰¹æ®Šæ€§è´¨ã€‚</p><p>ASan [24, 47] ç”±äºå…¶è‰¯å¥½çš„<strong>æ£€æµ‹èƒ½åŠ›</strong>ä¸<strong>å¯ç§»æ¤æ€§</strong>ï¼Œå·²ç»æˆä¸ºåŠ¨æ€å†…å­˜é”™è¯¯æ£€æµ‹çš„äº‹å®æ ‡å‡†ã€‚ç„¶è€Œï¼Œå®ƒçš„<strong>è¿è¡Œæ—¶å¼€é”€</strong>ä¸<strong>å†…å­˜å¼€é”€</strong>ä¼—æ‰€å‘¨çŸ¥åœ°è¾ƒé«˜ã€‚æ—¢æœ‰ç ”ç©¶å°è¯•æ”¹è¿› ASan çš„è¿è¡Œæ—¶ä¸å†…å­˜è´Ÿæ‹… [27, 59, 60]ã€‚å…¶ä¸­ï¼Œä¼˜åŒ– sanitizer çš„<strong>å…ƒæ•°æ®</strong>å·²è¢«è¯æ˜èƒ½æ˜¾è‘—é™ä½åŒ…æ‹¬ ASan åœ¨å†…çš„è¿è¡Œæ—¶å¼€é”€ [27]ã€‚æ›´è¿‘çš„å·¥ä½œè¡¨æ˜ï¼š<strong>æ¶ˆé™¤</strong>å¼ºåŠ åœ¨å†…å­˜è®¿é—®ç‚¹ä¸Šçš„<strong>å†—ä½™</strong>sanitizer æ£€æŸ¥ï¼Œæ˜¯ä¼˜åŒ– ASan çš„ä¸€ä¸ªæœ‰å‰æ™¯æ–¹å‘ [59, 60]ã€‚</p><p>ASan ä¸å…¶ä»– sanitizers æ˜¯ä¸º C/C++ ç­‰<strong>ä¸å®‰å…¨è¯­è¨€</strong>è€Œè®¾è®¡çš„ï¼Œé»˜è®¤å‡å®š<strong>ç¨‹åºå„å¤„</strong>éƒ½å¯èƒ½å­˜åœ¨å†…å­˜é”™è¯¯ã€‚ç„¶è€Œï¼Œå³ä¾¿ä¸å…¶â€œä¸å®‰å…¨é‚»å±…â€æ¯”é‚»è€Œå±…ï¼ŒRust ç¨‹åºä¸­ä¾ç„¶æœ‰<strong>å¤§é‡ä»£ç </strong>ä¿æŒç€è¯­è¨€çº§çš„<strong>å®‰å…¨ä¿è¯</strong> [15, 31, 38]ã€‚è¿™æ„å‘³ç€ï¼šæˆ‘ä»¬æœ‰æœºä¼šåœ¨<strong>ä¸ç‰ºç‰²æ£€æµ‹èƒ½åŠ›</strong>çš„å‰æä¸‹ï¼Œæ˜¾è‘—å‡å°‘ ASan åœ¨ Rust ç¨‹åºä¸Šçš„è¿è¡Œæ—¶å¼€é”€ã€‚</p><hr><p>æˆ‘ä»¬æå‡º <strong>RustSan</strong>ï¼šä¸€ç§å¯¹ ASan çš„â€œæ”¹é€ å¼â€è®¾è®¡ï¼Œå……åˆ†åˆ©ç”¨ Rust ç¨‹åºçš„ç‹¬ç‰¹æ€§è´¨â€”â€”<strong>ç»å¤§å¤šæ•°å†…å­˜è®¿é—®</strong>ä»ç„¶éµå®ˆè¯­è¨€çš„<strong>å®‰å…¨ä¿è¯</strong>ã€‚RustSan èƒ½<strong>ç²¾ç¡®è¯†åˆ«</strong>å†…å­˜å¯¹è±¡ä¸å†…å­˜è®¿é—®ç‚¹çš„å®‰å…¨æ€§ï¼Œä»è€Œåœ¨<strong>å®‰å…¨çš„è®¿é—®ç‚¹</strong>ä¸Šæ¶ˆé™¤ä»£ä»·é«˜æ˜‚çš„è¿è¡Œæ—¶æ£€æŸ¥ã€‚</p><p>RustSan çš„<strong>è·¨ IR åˆ†æï¼ˆcross-IRï¼‰<strong>æ˜¯å…¶å…³é”®è®¾è®¡ä¹‹ä¸€ï¼šå®ƒåœ¨ Rust çš„</strong>é«˜é˜¶ IRï¼ˆHIRï¼‰<strong>ä¸</strong>ä¸­é˜¶ IRï¼ˆMIRï¼‰<strong>å±‚é¢å¼•å…¥ç»†ç²’åº¦åˆ†æã€‚æˆ‘ä»¬çš„å‘ç°æ˜¯ï¼šè¯¸å¦‚ <code>unsafe</code> ä¹‹ç±»çš„ Rust è¯­ä¹‰</strong>å¹¶ä¸ä¼š</strong>è¢«å……åˆ†ä¼ æ’­åˆ°åç«¯çš„ <strong>LLVM IR</strong> å±‚ã€‚è¿™è¦æ±‚æˆ‘ä»¬å‘å±•<strong>Rust ä¸“å±</strong>çš„åˆ†ææŠ€æœ¯ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œæ­£å¦‚æˆ‘ä»¬çš„åˆ†ææ‰€å±•ç¤ºçš„ï¼Œ<strong>ä»”ç»†å®¡è§†</strong> Rust çš„å¤šçº§ IR èƒ½æå‡ç²¾åº¦ï¼Œå¹¶å‡å°‘åç»­åˆ†æé˜¶æ®µçš„å¤æ‚æ€§ã€‚</p><p>åŸºäºä¸Šè¿°å®‰å…¨ä¿¡æ¯ï¼ŒRustSan åœ¨<strong>å½±å­å†…å­˜</strong>æ–¹æ¡ˆä¸Šæ‰©å±•äº† ASanï¼Œæ”¯æŒ<strong>é€‰æ‹©æ€§æ’æ¡©ï¼ˆselective instrumentationï¼‰<strong>ä¸</strong>éå‡åŒ€å†…å­˜è®¿é—®</strong>çš„æ ¡éªŒã€‚RustSan åœ¨<strong>å®‰å…¨ä½ç½®</strong>ç§»é™¤å½±å­å†…å­˜æ£€æŸ¥ï¼ŒåŒæ—¶å¯¹<strong>å…·æœ‰ä¸åŒå®‰å…¨çº§åˆ«</strong>çš„å†…å­˜è®¿é—®ç‚¹æ‰§è¡Œé€‚å½“çš„éªŒè¯ã€‚</p><p>æˆ‘ä»¬å¯¹ RustSan è¿›è¡Œäº†<strong>å¹¿æ³›è¯„ä¼°</strong>ï¼Œæ¶µç›–å…±è®¡ <strong>57</strong> ä¸ª Rust crateã€‚é€šè¿‡å¤ç° <strong>31</strong> ä¸ªç”± CVE æŠ«éœ²çš„å†…å­˜é”™è¯¯ï¼Œæˆ‘ä»¬éªŒè¯äº†ï¼šå³ä½¿ç§»é™¤äº†å¤§é‡<strong>å†—ä½™</strong>sanitizer æ£€æŸ¥ï¼ŒRustSan ä»<strong>ä¿æŒ</strong> ASan çš„æ£€æµ‹èƒ½åŠ›ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬åœ¨ <strong>18</strong> ä¸ªé€šç”¨ Rust ç¨‹åºçš„åŸºå‡†ä¸Šæµ‹é‡äº† RustSan çš„æ€§èƒ½ï¼šç›¸å¯¹ ASanï¼Œå¹³å‡<strong>æå‡ 62.3%</strong>ã€‚åœ¨<strong>æ¨¡ç³Šæµ‹è¯•</strong>åœºæ™¯ä¸­ï¼ŒRustSan çš„å¹³å‡æ€§èƒ½æå‡<strong>23.52%</strong>ï¼Œæœ€é«˜å¯è¾¾<strong>57.08%</strong>ã€‚</p><p><strong>æ€»ä¹‹ï¼Œæˆ‘ä»¬çš„è´¡çŒ®æ¦‚æ‹¬å¦‚ä¸‹ï¼š</strong></p><ul><li>æå‡ºä¸€ç§<strong>æ”¹é€ å¼ ASan è®¾è®¡</strong>ï¼šé€šè¿‡<strong>é€‰æ‹©æ€§æ’æ¡©</strong>æ˜¾è‘—é™ä½ Rust ç¨‹åºçš„è¿è¡Œæ—¶ sanitizer å¼€é”€ã€‚</li><li>èåˆ<strong>è·¨ IR çš„é™æ€åˆ†æ</strong>ï¼šç²¾ç¡®è¯†åˆ« Rust ä¸­çš„ <code>unsafe</code> ä»£ç å—åŠå…¶<strong>æ•°æ®æµä¼ æ’­</strong>ã€‚</li><li><strong>æ”¹é€ </strong> ASan çš„å½±å­å†…å­˜æ–¹æ¡ˆï¼šæ”¯æŒ<strong>é€‰æ‹©æ€§æ’æ¡©</strong>ï¼Œå¹¶ä¸º<strong>å®‰å…¨ Rust</strong>ä¸<strong>ä¸å®‰å…¨ Rust</strong>æä¾›<strong>éå‡åŒ€å†…å­˜æ ¡éªŒ</strong>æ¨¡å‹ã€‚</li><li>å¯¹ <strong>57</strong> ä¸ª Rust crate è¿›è¡Œ<strong>å…¨é¢è¯„ä¼°</strong>ï¼šéªŒè¯æ£€æµ‹èƒ½åŠ›ã€å¯æ‰©å±•æ€§ä¸æ€§èƒ½æ”¹è¿›ã€‚</li><li><strong>å¼€æºå‘å¸ƒ</strong> RustSanï¼Œå¸Œæœ›ä¿ƒè¿›ç¤¾åŒºé‡‡ç”¨ï¼Œä»è€Œé«˜æ•ˆå¼€å±• Rust ç¨‹åºçš„åŠ¨æ€æµ‹è¯•ã€‚</li></ul><h2 id="_2-èƒŒæ™¯-background" tabindex="-1"><a class="header-anchor" href="#_2-èƒŒæ™¯-background"><span>2. èƒŒæ™¯ï¼ˆBackgroundï¼‰</span></a></h2><p>æœ¬èŠ‚æˆ‘ä»¬ç®€è¦è¯´æ˜ç†è§£æœ¬æ–‡æ‰€éœ€çš„å…³é”®æ¦‚å¿µã€‚</p><h3 id="_2-1-addresssanitizer" tabindex="-1"><a class="header-anchor" href="#_2-1-addresssanitizer"><span>2.1 AddressSanitizer</span></a></h3><p>ASan [24, 47] æ˜¯ä¸€ç§é€šç”¨çš„å†…å­˜é”™è¯¯æ£€æµ‹å™¨ï¼Œå› å…¶ä¸ä¸»æµç¼–è¯‘å™¨è‰¯å¥½çš„å…¼å®¹æ€§ä¸å¯ç”¨æ€§è€Œè¢«å¹¿æ³›é‡‡ç”¨ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒASan åœ¨è®¸å¤šåŠ¨æ€æµ‹è¯•åœºæ™¯ï¼ˆåŒ…æ‹¬æ¨¡ç³Šæµ‹è¯• fuzzingï¼‰ä¸­ï¼Œå·²æˆä¸ºäº‹å®ä¸Šçš„æ ‡å‡†åŒ– <strong>sanitizer</strong> ç»„ä»¶ã€‚</p><p>ASan é€šè¿‡ç»´æŠ¤ä¸€ç‰‡<strong>å½±å­å†…å­˜</strong>ï¼ˆshadow memoryï¼‰æ¥è¡¨ç¤ºè¿›ç¨‹è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­å„å­—èŠ‚åœ°å€çš„æœ‰æ•ˆæ€§ï¼Œä»¥æ­¤æä¾›å†…å­˜å®‰å…¨ã€‚å½±å­å†…å­˜çš„æ¯ä¸ªå­—èŠ‚éƒ½å¯ä»¥ç¼–ç æˆæ‰€è°“çš„ <strong>redzone</strong> å€¼ï¼Œç”¨æ¥æŠŠç›¸åº”çš„å†…å­˜åœ°å€æ ‡è®°ä¸º<strong>ä¸å¯è®¿é—®</strong>ï¼ˆinvalidï¼‰ã€‚ASan åœ¨å½±å­å†…å­˜é‡Œç¼–ç äº†å¤šç§ redzone å€¼ï¼Œä»¥åŒºåˆ†ä¸åŒç±»å‹çš„é”™è¯¯ã€‚å½“æ£€æµ‹åˆ°ä¸€æ¬¡å¯¹å¸¦æœ‰<strong>éé›¶</strong>å½±å­å€¼ï¼ˆä¾‹å¦‚ <code>0xfd</code>ï¼‰çš„ redzone çš„éæ³•è®¿é—®æ—¶ï¼ŒASan ä¼šç”¨è¯¥ redzone å€¼å»ç´¢å¼•ä¸€ä¸ª<strong>é¢„å®šä¹‰è¡¨</strong>ï¼ˆåŒ…å«æ ¹å› ä¿¡æ¯ï¼‰ï¼Œå¹¶æ®æ­¤ç”ŸæˆæŠ¥å‘Šã€‚å‡¡æ˜¯ç”¨ ASan ç¼–è¯‘çš„ç¨‹åºä¸­å‡ºç°çš„<strong>æ‰€æœ‰å†…å­˜è®¿é—®æŒ‡ä»¤</strong>ï¼Œåœ¨æ‰§è¡Œä¹‹å‰éƒ½è¦é€šè¿‡æŸ¥è¯¢å½±å­å†…å­˜æ¥å®Œæˆæ ¡éªŒã€‚</p><p>ASan é€šè¿‡åœ¨å¯¹è±¡çš„<strong>å‰å</strong>æ’å…¥ redzones æ¥æ£€æµ‹å¯¹è±¡ä¸Šçš„<strong>ç©ºé—´ï¼ˆspatialï¼‰å†…å­˜å®‰å…¨</strong>è¿è§„ã€‚è¿™æ ·ï¼Œæ‰€æœ‰<strong>è¶Šç•Œè®¿é—®</strong>éƒ½ä¼šåœ¨ sanitizer æ£€æŸ¥é‡Œè¢«å‘ç°ï¼Œå› ä¸ºè¿™äº›æ£€æŸ¥ä¼šæŸ¥è¯¢å½±å­å†…å­˜ã€‚ASan è¿˜ä¼šåœ¨å †å¯¹è±¡ï¼ˆuse-after-freeï¼‰ä»¥åŠå¯é€‰çš„æ ˆå¯¹è±¡ä¸Šæ£€æµ‹<strong>æ—¶é—´ï¼ˆtemporalï¼‰å†…å­˜å®‰å…¨</strong>è¿è§„ã€‚é€šè¿‡ç”¨ redzones æ ‡è®°å¯¹è±¡çš„åœ°å€èŒƒå›´ï¼Œè¯¥å¯¹è±¡ä¼šåœ¨å½±å­å†…å­˜ä¸­è¢«<strong>ä½œåºŸ</strong>ï¼ˆinvalidatedï¼‰ã€‚ä¾‹å¦‚ï¼ŒASan ä¼šå¯¹<strong>æœ€è¿‘é‡Šæ”¾</strong>çš„ä¸€ç»„å †å¯¹è±¡ç»´æŒä¸€ç‰‡<strong>éš”ç¦»åŒº</strong>ï¼ˆquarantined setï¼‰ï¼Œæ–¹å¼æ˜¯åœ¨è¿™äº›å¯¹è±¡ä¸Šæ‰“ redzone æ ‡è®°ï¼Œä»¥æ•è·<strong>é‡Šæ”¾åä½¿ç”¨</strong>ï¼ˆuse-after-freeï¼‰ã€‚</p><h3 id="_2-2-rust-çš„å®‰å…¨æ¨¡å‹-rust-safety-model" tabindex="-1"><a class="header-anchor" href="#_2-2-rust-çš„å®‰å…¨æ¨¡å‹-rust-safety-model"><span>2.2 Rust çš„å®‰å…¨æ¨¡å‹ï¼ˆRust safety modelï¼‰</span></a></h3><p>Rust é€šè¿‡å…¶<strong>æ‰€æœ‰æƒï¼ˆownershipï¼‰<strong>æ¨¡å‹æ¥æä¾›å†…å­˜å®‰å…¨ã€‚åœ¨è¯¥æ¨¡å‹ä¸‹ï¼ŒRust ç¼–è¯‘å™¨åœ¨</strong>é™æ€</strong>å±‚é¢å¼ºåˆ¶æ¯ä¸ªå†…å­˜å¯¹è±¡<strong>æ°å¥½</strong>éš¶å±äº<strong>ä¸€ä¸ª</strong>æ‹¥æœ‰è€…å˜é‡ï¼ˆownerï¼‰ã€‚å½“æŸä¸ªå˜é‡ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œç¼–è¯‘å™¨ä¼š<strong>è‡ªåŠ¨æ’å…¥</strong>é‡Šæ”¾å…¶æ‰€æ‹¥æœ‰å†…å­˜å¯¹è±¡çš„ä»£ç ï¼Œä»è€Œè®©ç¨‹åºå‘˜æ‘†è„±æ˜¾å¼å†…å­˜ç®¡ç†çš„è´Ÿæ‹…ã€‚</p><p>ç„¶è€Œï¼Œè¿™æ ·çš„æ‰€æœ‰æƒæ¨¡å‹å¯¹ä¸€äº›é€šç”¨ç¨‹åºæ¥è¯´å¯èƒ½<strong>è¿‡äºä¸¥æ ¼</strong>ã€‚ä¸ºæ”¯æŒæ›´çµæ´»çš„ç¼–ç¨‹èŒƒå¼ï¼ŒRust è¿˜æ”¯æŒå¯¹å†…å­˜å¯¹è±¡è¿›è¡Œ<strong>å€Ÿç”¨ï¼ˆborrowingï¼‰</strong>ï¼Œä»¥ä¾¿åœ¨<strong>æ— æ‰€æœ‰æƒ</strong>çš„å‰æä¸‹è®¿é—®èµ„æºã€‚ä¸ºäº†å®‰å…¨åœ°å¯ç”¨å€Ÿç”¨ï¼ŒRust ä¸ºèµ„æºå…³è”<strong>ç”Ÿå‘½å‘¨æœŸï¼ˆlifetimeï¼‰</strong>ï¼Œå¹¶å¼•å…¥ <strong>å€Ÿç”¨æ£€æŸ¥å™¨ï¼ˆborrow checkerï¼‰</strong> ä»¥ä¿è¯è¢«å€Ÿç”¨çš„å¼•ç”¨ä¸ä¼šæ´»å¾—æ¯”å…¶åº•å±‚èµ„æºæ›´ä¹…ã€‚</p><p><strong>ä¸å®‰å…¨ Rust ä¸ Rust çš„å®‰å…¨ä¿è¯ã€‚</strong> Rust æä¾›äº†ä¸€ä¸ªä»¥ <code>unsafe</code> å…³é”®å­—æ ‡ç¤ºçš„<strong>ä¸å®‰å…¨å­è¯­è¨€</strong>ï¼Œç”¨äºåœ¨<strong>æš‚æ—¶</strong>ç»•è¿‡å…¶ä¸¥æ ¼çš„æ‰€æœ‰æƒæ¨¡å‹æ—¶ä½¿ç”¨ã€‚æ­£å¦‚æ—¢æœ‰ç ”ç©¶æ‰€æŠ¥é“çš„é‚£æ · [22]ï¼Œ<code>unsafe Rust</code> åœ¨å®è·µä¸­ç›¸å½“æ™®éï¼Œæˆ‘ä»¬çš„è¯„æµ‹å¯¹è±¡ä¸­ä¹Ÿèƒ½è§åˆ°è¿™ç§æƒ…å†µã€‚éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œ<code>unsafe</code> çš„<strong>ä¸å®‰å…¨æ€§å¹¶ä¸å±€é™</strong>äº <code>unsafe</code> ä»£ç å—çš„è¾¹ç•Œä¹‹å†…ï¼›äº‹å®ä¸Šï¼Œåœ¨ <code>unsafe</code> å—é‡Œå‘ç”Ÿäº¤äº’çš„å¯¹è±¡ä¼šæ²¿ç€<strong>æ•°æ®æµè·¯å¾„</strong>è¢«ä¼ æ’­åˆ°ä»£ç å—ä¹‹å¤–ï¼Œä»è€Œ<strong>å±åŠ</strong>åŸæœ¬å¯¹<strong>å®‰å…¨ Rust</strong>æ‰€ä½œçš„å®‰å…¨å‡è®¾ [15, 31, 38]ã€‚ä½äº <code>unsafe</code> å†…éƒ¨çš„<strong>è¢«ç ´åå¯¹è±¡</strong>å¯èƒ½ä¼šè¢«å®‰å…¨ Rust æ¶ˆè´¹ï¼Œå¹¶<strong>è¯±ä½¿</strong>å®‰å…¨ Rust äº§ç”Ÿå†…å­˜é”™è¯¯ã€‚å› æ­¤ï¼Œå³ä¾¿æŸäº›å†…å­˜è®¿é—®ç‚¹ä½äº<strong>å®‰å…¨ Rust</strong>ï¼ˆå³ä¸åœ¨ <code>unsafe</code> å—å†…ï¼‰ï¼Œå®ƒä»¬ä¹Ÿå¯èƒ½è¢«<strong>è½¬åŒ–ä¸ºä¸å®‰å…¨</strong>ã€‚</p><p><strong>åœ¨è¿è¡Œæ—¶éš”ç¦»ä¸å®‰å…¨ Rustã€‚</strong> æ—¢æœ‰å·¥ä½œæå‡ºäº†è¿è¡Œæ—¶éš”ç¦»æ–¹æ¡ˆï¼Œç”¨äºæŠŠå®‰å…¨ Rust ä» <code>unsafe</code> å¸¦æ¥çš„å†…å­˜ä¸å®‰å…¨ä¸­<strong>ä¿æŠ¤</strong>èµ·æ¥ [10, 15, 31, 33, 38, 45]ã€‚è¿™ä¸€ä»»åŠ¡ä¸ä»…è¦<strong>çº¦æŸ</strong> <code>unsafe</code> ä»£ç å—æœ¬èº«çš„æ“ä½œï¼Œè¿˜è¦å¤„ç†ç”±äº<strong>è¶Šç•Œä¼ æ’­çš„å—æŸå¯¹è±¡</strong>åœ¨å®‰å…¨ Rust ä¸­è¢«ä½¿ç”¨è€Œ<strong>å¯èƒ½å‘ç”Ÿçš„æ¼æ´</strong> [15, 38]ã€‚</p><h2 id="_3-rustsan-æ¦‚è§ˆ" tabindex="-1"><a class="header-anchor" href="#_3-rustsan-æ¦‚è§ˆ"><span>3. RUSTSAN æ¦‚è§ˆ</span></a></h2><p><strong>å›¾1</strong> å±•ç¤ºäº† <strong>RustSan</strong> çš„æ•´ä½“æ¡†æ¶ã€‚æœ¬æ–‡è¿™ä¸€èŠ‚å°†å…ˆä»‹ç»åç»­ç”¨äºæè¿° RustSan è®¾è®¡æ‰€éœ€çš„æ¦‚å¿µä¸æœ¯è¯­ï¼ˆè§ Â§3.1ï¼‰ï¼Œéšåç»™å‡º <strong>ç¼–è¯‘æœŸ</strong>ï¼ˆÂ§3.2ï¼‰ä¸ <strong>è¿è¡ŒæœŸ</strong>ï¼ˆÂ§3.3ï¼‰ä¸¤éƒ¨åˆ†æ“ä½œæµç¨‹çš„æ€»è§ˆã€‚</p><figure><img src="/assets/images/scholar/RustSan/figure1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_3-1-å®šä¹‰ä¸å†…å­˜æ ¡éªŒæ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#_3-1-å®šä¹‰ä¸å†…å­˜æ ¡éªŒæ¨¡å‹"><span>3.1 å®šä¹‰ä¸å†…å­˜æ ¡éªŒæ¨¡å‹</span></a></h3><p>æœ¬å°èŠ‚ä»‹ç»è´¯ç©¿å…¨æ–‡çš„æœ¯è¯­ä½“ç³»ï¼Œç”¨ä»¥æè¿° <strong>RustSan</strong> çš„è®¾è®¡ã€‚</p><p><strong>å¯¹è±¡ï¼ˆobjectsï¼‰ä¸è®¿é—®ç‚¹ï¼ˆaccess sitesï¼‰ã€‚</strong> RustSan åœ¨<strong>å½±å­å†…å­˜ï¼ˆshadow memoryï¼‰<strong>ä¸­ç»´æŠ¤</strong>å†…å­˜å¯¹è±¡</strong>çš„æœ‰æ•ˆæ€§çŠ¶æ€ã€‚ç¨‹åºä¸­çš„å†…å­˜è®¿é—®æŒ‡ä»¤ï¼ˆå³ <em>load</em> ä¸ <em>store</em>ï¼‰ä¼šè¢«æ’æ¡©ï¼Œåœ¨æ‰§è¡Œå‰æŸ¥è¯¢å½±å­å†…å­˜ä»¥è¿›è¡Œæœ‰æ•ˆæ€§æ ¡éªŒã€‚æˆ‘ä»¬å°†è¿™äº›æ’æ¡©æŒ‡ä»¤ç»Ÿç§°ä¸º<strong>è®¿é—®ç‚¹</strong>ï¼ˆ<em>access sites</em>ï¼Œç®€ç§° <strong>sites</strong>ï¼‰ã€‚</p><p><strong>å¯¹è±¡çš„å®‰å…¨æ€§ã€‚</strong> æˆ‘ä»¬ä¸æ—¢æœ‰å·¥ä½œ [15, 38] ä¸€æ ·ï¼ŒåŒºåˆ†<strong>å®‰å…¨å¯¹è±¡</strong>ä¸<strong>ä¸å®‰å…¨å¯¹è±¡</strong>ï¼šå½“æŸä¸ªå¯¹è±¡åœ¨ <code>unsafe</code> ä»£ç å—å†…è¢«<strong>ä¿®æ”¹</strong>æ—¶ï¼Œå®ƒä¼šæˆä¸º<strong>ä¸å®‰å…¨ä¼ æ’­çš„æºï¼ˆsourceï¼‰</strong>ã€‚æ‰€æœ‰ç»ç”±è¯¥ä¸å®‰å…¨æºæ²¿<strong>æ•°æ®æµ</strong>å—åˆ°å½±å“çš„å¯¹è±¡ï¼Œå‡è¢«è§†ä¸º<strong>ä¸å®‰å…¨å¯¹è±¡</strong>ã€‚<strong>å®‰å…¨å¯¹è±¡</strong>å«ä¹‰ä¸è¨€è‡ªæ˜â€”â€”å‡¡<strong>éä¸å®‰å…¨</strong>è€…çš†ä¸ºå®‰å…¨å¯¹è±¡ã€‚RustSan è¿˜å®šä¹‰äº†å¦ä¸€ç±»ä¸å¯¹è±¡å®‰å…¨æ€§ç›¸å…³çš„æ¦‚å¿µï¼Œç§°ä¸º<strong>é‡å å¯¹è±¡ï¼ˆoverlapping objectsï¼‰</strong>ã€‚åœ¨ä»‹ç»å…¶ä»–ç›¸å…³æ¦‚å¿µä¹‹åï¼Œæˆ‘ä»¬ä¼šå†å›åˆ°è¿™ä¸€æ¦‚å¿µã€‚</p><p><strong>è®¿é—®ç‚¹çš„å®‰å…¨æ€§ã€‚</strong> è®¿é—®ç‚¹æ˜¯å¦å®‰å…¨ç”±å…¶<strong>å¯èƒ½è®¿é—®åˆ°çš„å¯¹è±¡</strong>å†³å®šã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œ<strong>å®‰å…¨è®¿é—®ç‚¹</strong>æŒ‰å®šä¹‰åº”å½“åœ¨<strong>ä»»ä½•æ§åˆ¶æµè·¯å¾„</strong>ä¸‹éƒ½<strong>åªèƒ½</strong>è®¿é—®åˆ°<strong>å®‰å…¨å¯¹è±¡</strong>ã€‚<strong>ä¸å®‰å…¨è®¿é—®ç‚¹</strong>æ˜¯æŒ‡<strong>ä½äº <code>unsafe</code> ä»£ç å—å†…éƒ¨</strong>çš„è®¿é—®ç‚¹ã€‚æˆ‘ä»¬ç”¨æœ¯è¯­ <strong>ä¼ªå®‰å…¨è®¿é—®ç‚¹ï¼ˆfalse-safe siteï¼‰</strong> è¡¨ç¤º<strong>ä½äºå®‰å…¨ Rust ä¸­ã€ä½†å¯èƒ½ä¼šè®¿é—®åˆ°ä¸å®‰å…¨å¯¹è±¡</strong>çš„é‚£äº›è®¿é—®ç‚¹ã€‚æ›´å…·ä½“åœ°è¯´ï¼Œè‹¥æŸè®¿é—®ç‚¹<strong>ä¸åœ¨</strong> <code>unsafe</code> ä»£ç å—å†…ï¼Œä½†<strong>åœ¨è¿è¡Œæ—¶å¯èƒ½è®¿é—®åˆ°ä¸å®‰å…¨å¯¹è±¡</strong>ï¼Œåˆ™å®ƒæ˜¯ä¼ªå®‰å…¨çš„ã€‚</p><p><strong>é‡å å¯¹è±¡ï¼ˆoverlapping objectsï¼‰ã€‚</strong> å¯å€ŸåŠ© <strong>points-to</strong> å…³ç³» [11] æ¥è§£é‡Šã€‚å½“ä¸€ä¸ª<strong>ä¼ªå®‰å…¨è®¿é—®ç‚¹</strong>åœ¨è¿è¡Œæ—¶<strong>æ—¢å¯èƒ½</strong>è®¿é—®åˆ°å®‰å…¨å¯¹è±¡<strong>åˆå¯èƒ½</strong>è®¿é—®åˆ°ä¸å®‰å…¨å¯¹è±¡æ—¶ï¼Œå‡¡<strong>å¯èƒ½è¢«è¯¥è®¿é—®ç‚¹æŒ‡å‘</strong>çš„æ‰€æœ‰å¯¹è±¡æ„æˆå…¶ <strong>may-point-to</strong> é›†åˆã€‚æˆ‘ä»¬å°†<strong>å±äºè¯¥ may-point-to é›†åˆä¸­çš„å®‰å…¨å¯¹è±¡</strong>å®šä¹‰ä¸º<strong>é‡å å¯¹è±¡</strong>ï¼ˆå®ƒä»¬ä¸ä¸å®‰å…¨å¯¹è±¡åŒå±ä¸€ä¸ª may-point-to é›†ï¼‰ã€‚è¿™ç§å¯¹è±¡å®‰å…¨æ€§çš„åˆ’åˆ†åœ¨ RustSan çš„<strong>å†…å­˜æ ¡éªŒæ¨¡å‹</strong>ä¸å…¶<strong>å½±å­å†…å­˜æ–¹æ¡ˆ</strong>ä¸­å…·æœ‰é‡è¦æ„ä¹‰ï¼›åœ¨åæ–‡å±•å¼€ç¨‹åºåˆ†ææ—¶æˆ‘ä»¬è¿˜ä¼šå†æ¬¡è®¨è®ºå®ƒã€‚</p><p><strong>è®¿é—®ç‚¹çš„å†…å­˜æ ¡éªŒæ¨¡å‹ã€‚</strong> åœ¨<strong>ç§»é™¤å®‰å…¨è®¿é—®ç‚¹</strong>ä¸Šçš„ sanitizer æ£€æŸ¥çš„åŒæ—¶ï¼ŒRustSan ä¼šå¯¹<strong>å‰©ä½™çš„</strong>ä¸å®‰å…¨ä¸ä¼ªå®‰å…¨<strong>å†…å­˜è®¿é—®ç‚¹</strong>å®æ–½<strong>åˆ†ç¦»çš„è®¿é—®æ ¡éªŒ</strong>ï¼›è¿™äº›æ ¡éªŒä¸ ASan åŸºäº redzone çš„<strong>è¶Šç•Œ</strong>é”™è¯¯æ£€æŸ¥<strong>å¹¶è¡Œå­˜åœ¨</strong>ã€‚RustSan ä¼šæ£€æµ‹<strong>æ¥è‡ªä¸å®‰å…¨è®¿é—®ç‚¹</strong>å¯¹<strong>å®‰å…¨å¯¹è±¡</strong>çš„<strong>ä¸€åˆ‡è®¿é—®</strong>â€”â€”æ³¨æ„ï¼ŒæŒ‰å®šä¹‰ä¸”ç»ç¦»çº¿åˆ†æè¯†åˆ«ï¼Œ<strong>å®‰å…¨å¯¹è±¡æœ¬ä¸åº”ä»ä¸å®‰å…¨è®¿é—®ç‚¹å¯è¾¾</strong>ã€‚å¯¹äº<strong>ä¼ªå®‰å…¨è®¿é—®ç‚¹</strong>ï¼ŒRustSan <strong>åªå…è®¸</strong>è®¿é—®ä¸¤ç±»å¯¹è±¡ï¼š1ï¼‰<strong>é‡å å¯¹è±¡</strong>ï¼ˆå®‰å…¨å¯¹è±¡çš„ä¸€ä¸ªå­é›†ï¼‰ï¼Œä»¥åŠ 2ï¼‰<strong>ä¸å®‰å…¨å¯¹è±¡</strong>ã€‚</p><p><strong><code>unsafe</code> å…³é”®å­— ä¸ â€œunsafeâ€ã€‚</strong> åœ¨é˜æ˜äº†è®¿é—®ç‚¹ä¸å¯¹è±¡çš„ï¼ˆä¸ï¼‰å®‰å…¨æ€§ä¹‹åï¼Œæˆ‘ä»¬å†å¼ºè°ƒæœ¬æ–‡æœ¯è¯­ä¸­çš„åŒºåˆ†ï¼šå½“æˆ‘ä»¬æŒ‡ <strong>Rust</strong> çš„å…³é”®å­— <code>unsafe</code> æ—¶ï¼Œå§‹ç»ˆå†™ä½œ <strong><code>unsafe</code></strong>ï¼ˆåŠ ç²—å¹¶æ‰“å­—æœºä½“ï¼‰ï¼›è€Œ <strong>â€œunsafeâ€</strong>ï¼ˆä¸åŠ ä»£ç ä½“ï¼‰ä¸€è¯ç”¨äº<strong>ä¸€èˆ¬æ„ä¹‰</strong>ï¼ŒæŒ‡<strong>å¯èƒ½è¢«ç ´å</strong>ã€å¹¶ä¸”<strong>åœ¨ä»»æ„è®¿é—®ç‚¹éƒ½å¯èƒ½è¢«è®¿é—®</strong>çš„å¯¹è±¡ã€‚</p><h3 id="_3-2-è·¨-ir-åˆ†æ-cross-ir-analysis" tabindex="-1"><a class="header-anchor" href="#_3-2-è·¨-ir-åˆ†æ-cross-ir-analysis"><span>3.2 è·¨ IR åˆ†æï¼ˆCross-IR analysisï¼‰</span></a></h3><p>RustSan çš„ç¬¬ä¸€é¡¹ä»»åŠ¡ï¼Œæ˜¯ä¾æ®å‰è¿°å®šä¹‰ä¸º<strong>å¯¹è±¡</strong>ä¸<strong>è®¿é—®ç‚¹</strong>åˆ’åˆ†å®‰å…¨æ€§ã€‚ä¸ºæ­¤ï¼ŒRustSan å®ç°äº†ä¸€ä¸ª<strong>ç»†ç²’åº¦åˆ†æ</strong>ï¼Œä»¥æå–<strong>ä»…å­˜åœ¨äº Rust IRï¼ˆHIR ä¸ MIRï¼‰<strong>ä¸­çš„ä¿¡æ¯ã€‚å…¶ä¸­ä¹‹ä¸€æ˜¯ï¼šä½äº <code>unsafe</code> å—ä¸­çš„</strong>ä¼šä¿®æ”¹å†…å­˜çš„è¯­å¥</strong>ã€‚è¿™äº›è¯­å¥åœ¨åç»­çš„ LLVM IR åˆ†æä¸­ï¼Œä¼šè¢«ä½œä¸º<strong>ä¸å®‰å…¨æ€§çš„æºï¼ˆsourceï¼‰</strong>ï¼Œç”¨äºåˆ¤å®šå¯¹è±¡ä¸è®¿é—®ç‚¹çš„å®‰å…¨æ€§ï¼ˆå›¾ 1 ä¸­çš„ <strong>â‘ </strong>ï¼‰ã€‚å‘ LLVM IR é˜¶æ®µæä¾›è¶Š<strong>ç»†ç²’åº¦</strong>çš„ä¿¡æ¯ï¼Œå¯ä½¿è¯¥é˜¶æ®µçš„åˆ†ææ›´åŠ é«˜æ•ˆã€‚ä¸‹ä¸€ç±»å…³é”®ä¿¡æ¯æ˜¯ï¼š<strong>Rust ç‰¹æœ‰çš„åˆ†é…å‡½æ•°</strong>ï¼›æˆ‘ä»¬çš„ LLVM IR åˆ†æéœ€è¦è¯†åˆ«å®ƒä»¬ï¼Œæ‰èƒ½<strong>å¯é è¿½è¸ªå †åˆ†é…ç‚¹</strong>ï¼ˆ<strong>â‘¡</strong>ï¼‰ã€‚</p><p>æ›´å…·è±¡çš„åˆ†æä¸æ’æ¡©å‘ç”Ÿåœ¨<strong>LLVM IR ç¼–è¯‘é˜¶æ®µ</strong>ã€‚åœ¨ LLVM ä¸­ï¼ŒRustSan é‡‡ç”¨ä¾èµ– <strong>Value-Flow Graph</strong> [50] çš„ <strong>points-to åˆ†æ</strong> [11]ï¼Œä»¥<strong>è¿­ä»£åœ°</strong>ç¡®å®šå¯¹è±¡ä¸è®¿é—®ç‚¹çš„å®‰å…¨æ€§ï¼›å…¶èµ·ç‚¹æ˜¯å‰ä¸€é˜¶æ®µ MIR/HIR åˆ†æä¸­æç‚¼å‡ºçš„<strong>æºï¼ˆsourcesï¼‰</strong>ï¼ˆ<strong>â‘¢</strong>ï¼‰ã€‚åŒæ—¶ï¼ŒRustSan è¿˜é€šè¿‡<strong>åˆ†é…ç‚¹è¯†åˆ«æ–¹æ¡ˆ</strong>è·Ÿè¸ª Rust çš„åˆ†é…ä½ç½®ï¼Œä½¿å…¶åœ¨æ’æ¡©ä¸­èƒ½å¤Ÿ<strong>å¯é åœ°é‡è½½å †å¯¹è±¡çš„åˆ†é…</strong>ï¼ˆ<strong>â‘£</strong>ï¼‰ã€‚</p><hr><h3 id="_3-3-rustsan-çš„å½±å­å†…å­˜æ–¹æ¡ˆ-rustsan-shadow-memory-scheme" tabindex="-1"><a class="header-anchor" href="#_3-3-rustsan-çš„å½±å­å†…å­˜æ–¹æ¡ˆ-rustsan-shadow-memory-scheme"><span>3.3 RustSan çš„å½±å­å†…å­˜æ–¹æ¡ˆï¼ˆRustSan shadow memory schemeï¼‰</span></a></h3><p>ç¼–è¯‘æœŸåˆ†æå¾—åˆ°çš„ä¿¡æ¯ä¸èƒ½åŠ›ï¼Œéšåä¼šåœ¨ RustSan çš„<strong>å½±å­å†…å­˜æ–¹æ¡ˆ</strong>ä¸­è¢«ç‰©åŒ–ä¸º<strong>å½±å­å†…å­˜ç®¡ç†</strong>ä¸<strong>æ’æ¡©</strong>ã€‚RustSan å°†å…¶<strong>éå‡åŒ€è®¿é—®æ ¡éªŒæ¨¡å‹</strong>æ”¹é€ å¹¶åµŒå…¥ ASan çš„å½±å­å†…å­˜æœºåˆ¶ä¹‹ä¸­ï¼Œä»è€Œä¸ºè¢«åˆ†ç±»ä¸º<strong>å®‰å…¨</strong>ã€<strong>ä¸å®‰å…¨</strong>ä¸<strong>ä¼ªå®‰å…¨</strong>çš„è®¿é—®ç‚¹ï¼Œå¼ºåˆ¶æ‰§è¡Œ<strong>ä¸åŒçš„å†…å­˜è§†å›¾ï¼ˆmemory viewsï¼‰</strong>ã€‚</p><p>RustSan é¦–å…ˆå¼•å…¥ä¸€ç§<strong>åˆ†é…å™¨é‡è½½ï¼ˆallocator overridingï¼‰<strong>æ–¹æ¡ˆï¼šåœ¨å½±å­å†…å­˜ä¸­å¯¹</strong>å®‰å…¨å¯¹è±¡</strong>ä¸<strong>ä¸å®‰å…¨/é‡å å¯¹è±¡</strong>è¿›è¡Œä¸Šè‰²ï¼ˆcoloringï¼‰ã€‚åšæ³•æ˜¯ï¼šå°†<strong>ä¸å®‰å…¨å¯¹è±¡</strong>ä¸<strong>é‡å å¯¹è±¡</strong>çš„<strong>å †å†…å­˜åˆ†é…ç‚¹</strong>æ›¿æ¢ä¸º RustSan çš„<strong>åˆ†é…å™¨å°è£…ï¼ˆallocator wrappersï¼‰</strong>ï¼ˆå›¾ 1 çš„ <strong>â‘¤</strong>ï¼‰ã€‚</p><p>éšåï¼ŒRustSan åŸºäºå…¶è·¨ IR åˆ†æå¾—åˆ°çš„<strong>è®¿é—®ç‚¹å®‰å…¨ä¿¡æ¯</strong>ï¼Œ<strong>æ‰©å±•</strong>äº† ASan çš„æ’æ¡©æ–¹æ¡ˆï¼šå¯¹è¢«åˆ¤å®šä¸º<strong>å®‰å…¨</strong>çš„å†…å­˜è®¿é—®ç‚¹<strong>ç§»é™¤ ASan æ’æ¡©</strong>ï¼›è€Œå¯¹<strong>ä¸å®‰å…¨</strong>ä¸<strong>ä¼ªå®‰å…¨</strong>çš„è®¿é—®ç‚¹ï¼Œåˆ™<strong>æ’æ¡©</strong>ä»¥åœ¨è®¿é—®å‰æŸ¥è¯¢å½±å­å†…å­˜ï¼Œè·å–è¢«è®¿é—®å¯¹è±¡çš„å®‰å…¨æ€§ï¼Œä»è€Œè½å®å…¶<strong>æ„ŸçŸ¥å®‰å…¨æ€§çš„å†…å­˜æ ¡éªŒæ¨¡å‹</strong>ï¼ˆ<strong>â‘¥</strong>ï¼‰ã€‚</p><h2 id="_4-è·¨-ir-rust-çš„-hir-mir-åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_4-è·¨-ir-rust-çš„-hir-mir-åˆ†æ"><span>4. è·¨ IRï¼šRust çš„ HIR/MIR åˆ†æ</span></a></h2><p><strong>RustSan</strong> åœ¨ Rust çš„ <strong>HIR/MIR</strong> å±‚å®ç°äº†ç»†ç²’åº¦åˆ†æï¼Œä½¿å¯¹ Rust ç‰¹æœ‰ä¿¡æ¯çš„åˆ†ææ›´åŠ <strong>å‡†ç¡®</strong>ä¸”<strong>é«˜æ•ˆ</strong>ã€‚å·²æœ‰å·¥ä½œ [15, 38] ä¹Ÿä½¿ç”¨äº† MIRï¼Œä½†å®ƒä»¬å¤§å¤šä»…å°† <strong><code>unsafe</code> å—å†…çš„æ‰€æœ‰è¯­å¥</strong>ç»Ÿä¸€æ‰“æ ‡å¹¶ä¸€è·¯ä¼ æ’­åˆ° <strong>LLVM IR</strong>ã€‚æˆ‘ä»¬çš„å‘ç°æ˜¯ï¼šRust çš„ <code>unsafe</code> è¯­ä¹‰<strong>å¹¶ä¸èƒ½</strong>å¾ˆå¥½åœ°ä¼ æ’­åˆ° LLVM IRã€‚<code>unsafe</code> æ˜¯ä¸€ç§ä¾› <strong>HIR/MIR</strong> ç¼–è¯‘é˜¶æ®µæ¶ˆè´¹çš„è¯­è¨€è¯­ä¹‰ï¼Œæœ€ç»ˆç”Ÿæˆçš„ LLVM IR <strong>å¹¶ä¸æºå¸¦</strong>è¿™ç±»ä¿¡æ¯ï¼›åŒæ—¶ï¼Œä¸ <code>unsafe</code> HIR è¯­å¥ç›¸å¯¹åº”çš„ LLVM IR æŒ‡ä»¤åœ¨å¤šè½®å˜æ¢å<strong>éš¾ä»¥åŒºåˆ†</strong>ã€‚æ­¤å¤–ï¼Œè‹¥åœ¨ HIR/MIR å±‚è¿›è¡Œ<strong>é¢„åˆ†æ</strong>ï¼ŒæŸäº›åˆ†æè¿˜èƒ½å˜å¾—æ›´é«˜æ•ˆã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬åœ¨ HIR/MIR å±‚å¿…é¡»è¯†åˆ«å¦‚ä¸‹å››ç±»<strong>å…³é”®ä¿¡æ¯</strong>ï¼ˆinformationï¼‰ï¼š</p><ul><li><strong>I1</strong>ï¼š<code>unsafe</code> å—ä¸­çš„<strong>å†…å­˜è®¿é—®è¯­å¥</strong></li><li><strong>I2</strong>ï¼š<code>unsafe</code> å—ä¸­çš„<strong>å†…å­˜ä¿®æ”¹è¯­å¥</strong></li><li><strong>I3</strong>ï¼š<strong>åˆ†é…å †å†…å­˜</strong>çš„ Rust å‡½æ•°</li><li><strong>I4</strong>ï¼š<strong>å¯èƒ½</strong>åˆ†é…å †å†…å­˜çš„ Rust ç‰¹æœ‰æ–¹æ³•</li></ul><p>è‹¥ä¸åœ¨æ­¤é˜¶æ®µæ”¶é›†ï¼Œä¸Šè¿°ä¿¡æ¯åœ¨åç»­çš„ç¿»è¯‘æˆ–ç¼–è¯‘ä¸­<strong>å¯èƒ½ä¸¢å¤±</strong>ï¼Œä¹Ÿä¼šè®©åç»­é˜¶æ®µçš„åˆ†ææ›´åŠ å¤æ‚ã€‚<strong>I1</strong> å°†ç”¨äº<strong>è®¿é—®ç‚¹å®‰å…¨æ€§åˆ†ç±»</strong>æ—¶å®šä½å†…å­˜è®¿é—®ç‚¹ï¼Œå¹¶æœ€ç»ˆç”¨äºåœ¨ RustSan çš„å½±å­å†…å­˜æ–¹æ¡ˆä¸­å®æ–½<strong>é€‰æ‹©æ€§æ’æ¡©</strong>ï¼ˆè§ Â§3.1ï¼‰ã€‚<strong>I2</strong> æ˜¯<strong>ä¸å®‰å…¨å¯¹è±¡çš„â€œå‡ºç”Ÿåœ°â€</strong>ï¼šå‡¡åœ¨ <code>unsafe</code> ä¸­è‡³å°‘è¢«ä¿®æ”¹è¿‡ä¸€æ¬¡çš„å¯¹è±¡ï¼Œéƒ½è¢«è§†ä½œä¸å®‰å…¨ï¼Œè¿™äº›è¯­å¥ä¹Ÿå°±æ„æˆäº†<strong>ä¸å®‰å…¨ä¼ æ’­çš„æº</strong>ã€‚å› æ­¤ï¼Œå¯¹<strong>å†…å­˜ä¿®æ”¹è¯­å¥</strong>ä¸å…¶è¶…é›†ï¼ˆ<strong>I1</strong>ï¼‰åšç²¾ç»†åŒºåˆ†ï¼Œèƒ½å¤Ÿå‡å°‘å¯¹å¯¹è±¡<strong>è¿‡åº¦ç€è‰²</strong>ï¼ˆovertaintingï¼‰ã€‚<strong>I3</strong> ä¸ <strong>I4</strong> åˆ™æ˜¯åç»­ LLVM åˆ†æ<strong>å‡†ç¡®è¯†åˆ«å †åˆ†é…ç‚¹</strong>æ‰€å¿…éœ€çš„ä¿¡æ¯ã€‚</p><p>åœ¨æå–è¿™äº›ä¿¡æ¯çš„è¿‡ç¨‹ä¸­ï¼ŒRustSan çš„ HIR/MIR åˆ†æå™¨å¼•å…¥äº†ä¸‰é¡¹æ–°æŠ€æœ¯ï¼š</p><ol><li><strong>è¯­å¥çº§å†…å­˜è®¿é—®è·Ÿè¸ª</strong>ï¼ˆStatement-level memory accesses trackingï¼‰ï¼Œ</li><li><strong>é€’å½’å®‰å…¨ä½œç”¨åŸŸåˆ†æ</strong>ï¼ˆRecursive safety scope analysisï¼‰ï¼Œ</li><li><strong>åˆ†é…å‡½æ•°è¯†åˆ«</strong>ï¼ˆAllocation function identificationï¼‰ã€‚</li></ol><p>ä¸‹é¢è¯¦ç»†è¯´æ˜ RustSan çš„åˆ†ææµç¨‹ã€‚</p><hr><h3 id="_4-1-èƒŒæ™¯-rust-çš„-hir-mir" tabindex="-1"><a class="header-anchor" href="#_4-1-èƒŒæ™¯-rust-çš„-hir-mir"><span>4.1 èƒŒæ™¯ï¼šRust çš„ HIR/MIR</span></a></h3><p>Rust å‰ç«¯ç¼–è¯‘å™¨ <strong>rustc</strong> åœ¨å†…éƒ¨ä½¿ç”¨ä¸¤ç§ IRï¼š<strong>HIR</strong> ä¸ <strong>MIR</strong>ã€‚<code>unsafe</code> å—<strong>åªèƒ½</strong>åœ¨ <strong>HIR</strong> å±‚è¢«è¯†åˆ«ï¼›ä¸€æ—¦ä»£ç è¢«ç¿»è¯‘åˆ° MIRï¼Œ<code>unsafe</code> çš„è¾¹ç•Œå°±<strong>ä¸å¯è§</strong>ã€‚å› æ­¤ï¼ŒRustSan ä½¿ç”¨ <strong>HIR</strong> æ¥æå–ä¸ <code>unsafe</code> å—ç›¸å…³çš„ä¿¡æ¯ï¼›è€Œåœ¨æ›´ç»†ç²’åº¦çš„<strong>è¯­å¥çº§åˆ†æ</strong>ä¸Šï¼Œåˆ™ä½¿ç”¨å¯¹åˆ†ææ›´å‹å¥½çš„ <strong>MIR</strong>ã€‚å¦å¤–ï¼ŒMIR ä¸ HIR ä¹‹é—´å­˜åœ¨<strong>ä¸€ä¸€æ˜ å°„</strong>ï¼Œä»è€Œå…è®¸æˆ‘ä»¬åœ¨åˆ†æ MIR è¯­å¥æ—¶<strong>å›æŸ¥</strong>å…¶å¯¹åº”çš„ HIR ä»¥è·å– HIR ä¸“å±ä¿¡æ¯ã€‚</p><hr><h3 id="_4-2-è¯­å¥çº§å†…å­˜è®¿é—®è·Ÿè¸ª-statement-level-memory-access-tracking" tabindex="-1"><a class="header-anchor" href="#_4-2-è¯­å¥çº§å†…å­˜è®¿é—®è·Ÿè¸ª-statement-level-memory-access-tracking"><span>4.2 è¯­å¥çº§å†…å­˜è®¿é—®è·Ÿè¸ªï¼ˆStatement-level memory access trackingï¼‰</span></a></h3><p>RustSan å®ç°äº†<strong>è¯­å¥çº§åˆ†æ</strong>æ¥ç²¾ç¡®è·Ÿè¸ªå†…å­˜è®¿é—®è¯­å¥ï¼ˆ<strong>I1</strong>ï¼‰ï¼Œå¹¶ä»ä¸­è¿›ä¸€æ­¥æç‚¼å‡º<strong>å†™å…¥è¯­å¥</strong>ï¼ˆ<strong>I2</strong>ï¼‰ã€‚è‹¥å¯¹ <strong>I2</strong> é‡‡ç”¨è¿‡åº¦ä¿å®ˆçš„è¿‘ä¼¼ï¼Œå°±ä¼šåœ¨ LLVM IR é˜¶æ®µ<strong>äººä¸ºæ‰©å¤§</strong>ä¸å¿…è¦çš„ä¸å®‰å…¨å¯¹è±¡é›†åˆï¼Œå¹¶ä»¥<strong>çº§è”æ–¹å¼</strong>å¢åŠ ä¸å®‰å…¨ä¸ä¼ªå®‰å…¨è®¿é—®ç‚¹çš„æ•°é‡ã€‚å› æ­¤ï¼Œå³ä¾¿èƒ½å‡å°‘å¾ˆå°ä¸€éƒ¨åˆ† <strong>I2</strong>ï¼Œå¯¹ RustSan çš„æ€§èƒ½æ”¶ç›Šä¹Ÿ<strong>è‡³å…³é‡è¦</strong>â€”â€”å…¶æ¥æºæ­£æ˜¯<strong>ç§»é™¤äº†å®‰å…¨è®¿é—®ç‚¹ä¸Šçš„æ£€æŸ¥</strong>ã€‚</p><p><strong>åŒºåˆ†å†™å…¥è¯­å¥ã€‚</strong> æˆ‘ä»¬é€šè¿‡åˆ†æ <strong>MIR</strong> è¯­æ³•åœ¨ <strong>I1</strong> ä¸­å°†<strong>å†™å…¥</strong>ä¸<strong>è¯»å–</strong>åŒºåˆ†å¼€æ¥ã€‚æˆ‘ä»¬ç³»ç»Ÿæ¢³ç†äº† Rust MIR ä¸­<strong>æ‰€æœ‰å¯èƒ½çš„â€œå†™å†…å­˜â€è¯­å¥å½¢å¼</strong>ï¼Œä»è€Œæ„å»ºå‡º <strong>I2</strong>ï¼ˆæ˜¯ <strong>I1</strong> çš„ä¸€ä¸ª<strong>å­é›†</strong>ï¼‰ã€‚æ³¨æ„ï¼šè™½ç„¶æˆ‘ä»¬åªè·Ÿè¸ª <code>unsafe</code> ä¸­çš„<strong>å†™è¯­å¥</strong>ï¼ˆå› ä¸ºå®ƒä»¬æ˜¯ä¸å®‰å…¨å¯¹è±¡çš„<strong>æ¥æº</strong>ï¼‰ï¼Œä½†å¯¹ç”±æ­¤äº§ç”Ÿçš„ä¸å®‰å…¨å¯¹è±¡è¿›è¡Œ sanitizer æ£€æŸ¥æ—¶ï¼Œ<strong>è¯»å†™</strong>éƒ½ä¼šè¢«æ£€æµ‹åˆ°ã€‚</p><p><strong>å‰”é™¤ä¸¥æ ¼å±€éƒ¨å†™å…¥ã€‚</strong> è¯­å¥çº§åˆ†æè¿˜å…è®¸è¿›ä¸€æ­¥ç¼©å‡ <strong>I2</strong>ã€‚RustSan ä½¿ç”¨ <strong>MIR æ•°æ®æµåˆ†æ</strong>æ¥æ‰¾å‡ºä¿®æ”¹<strong>ä¸¥æ ¼å±€éƒ¨ï¼ˆstrictly-localï¼‰å˜é‡</strong>çš„è¯­å¥ï¼šè¿™ç±»å˜é‡ä»å…¶å½“å‰ä¸å®‰å…¨ä½œç”¨åŸŸ<strong>æ²¡æœ‰</strong>å‘å¤–çš„æ•°æ®æµè¾¹ï¼Œå› æ­¤å¯ä»¥<strong>å®‰å…¨å‰”é™¤</strong>ï¼Œå› ä¸ºå®ƒä»¬ä¸ä¼šæ±¡æŸ“ä»»ä½•å®‰å…¨å˜é‡ã€‚å¯¹äº<strong>ä¿®æ”¹äº†ä¸¥æ ¼å±€éƒ¨å˜é‡</strong>çš„è¯­å¥ï¼ŒRustSan å°†è¯¥å±€éƒ¨å˜é‡çš„<strong>æ ˆåˆ†é…</strong>æ ‡è®°ä¸ºâ€œåˆ†é…äº†ä¸€ä¸ªä¸å®‰å…¨å¯¹è±¡â€ï¼Œå¹¶ä» <strong>I2</strong> ä¸­ç§»é™¤å¯¹åº”å†™è¯­å¥ï¼Œä»¥<strong>å‡è½»</strong>åç»­ LLVM IR åˆ†æçš„è´Ÿæ‹…ã€‚</p><hr><h3 id="_4-3-é€’å½’å®‰å…¨ä½œç”¨åŸŸåˆ†æ-recursive-safety-scope-analysis" tabindex="-1"><a class="header-anchor" href="#_4-3-é€’å½’å®‰å…¨ä½œç”¨åŸŸåˆ†æ-recursive-safety-scope-analysis"><span>4.3 é€’å½’å®‰å…¨ä½œç”¨åŸŸåˆ†æï¼ˆRecursive safety scope analysisï¼‰</span></a></h3><p>é™¤äº†é™åˆ¶è¿‡åº¦è¿‘ä¼¼ï¼Œæˆ‘ä»¬è¿˜ç¼“è§£äº† MIR åˆ†æä¸­å¯èƒ½å‡ºç°çš„ä¸€ç±»<strong>æ¼æŠ¥</strong>ã€‚åœ¨ Rust ä¸­ï¼Œ<strong>ä½œç”¨åŸŸï¼ˆscopeï¼‰<strong>æ˜¯ä»£ç å—çš„åŸºæœ¬å•ä½ï¼ˆä¾‹å¦‚ <code>unsafe { ... }</code> æœ¬èº«å°±æ˜¯ä¸€ä¸ªä½œç”¨åŸŸï¼‰ã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼šå½“ MIR çº§ä¼˜åŒ–å™¨åœ¨ <code>unsafe</code> å—å†…å°†</strong>å†…è”å‡½æ•°è°ƒç”¨</strong>åŒ…ä¸Šä¸€å±‚å†…éƒ¨ä½œç”¨åŸŸï¼ˆä¾‹å¦‚æ’å…¥èŠ±æ‹¬å·ï¼‰æ—¶ï¼Œ<code>unsafe</code> å†…éƒ¨<strong>ç»å¸¸å‡ºç°åµŒå¥—ä½œç”¨åŸŸ</strong>ã€‚</p><p>å›å¿†ï¼šä¸€ä¸ªä»£ç å—æ˜¯å¦å®‰å…¨ï¼ˆå³<strong>æ˜¯å¦å¤„äº <code>unsafe</code> å†…</strong>ï¼‰åœ¨ MIR ä¸­<strong>ä¸å¯è§</strong>ã€‚å› æ­¤ï¼Œåœ¨ MIR åˆ†æä¸­åˆ¤å®šä½œç”¨åŸŸå®‰å…¨ä¸å¦ï¼Œå¿…é¡»é€šè¿‡<strong>å¸¦ä½œç”¨åŸŸ ID çš„å›æŸ¥</strong>å»æŸ¥è¯¢ HIRã€‚æˆ‘ä»¬å‘ç°ï¼Œè‹¥ä¸<strong>æ˜¾å¼</strong>åœ°æŠŠä½œç”¨åŸŸåˆ†æåšæˆ<strong>é€’å½’</strong>ï¼ˆå³å‘ä¸Šéå†åˆ°æœ€å¤–å±‚ä½œç”¨åŸŸï¼‰ä¸”<strong>æ„ŸçŸ¥ HIR</strong>ï¼Œåˆ™ <code>unsafe</code> å†…éƒ¨çš„åµŒå¥—ä½œç”¨åŸŸ<strong>å¯èƒ½è¢«è¯¯åˆ¤ä¸ºå®‰å…¨</strong>ã€‚åæœæ˜¯ï¼šå¯èƒ½<strong>é—æ¼</strong>æ•´æ®µ<strong>å†…è”å‡½æ•°</strong>ä¸­çš„<strong>ä¸å®‰å…¨å†…å­˜è®¿é—®è¯­å¥</strong>ã€‚æ—¢æœ‰å·¥ä½œ [38] å¹¶æœªæ­£ç¡®è¯†åˆ«è¿™äº›åµŒå¥—ä½œç”¨åŸŸï¼Œå¯¼è‡´åœ¨ <strong>I1</strong> ä¸Šå‡ºç°æ¼æŠ¥ã€‚ç”±äºç›¸å…³å®ç°å°šæœªå…¬å¼€ï¼Œæˆ‘ä»¬æ— æ³•ç¡®è®¤ <strong>TRust</strong> [15] æ˜¯å¦ä¹Ÿå­˜åœ¨åŒç±»é—®é¢˜ã€‚</p><blockquote><p>ç¬”è€…æ³¨ï¼šä¹Ÿå°±æ˜¯è¯´ï¼Œéœ€è¦é€’å½’å°†unsafeä»å¤–éƒ¨ä½œç”¨åŸŸä¼ é€’åˆ°å­ä½œç”¨åŸŸ</p></blockquote><hr><h3 id="_4-4-åˆ†é…å‡½æ•°è¯†åˆ«-allocation-function-identification" tabindex="-1"><a class="header-anchor" href="#_4-4-åˆ†é…å‡½æ•°è¯†åˆ«-allocation-function-identification"><span>4.4 åˆ†é…å‡½æ•°è¯†åˆ«ï¼ˆAllocation function identificationï¼‰</span></a></h3><p>æœ€åï¼ŒRustSan åŸºäºä»…åœ¨ <strong>MIR</strong> å¯ç”¨çš„<strong>ç±»å‹ä¿¡æ¯</strong>æå‡ºä¸¤æ¡ <strong>Rust ç‰¹æœ‰çš„å¯å‘å¼</strong>ï¼Œç”¨äºè¯†åˆ«<strong>å¯èƒ½çš„å †åˆ†é…å‡½æ•°/æ–¹æ³•</strong>ï¼š</p><ol><li><p><strong>åŸºäºåˆ†é…å™¨ trait çš„å®ç°ã€‚</strong> è‹¥æŸç±»å‹å®ç°äº†<strong>åˆ†é…å™¨ç›¸å…³ trait</strong>ï¼ˆå¦‚ <code>Global</code> æˆ– <code>bumpalo</code>ï¼‰ï¼Œæˆ‘ä»¬å°±æŠŠå…¶å®ç°çš„æ–¹æ³•ï¼ˆå¦‚ <code>Global::alloc()</code>ï¼‰æ ‡è®°ä¸º<strong>å †åˆ†é…å‡½æ•°</strong>ï¼ˆ<strong>I3</strong>ï¼‰ã€‚åç»­åœ¨ LLVM ä¸­åŸºäº <strong>SVF</strong> çš„ points-to åˆ†æä¼šä½¿ç”¨è¿™äº›ä¿¡æ¯æ¥å»ºæ¨¡ Rust çš„å †å¯¹è±¡åˆ†é…ã€‚</p></li><li><p><strong>ä»¥åˆ†é…å™¨ trait ä¸ºè¾¹ç•Œçš„ç±»å‹ã€‚</strong> å¯¹äºä»¥<strong>åˆ†é…å™¨ trait</strong>ä½œä¸º<strong>è¾¹ç•Œï¼ˆboundsï¼‰<strong>çš„ç±»å‹ï¼ˆå¦‚ <code>Vec&lt;T, A: Allocator&gt;</code>ï¼‰ï¼ŒRustSan å°†å…¶</strong>æ‰€æœ‰å®ç°çš„æ–¹æ³•</strong>éƒ½è§†ä¸º<strong>æ½œåœ¨</strong>çš„å †åˆ†é…æ–¹æ³•ï¼ˆ<strong>I4</strong>ï¼‰ã€‚éšååœ¨ LLVM ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æ£€æŸ¥<strong>è°ƒç”¨å›¾</strong>ï¼ˆÂ§5.2ï¼‰è¿™äº›æ–¹æ³•æ˜¯å¦<strong>å®é™…è§¦å‘</strong>äº†å †åˆ†é…ï¼ŒæŠŠè¿™äº›â€œæ½œåœ¨æ–¹æ³•â€<strong>ç»†åŒ–</strong>ä¸º<strong>çœŸå®çš„åˆ†é…æ–¹æ³•é›†åˆ</strong>ã€‚</p></li></ol><p>è¯†åˆ«è¿™äº›åˆ†é…å‡½æ•°å¹¶å°†å…¶ä½œä¸º<strong>æ±¡ç‚¹æº</strong>ï¼Œå¯<strong>é™ä½ç¨‹åºåˆ†æå¤æ‚åº¦</strong>ã€‚æ­¤å¯å‘å¼é¿å…äº†åœ¨ LLVM åˆ†æä¸­ï¼Œä» Rust å±‚çš„åˆ†é…å‡½æ•°ä¸€è·¯è¿½è¸ªåˆ°<strong>æœ¬åœ°åˆ†é…å‡½æ•°</strong>ï¼ˆå¦‚ C åº“çš„ <code>malloc</code>ï¼‰æ‰€å¸¦æ¥çš„ä¸å¿…è¦å¤æ‚åº¦æå‡ã€‚</p><h2 id="_5-è·¨-ir-llvm-ir-åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_5-è·¨-ir-llvm-ir-åˆ†æ"><span>5. è·¨ IRï¼šLLVM IR åˆ†æ</span></a></h2><p><strong>å›¾2</strong> å±•ç¤ºäº† <strong>RustSan</strong> åœ¨ <strong>LLVM IR</strong> å±‚æ‰§è¡Œçš„å„ç±»åˆ†æã€‚å½“ä¸Šä¸€é˜¶æ®µçš„ <strong>MIR</strong> å·²è¢«ç¿»è¯‘ä¸º <strong>LLVM IR</strong>ï¼Œå¹¶æºå¸¦äº†å‰è¿°æå–çš„å…³é”®ä¿¡æ¯ï¼ˆ<strong>I1â€“I4</strong>ï¼‰åï¼ŒRustSan ä¼šæ®æ­¤è¯†åˆ«å¦‚ä¸‹ä¿¡æ¯ï¼š</p><figure><img src="/assets/images/scholar/RustSan/figure2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li><strong>I5</strong>ï¼šå†…å­˜<strong>è®¿é—®ç‚¹</strong>çš„å®‰å…¨æ€§ï¼ˆsafe / unsafe / false-safeï¼‰</li><li><strong>I6</strong>ï¼šå†…å­˜<strong>åˆ†é…ç‚¹</strong>çš„å®‰å…¨æ€§ï¼ˆsafe / unsafe / overlappingï¼‰</li></ul><p>ä»¥ä¸Šä¿¡æ¯ç”¨äºæ”¯æ’‘ RustSan è¿è¡ŒæœŸç»„ä»¶å¯¹<strong>å½±å­å†…å­˜</strong>çš„ç®¡ç†ä»¥åŠå¯¹<strong>è®¿é—®ç‚¹æ’æ¡©</strong>çš„å®æ–½ã€‚<br><strong>I5</strong> ä½¿ RustSan èƒ½æŒ‰è®¿é—®ç‚¹çš„å®‰å…¨çº§åˆ«<strong>é€‰æ‹©æ€§</strong>åœ°åº”ç”¨æ£€æŸ¥ï¼šå¯¹<strong>å®‰å…¨</strong>è®¿é—®ç‚¹<strong>çœç•¥</strong>æ’æ¡©ï¼›è€Œå¯¹<strong>ä¸å®‰å…¨</strong>ä¸<strong>ä¼ªå®‰å…¨</strong>è®¿é—®ç‚¹ï¼Œåˆ™æä¾›<strong>ä¸åŒçš„å†…å­˜è®¿é—®è§†å›¾</strong>ï¼ˆè¯¦è§ Â§6ï¼‰ã€‚<br><strong>I6</strong> åˆ™ç”¨äºè¯†åˆ«æ‰€æœ‰å¯èƒ½è¢«ç”¨æ¥åˆ†é…<strong>ä¸å®‰å…¨/é‡å </strong>å †å¯¹è±¡çš„ Rust åˆ†é…å‡½æ•°ï¼ˆä¾‹å¦‚å·²å¾—åˆ°çš„ <strong>I3ã€I4</strong> é›†åˆä¸­çš„å‡½æ•°ï¼‰ã€‚è¿™äº›<strong>åˆ†é…ç‚¹ï¼ˆallocation sitesï¼‰<strong>å°†è¢«æ›¿æ¢ä¸º</strong>åŒ…è£…åˆ†é…å‡½æ•°</strong>ï¼Œä»¥ä¾¿<strong>æ›´æ–°å½±å­å†…å­˜</strong>ä¸­ä¸å¯¹è±¡å®‰å…¨ä¿¡æ¯å¯¹åº”çš„æ¡ç›®ã€‚</p><hr><h3 id="_5-1-å¯¹è±¡ä¸è®¿é—®ç‚¹çš„åˆ†ç±»æµæ°´çº¿-object-and-site-classification-pipeline" tabindex="-1"><a class="header-anchor" href="#_5-1-å¯¹è±¡ä¸è®¿é—®ç‚¹çš„åˆ†ç±»æµæ°´çº¿-object-and-site-classification-pipeline"><span>5.1 å¯¹è±¡ä¸è®¿é—®ç‚¹çš„åˆ†ç±»æµæ°´çº¿ï¼ˆObject and site classification pipelineï¼‰</span></a></h3><p>RustSan é‡‡ç”¨ <strong>SVF</strong> ä¸­å¯¹ <strong>Andersen æŒ‡é’ˆåˆ†æ</strong>çš„å®ç°ï¼ˆå­—æ®µæ•æ„Ÿã€ä¸Šä¸‹æ–‡ä¸æ•æ„Ÿã€æµä¸æ•æ„Ÿï¼‰[11]ï¼Œä»¥åˆ†ç±»å†…å­˜å¯¹è±¡ä¸å†…å­˜è®¿é—®ç‚¹çš„å®‰å…¨æ€§ï¼ˆ<strong>I5</strong>ï¼‰ã€‚è¿™ç§â€œä¸Šä¸‹æ–‡ä¸æ•æ„Ÿã€ä½†å­—æ®µæ•æ„Ÿâ€çš„æµä¸æ•æ„Ÿåˆ†æåœ¨ä¿è¯ä¸€å®šç²¾åº¦çš„åŒæ—¶ï¼Œèƒ½<strong>æ‰©å±•åˆ°å¤§å‹ç¨‹åº</strong>â€”â€”è¿™æ˜¯ sanitizer çš„å¿…è¦è¦æ±‚ã€‚</p><blockquote><p>ç¬”è€…æ³¨ï¼š</p><ul><li><p><strong>å­—æ®µæ•æ„Ÿï¼ˆfield-sensitiveï¼‰</strong>ï¼š æŠŠåŒä¸€ç»“æ„ä½“/å¯¹è±¡çš„ä¸åŒå­—æ®µå½“ä½œ<strong>å½¼æ­¤ç‹¬ç«‹</strong>çš„å†…å­˜ä½ç½®æ¥åˆ†æã€‚ ä¾‹ï¼šå¯¹ <code>struct S { A *f; B *g; }</code>ï¼Œåˆ†æä¼šåŒºåˆ† <code>p-&gt;f</code> ä¸ <code>p-&gt;g</code> çš„æŒ‡å‘ï¼Œä¸ä¼šæŠŠå®ƒä»¬æ··ä¸ºä¸€è°ˆã€‚è¿™æ ·èƒ½å‡å°‘â€œä¸åŒå­—æ®µè¢«è¯¯è®¤ä¸ºå¯è¾¾â€çš„å‡é˜³æ€§ã€‚</p></li><li><p><strong>ä¸Šä¸‹æ–‡ä¸æ•æ„Ÿï¼ˆcontext-insensitiveï¼‰</strong>ï¼š ä¸åŒºåˆ†å‡½æ•°åœ¨**ä¸åŒè°ƒç”¨ç‚¹ï¼ˆè°ƒç”¨ä¸Šä¸‹æ–‡ï¼‰**ä¸‹çš„è¡Œä¸ºï¼›ä¸€ä¸ªå‡½æ•°åªåˆ†æä¸€æ¬¡ï¼ŒæŠŠæ‰€æœ‰è°ƒç”¨è€…çš„å½±å“éƒ½åˆå¹¶ã€‚ ä¾‹ï¼š<code>foo(x)</code> è¢«å¤šå¤„ä»¥ä¸åŒå®å‚è°ƒç”¨ï¼Œåˆ†ææŠŠè¿™äº›è°ƒç”¨çš„åˆ«åå…³ç³»åˆåœ¨ä¸€èµ·ï¼Œå¯èƒ½å¯¼è‡´ä¿å®ˆçš„ï¼ˆè¿‡è¿‘ä¼¼çš„ï¼‰ç»“æœï¼Œä½†å¯æ˜¾è‘—æå‡å¯æ‰©å±•æ€§ã€‚</p></li><li><p><strong>æµä¸æ•æ„Ÿï¼ˆflow-insensitiveï¼‰</strong> å¿½ç•¥<strong>ç¨‹åºå†…è¯­å¥çš„æ‰§è¡Œé¡ºåºä¸æ§åˆ¶æµ</strong>ï¼ŒæŠŠåŒä¸€å˜é‡çš„æ‰€æœ‰å¯èƒ½èµ‹å€¼ç»Ÿä¸€è€ƒè™‘ï¼›ç­‰ä»·äºâ€œæŠŠå—å†…è¯­å¥å½“ä½œå¯ä»»æ„æ’åˆ—â€ã€‚ ä¾‹ï¼šå¯¹</p></li></ul><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" data-title="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">p </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> &amp;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">a;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">p </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> &amp;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">b;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ–è€…ç›¸åé¡ºåºï¼Œåˆ†æéƒ½ä¼šå¾—åˆ° <code>p</code> å¯èƒ½æŒ‡å‘ <code>{&amp;a, &amp;b}</code>ã€‚è¿™åŒæ ·æ˜¯ä¿å®ˆè¿‘ä¼¼ï¼Œæ¢æ¥æ›´å¿«çš„å…¨å±€è§£ã€‚</p><p>ç»¼åˆèµ·æ¥ï¼š<strong>å­—æ®µæ•æ„Ÿ +ï¼ˆä¸Šä¸‹æ–‡ã€æµï¼‰ä¸æ•æ„Ÿ</strong> æ˜¯ä¸€ç§å¸¸è§æŠ˜ä¸­ï¼šåœ¨å¯¹è±¡å†…éƒ¨ä¿æŒè¾ƒé«˜ç²¾åº¦ï¼ˆåŒºåˆ†å­—æ®µï¼‰ï¼Œè€Œåœ¨è·¨è°ƒç”¨ä¸æ§åˆ¶æµå±‚é¢åšåˆå¹¶ï¼Œä»¥ä¿è¯åœ¨å¤§å‹ç¨‹åºä¸Šçš„å¯æ‰©å±•æ€§ã€‚</p></blockquote><p>æˆ‘ä»¬éµå¾ª <strong>SVF</strong> çš„å†…å­˜æ¨¡å‹ [50]ï¼šæŠŠ<strong>å†…å­˜å¯¹è±¡</strong>æŒ‰ç…§å…¶<strong>åˆ†é…ç‚¹</strong>å»ºæ¨¡ï¼Œåˆ†é…ç‚¹æ—¢å¯ä»¥æ˜¯<strong>æ ˆåˆ†é…</strong>ï¼ˆ<code>alloca</code> æŒ‡ä»¤ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯<strong>å †åˆ†é…</strong>ï¼ˆè°ƒç”¨ <strong>I3</strong> ä¸­è¯†åˆ«çš„ <code>exchange_malloc</code> ç­‰å †åˆ†é…å‡½æ•°ï¼‰ã€‚RustSan ä¸æ—¢æœ‰å·¥ä½œ [15, 38] ç±»ä¼¼ï¼Œä½¿ç”¨<strong>points-to</strong> ä¸<strong>æ•°å€¼æµ</strong>åˆ†ææ¥æ‰¾å‡º<strong>æ¯ä¸ªå†…å­˜è®¿é—®ç‚¹å¯èƒ½è®¿é—®åˆ°çš„å¯¹è±¡é›†åˆ</strong>ï¼ˆmay-points-to setï¼‰ã€‚éšåæˆ‘ä»¬ä¾æ® Â§3.1 çš„å®šä¹‰åˆ©ç”¨è¿™äº› points-to ä¿¡æ¯æ¥å¯¹å¯¹è±¡ä¸è®¿é—®ç‚¹è¿›è¡Œåˆ†ç±»ã€‚ç»†èŠ‚å¦‚ä¸‹ï¼š</p><p><strong>ä¸å®‰å…¨è®¿é—®ç‚¹é›†åˆï¼ˆUnsafe site setï¼‰ã€‚</strong> é¦–å…ˆæŠŠä½äº <code>unsafe</code> ä¸­çš„<strong>å†…å­˜è®¿é—®è¯­å¥</strong>æ ‡è®°ä¸º<strong>ä¸å®‰å…¨è®¿é—®ç‚¹</strong>ã€‚åšæ³•æ˜¯å°† <strong>I1</strong> ä¸­è¯­å¥åœ¨ LLVM ä¸­çš„ç­‰ä»·æŒ‡ä»¤åŠ å…¥â€œä¸å®‰å…¨è®¿é—®ç‚¹é›†åˆâ€ã€‚</p><p><strong>ä¸å®‰å…¨å¯¹è±¡é›†åˆï¼ˆUnsafe object setï¼‰ã€‚</strong> æ¥ç€è¯†åˆ«<strong>ä¸å®‰å…¨å¯¹è±¡</strong>ï¼šå›å¿†â€œå‡¡åœ¨ <code>unsafe</code> å—å†…è¢«<strong>ä¿®æ”¹</strong>çš„å¯¹è±¡éƒ½æ˜¯ä¸å®‰å…¨å¯¹è±¡â€ã€‚ç”± HIR/MIR é˜¶æ®µç²¾ç‚¼å¾—åˆ°çš„<strong>å†™è¯­å¥é›†åˆ I2</strong> å·²è¢«ç¿»è¯‘ä¸ºä¸€ç»„ <strong>LLVM IR</strong> æŒ‡ä»¤ã€‚RustSan åœ¨è¿™ç»„æŒ‡ä»¤ä¸Šæ‰§è¡Œ points-to åˆ†æï¼Œæ‰¾å‡º<strong>è¿™äº›æŒ‡ä»¤å¯èƒ½æŒ‡å‘çš„å†…å­˜å¯¹è±¡</strong>â€”â€”ä¹Ÿå³<strong>å¯èƒ½è¢« <code>unsafe</code> ä¿®æ”¹</strong>çš„å¯¹è±¡ã€‚ç”±æ­¤å¾—åˆ°çš„å¯¹è±¡å³è¢«å½’ç±»ä¸º<strong>ä¸å®‰å…¨å¯¹è±¡é›†åˆ</strong>ã€‚</p><p><strong>ä¼ªå®‰å…¨è®¿é—®ç‚¹é›†åˆï¼ˆFalse-safe site setï¼‰ã€‚</strong> åœ¨è¿™ä¸€é˜¶æ®µï¼Œæ‰€æœ‰<strong>ä¸åœ¨</strong>â€œä¸å®‰å…¨è®¿é—®ç‚¹é›†åˆâ€ä¸­çš„è®¿é—®ç‚¹<strong>æš‚è§†ä¸ºå®‰å…¨</strong>ã€‚RustSan éœ€è¦ä»ä¸­è¯†åˆ«å¹¶åˆ†ç¦»å‡º<strong>ä¼ªå®‰å…¨è®¿é—®ç‚¹</strong>ï¼šæŒ‰ç…§æˆ‘ä»¬çš„å®šä¹‰ï¼Œå‡¡<strong>ä¸å±äº <code>unsafe</code> å—</strong>ï¼Œä½†<strong>ä¼šè®¿é—®è‡³å°‘ä¸€ä¸ªâ€œä¸å®‰å…¨å¯¹è±¡é›†åˆâ€ä¸­çš„å¯¹è±¡</strong>çš„è®¿é—®ç‚¹ï¼Œéƒ½æ˜¯<strong>ä¼ªå®‰å…¨</strong>ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯¹è¿™æ‰¹â€œæš‚æ—¶å®‰å…¨â€çš„è®¿é—®ç‚¹å†æ¬¡æ‰§è¡Œ points-to åˆ†æï¼Œä»è€Œå¾—åˆ°<strong>åˆ†ç¦»å‡ºçš„ä¼ªå®‰å…¨é›†åˆ</strong>ã€‚</p><p><strong>é‡å å¯¹è±¡é›†åˆï¼ˆOverlapping object setï¼‰ã€‚</strong> æœ€åè¯†åˆ«<strong>é‡å å¯¹è±¡</strong>ï¼šå®ƒæ˜¯<strong>å®‰å…¨å¯¹è±¡é›†åˆ</strong>çš„ä¸€ä¸ª<strong>å­é›†</strong>ï¼ˆå³ä¸â€œä¸å®‰å…¨å¯¹è±¡é›†åˆâ€äº’è¡¥çš„é‚£éƒ¨åˆ†ä¸­çš„å­é›†ï¼‰ã€‚è‹¥æŸä¸ªå¯¹è±¡ä¸<strong>è‡³å°‘ä¸€ä¸ªä¼ªå®‰å…¨è®¿é—®ç‚¹</strong>ä¹‹é—´å­˜åœ¨<strong>è¢«æŒ‡å‘ï¼ˆpointed-byï¼‰<strong>å…³ç³»ï¼Œåˆ™æŠŠå®ƒçº³å…¥</strong>é‡å å¯¹è±¡é›†åˆ</strong>ã€‚æˆ‘ä»¬åœ¨å·²è¯†åˆ«çš„ä¼ªå®‰å…¨è®¿é—®ç‚¹é›†åˆä¸Š<strong>è¿­ä»£æ‰§è¡Œ</strong> points-to åˆ†æä»¥å¾—åˆ°è¯¥é›†åˆã€‚<br> éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>é‡å å¯¹è±¡</strong>ä¸<strong>ä¸å®‰å…¨å¯¹è±¡</strong>å…±åŒæ„æˆ<strong>ä¼ªå®‰å…¨è®¿é—®ç‚¹</strong>çš„åŒä¸€ç»„ may-points-toâ€œä½æˆ·â€ï¼ˆtenantsï¼‰ï¼Œå› æ­¤åä¸º <strong>overlapping</strong>ï¼ˆâ€œé‡å â€ï¼‰ã€‚</p><h3 id="_5-2-åˆ†é…ç‚¹å®‰å…¨æ€§çš„è¯†åˆ«-allocation-site-safety-identification" tabindex="-1"><a class="header-anchor" href="#_5-2-åˆ†é…ç‚¹å®‰å…¨æ€§çš„è¯†åˆ«-allocation-site-safety-identification"><span>5.2 åˆ†é…ç‚¹å®‰å…¨æ€§çš„è¯†åˆ«ï¼ˆAllocation site safety identificationï¼‰</span></a></h3><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»å…·å¤‡åˆ¤å®š<strong>åˆ†é…ç‚¹</strong>å®‰å…¨æ€§ï¼ˆ<strong>I6</strong>ï¼‰æ‰€éœ€çš„ä¿¡æ¯ã€‚<strong>RustSan</strong> å¿…é¡»è¯†åˆ«å‡ºå¯¹è±¡çš„<strong>åˆ†é…ä½ç½®</strong>ï¼Œä»¥ä¾¿åœ¨åç»­æ’æ¡©ä¸­å¯¹å…¶è¿›è¡Œ<strong>é‡è½½</strong>ï¼Œä»è€ŒæŠŠå¯¹è±¡çš„<strong>å®‰å…¨ä¿¡æ¯</strong>å†™å…¥<strong>å½±å­å†…å­˜</strong>ï¼ˆÂ§6 å°†è§£é‡Šï¼‰ã€‚Rust é€šè¿‡å¯¹è±¡çš„ <strong>trait</strong> è¿˜è¡¨ç°å‡º<strong>é—´æ¥</strong>çš„å †åˆ†é…è¡Œä¸ºã€‚å› æ­¤ï¼Œé™¤äº†ç›´æ¥å †åˆ†é…ç‚¹ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜æå‡ºäº†ä¸€ä¸ª<strong>é¢å‘ Rust çš„æ–¹æ³•</strong>æ¥å¤„ç†<strong>é—´æ¥å †åˆ†é…ç‚¹</strong>ã€‚</p><p><strong>ç›´æ¥å †åˆ†é…ç‚¹ã€‚</strong> é¦–å…ˆç¡®å®šç”± <strong>I3</strong> ä¸­â€œå †åˆ†é…å‡½æ•°â€<strong>ç›´æ¥</strong>äº§ç”Ÿçš„å †å†…å­˜åˆ†é…ç‚¹çš„å®‰å…¨æ€§ã€‚é’ˆå¯¹è¿™ç±»åˆ†é…ç‚¹ï¼Œå…¶å®‰å…¨æ€§å·²ç»åœ¨ Â§5.1 çš„åˆ†æä¸­å®Œæˆäº†åˆ†ç±»ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦<strong>æŠŠè¯¥åˆ†é…ç‚¹æ‰“ä¸Šâ€œæ‰€åˆ†é…å¯¹è±¡çš„å®‰å…¨çº§åˆ«â€<strong>çš„æ ‡è®°ï¼Œä»¥ä¾¿åç»­çš„æ’æ¡©èƒ½æ®æ­¤è¿›è¡Œ</strong>é‡è½½</strong>å¤„ç†ã€‚</p><p><strong>é—´æ¥å †åˆ†é…ç‚¹ã€‚</strong> <strong>RustSan</strong> è¿˜å®ç°äº†ä¸€å¥—æ–¹æ¡ˆæ¥ç»™ç”± <strong>trait æ–¹æ³•è°ƒç”¨</strong>è§¦å‘çš„<strong>é—´æ¥å †åˆ†é…</strong>è¿›è¡Œå®‰å…¨æ€§åˆ†ç±»ã€‚æˆ‘ä»¬åœ¨ <strong>Listing 1a</strong> ä¸­æ¼”ç¤ºäº†è¿™ç§é—´æ¥åˆ†é…ï¼šç¬¬ 1 è¡Œå®šä¹‰äº†ä¸€ä¸ª Rust å¯¹è±¡ï¼Œç¬¬ 4 è¡Œåœ¨ <code>unsafe</code> ä¸­å¯¹å…¶è¿›è¡Œäº†ä¿®æ”¹ã€‚å…¶ç¼–è¯‘åçš„ LLVM IR å¯¹åº”ä»£ç è§ <strong>Listing 1b</strong>ï¼›å…¶ä¸­ï¼Œç¬¬ 4 è¡Œçš„ <code>Vec::set_len</code> è°ƒç”¨è¢«åˆ†ç±»ä¸º<strong>ä¸å®‰å…¨è®¿é—®ç‚¹</strong>ï¼Œè€Œç¬¬ 1 è¡Œåˆ†é…çš„æ ˆå¯¹è±¡è¢«åˆ†ç±»ä¸º<strong>ä¸å®‰å…¨å¯¹è±¡</strong>ã€‚ç¬¬ 3 è¡Œè°ƒç”¨ <code>Vec::reserve()</code>ï¼ˆä¸€ä¸ªä¼šè§¦å‘å †åˆ†é…çš„ trait æ–¹æ³•ï¼‰ï¼Œå¹¶æŠŠç»“æœå†™å›æ ˆå¯¹è±¡ <code>%v</code>ã€‚ç„¶è€Œï¼Œ<strong>å¦‚æœæˆ‘ä»¬åªçœ‹ç¬¬ 4 è¡Œå®å‚ <code>%v</code> çš„ points-to é›†åˆ</strong>ï¼Œå®ƒåªåŒ…å«æ ˆå¯¹è±¡ <code>%v</code> æœ¬èº«ï¼Œå°±<strong>æ£€æµ‹ä¸åˆ°</strong>è¿™æ¬¡å †å¯¹è±¡åˆ†é…ã€‚</p><figure><img src="/assets/images/scholar/RustSan/listing1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ä¸ºäº†è¿½è¸ªè¿™ç±»åˆ†é…ç‚¹çš„å®‰å…¨æ€§ï¼Œ<strong>RustSan</strong> ä»åˆ†æ <strong>I4</strong> æ‰€è¯†åˆ«çš„æ–¹æ³•åœ¨ LLVM ä¸­çš„<strong>è°ƒç”¨ç‚¹</strong>å…¥æ‰‹ã€‚é’ˆå¯¹è¿™äº›è°ƒç”¨ç‚¹ï¼ŒRustSan æ£€æŸ¥å¦‚ä¸‹æ¡ä»¶ï¼š<br> 1ï¼‰è¢«è°ƒç”¨çš„å¯¹è±¡æ–¹æ³•åœ¨å…¶<strong>è°ƒç”¨å›¾</strong>ä¸Šå¿…é¡»èƒ½<strong>è¿æ¥åˆ°</strong>æŸä¸ª<strong>å †åˆ†é…å‡½æ•°</strong>ï¼ˆ<strong>I3</strong>ï¼‰ï¼›<br> 2ï¼‰è¯¥æ–¹æ³•è°ƒç”¨ä¸­ä½¿ç”¨çš„<strong>æŸä¸ªå®å‚</strong>å¿…é¡»<strong>æŒ‡å‘</strong>ä¸€ä¸ª<strong>ä¸å®‰å…¨/é‡å å¯¹è±¡</strong>ã€‚<br> è‹¥æŸæ¬¡æ–¹æ³•è°ƒç”¨åŒæ—¶æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶ï¼Œ<strong>RustSan</strong> ä¾¿æŠŠè¯¥è°ƒç”¨<strong>æ ‡è®°ä¸ºâ€œå †åˆ†é…ç‚¹â€</strong>ï¼Œå¹¶æŠŠâ€œè¢«æŒ‡å‘çš„å¯¹è±¡â€çš„<strong>å®‰å…¨çº§åˆ«</strong>é™„ç€åˆ°è¯¥åˆ†é…ç‚¹ä¸Šã€‚åˆ©ç”¨è¿™ä¸€å¯å‘å¼ï¼ŒRustSan å°† <strong>Listing 1b</strong> çš„ç¬¬ 5 è¡Œè¯†åˆ«ä¸º<strong>ä¸å®‰å…¨å¯¹è±¡çš„é—´æ¥å †åˆ†é…ç‚¹</strong>ã€‚</p><blockquote><p>ç¬”è€…æ³¨ï¼šåŸæ–‡å¦‚æ­¤ï¼Œå®é™…æ˜¯ç¬¬3è¡Œï¼Œâ€œç¬¬5è¡Œâ€åº”è¯¥ä¸ºç¬”è¯¯</p></blockquote><hr><h3 id="_5-3-å°†åˆ†ææŠ€æœ¯é€‚é…åˆ°-rust-adapting-analysis-techniques-to-rust" tabindex="-1"><a class="header-anchor" href="#_5-3-å°†åˆ†ææŠ€æœ¯é€‚é…åˆ°-rust-adapting-analysis-techniques-to-rust"><span>5.3 å°†åˆ†ææŠ€æœ¯é€‚é…åˆ° Rustï¼ˆAdapting analysis techniques to Rustï¼‰</span></a></h3><p>æˆ‘ä»¬çš„ LLVM IR åˆ†æä¾èµ– <strong>SVF</strong> [50] çš„<strong>å…ˆè¿›</strong>æ•°å€¼æµï¼ˆValue-Flowï¼‰åˆ†æä¸ <strong>Andersen</strong> æŒ‡é’ˆåˆ†æå®ç° [11]ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬å¯¹ SVF è¿›è¡Œäº†è‹¥å¹²<strong>æ”¹åŠ¨</strong>ï¼Œä»¥ä¾¿æ›´å¥½åœ°å…¼å®¹ Rustï¼š</p><p><strong>é¢å‘ Rust çš„åˆ†é…å‡½æ•°ã€‚</strong> é¦–å…ˆï¼Œæˆ‘ä»¬ä¿®æ”¹ SVFï¼Œä½¿å…¶èƒ½<strong>è¯†åˆ«</strong>æˆ‘ä»¬åœ¨ HIR/MIR åˆ†æï¼ˆ<strong>I3</strong>ï¼‰ä¸­å‘ç°çš„<strong>Rust å †åˆ†é…å‡½æ•°</strong>ã€‚è¿™æ ·ï¼ŒSVF å°±èƒ½æŠŠè¿™äº›å‡½æ•°è¿”å›çš„å¯¹è±¡æŒ‡é’ˆè¯†åˆ«ä¸º<strong>æ–°åˆ†é…çš„å †å¯¹è±¡</strong>ã€‚</p><p><strong>æŒ‡é’ˆæ“ä½œ trait çš„æ¨¡æ‹Ÿã€‚</strong> è‹¥æŸå¯¹è±¡ç±»å‹æ²¡æœ‰<strong>é‡è½½</strong>å…¶æŒ‡é’ˆè¿ç®—ç¬¦ï¼Œé‚£ä¹ˆå¯é‡è½½è¿ç®—ç¬¦å®é™…ä¼šä» Rust æ ‡å‡†åº“çš„<strong>è¿ç®—ç¬¦æ¨¡å—</strong>ï¼ˆ<code>std::ops</code>ï¼‰ä¸­è°ƒç”¨åˆ°<strong>é»˜è®¤ç¬¦å·</strong>ã€‚æˆ‘ä»¬å‘ç°ï¼Œåªéœ€æŠŠè¿™äº›è¿ç®—æ›¿æ¢ä¸º<strong>é»˜è®¤çš„å–å€/è§£å¼•ç”¨è¯­ä¹‰</strong>ï¼Œå°±èƒ½<strong>æœ€å°åŒ–</strong> points-to åˆ†æçš„å¤æ‚åº¦ã€‚</p><p><strong>æ”¯æŒå¸¸ç”¨æŒ‡ä»¤ã€‚</strong> æˆ‘ä»¬ä¸º LLVM æŒ‡ä»¤ <strong><code>ExtractValue</code></strong> ä¸ <strong><code>InsertValue</code></strong> ç­‰æ·»åŠ äº†å¯¹ SVF çš„<strong>æ”¯æŒ</strong>ã€‚è¿™äº›æŒ‡ä»¤åœ¨ Rust ç¼–è¯‘ä¸­è¢«<strong>å¤§é‡ä½¿ç”¨</strong>ï¼Œä½†åŸç‰ˆ SVF å¹¶ä¸è¯†åˆ«ã€‚æœ€è¿‘ä¸€ç¯‡å·¥ä½œ [15] ä¹Ÿæåˆ°äº†å¯¹ SVF çš„ç±»ä¼¼æ”¹åŠ¨ï¼›ç”±äºå…¶å®ç°å‘è¡¨æ—¶å°šæœªå…¬å¼€ï¼Œæˆ‘ä»¬æ–‡ä¸­çš„ <strong>SVF ä¿®æ”¹</strong>å‡ä¸º<strong>è‡ªç ”å®ç°</strong>ã€‚</p><h2 id="_6-rustsan-çš„å½±å­å†…å­˜æ–¹æ¡ˆ-shadow-memory-scheme" tabindex="-1"><a class="header-anchor" href="#_6-rustsan-çš„å½±å­å†…å­˜æ–¹æ¡ˆ-shadow-memory-scheme"><span>6. RustSan çš„å½±å­å†…å­˜æ–¹æ¡ˆï¼ˆshadow memory schemeï¼‰</span></a></h2><p>RustSan å¯¹ ASan å½±å­å†…å­˜æœºåˆ¶çš„æ”¹é€ ï¼Œä¼šåˆ©ç”¨ç¼–è¯‘æœŸå¾—åˆ°çš„ä¿¡æ¯ï¼ˆ<strong>I5ã€I6</strong>ï¼‰ï¼Œä»¥æ‰§è¡Œ<strong>æ„ŸçŸ¥å®‰å…¨æ€§çš„å¯¹è±¡åˆ†é…</strong>ä¸<strong>é€‰æ‹©æ€§æ’æ¡©</strong>ã€‚</p><h3 id="_6-1-æ„ŸçŸ¥å®‰å…¨æ€§çš„å¯¹è±¡åˆ†é…-safety-aware-object-allocation" tabindex="-1"><a class="header-anchor" href="#_6-1-æ„ŸçŸ¥å®‰å…¨æ€§çš„å¯¹è±¡åˆ†é…-safety-aware-object-allocation"><span>6.1 æ„ŸçŸ¥å®‰å…¨æ€§çš„å¯¹è±¡åˆ†é…ï¼ˆSafety-aware object allocationï¼‰</span></a></h3><p>RustSan å®ç°äº†<strong>æ„ŸçŸ¥å®‰å…¨æ€§çš„å¯¹è±¡åˆ†é…</strong>ï¼šæŠŠå¯¹è±¡çš„<strong>å®‰å…¨ä¿¡æ¯ï¼ˆI6ï¼‰<strong>ç¼–ç è¿›å½±å­å†…å­˜ã€‚ä¸ºè¾¾æ­¤ç›®çš„ï¼ŒRustSan åœ¨ ASan çš„</strong>å †å†…å­˜åˆ†é…å™¨</strong>ä¹‹ä¸Šåšæ‰©å±•ï¼Œä½¿å…¶åœ¨ç®¡ç†å½±å­å†…å­˜æ—¶èƒ½å¤Ÿ<strong>åæ˜ å¯¹è±¡çš„å®‰å…¨ç±»åˆ«</strong>ã€‚éšåï¼ŒRustSan çš„æ’æ¡©ä¼šæŠŠå¯¹è±¡çš„<strong>åˆ†é…ç‚¹</strong>æ›¿æ¢ä¸ºä¸‰ç±»ä¹‹ä¸€çš„<strong>åˆ†é…å™¨å°è£…</strong>ï¼ˆwrapperï¼‰ï¼š<code>safe</code>ã€<code>unsafe</code>ã€<code>overlapping</code>ã€‚è¿™äº›å°è£…ä¼šåœ¨å †åˆ†é…æˆåŠŸåï¼Œä¾æ®<strong>æ–°è¿”å›çš„å †åœ°å€</strong>ä¸ºå¯¹åº”å¯¹è±¡<strong>æ›´æ–°å½±å­å†…å­˜æ¡ç›®</strong>ã€‚</p><p><strong>åˆ†é…ç‚¹é‡è½½ï¼ˆAllocation site overrideï¼‰ã€‚</strong><br> RustSan é€šè¿‡ ASan ç°æœ‰çš„æ–¹æ³•ï¼Œé’©ä½ç¨‹åºé»˜è®¤ä½¿ç”¨çš„<strong>å®‰å…¨åˆ†é…å™¨</strong>ã€‚å¯¹<strong>ä¸å®‰å…¨å¯¹è±¡</strong>ä¸<strong>é‡å å¯¹è±¡</strong>çš„åˆ†é…ç‚¹ï¼ŒRustSan ç¼–è¯‘å™¨ä¾æ® <strong>I6</strong> çš„å®‰å…¨ä¿¡æ¯è¿›è¡Œæ›¿æ¢ï¼šä»åˆ†é…ç‚¹å‡ºå‘ï¼Œéå†å…¶<strong>è°ƒç”¨å›¾</strong>ï¼ŒæŠŠè¢«è°ƒç”¨çš„å‡½æ•°<strong>å…‹éš†</strong>æˆä¸“é—¨ç”¨äºâ€œåœ¨æŸä¸€å®‰å…¨çº§åˆ«ä¸‹åˆ†é…å¯¹è±¡â€çš„ç‰ˆæœ¬ï¼›ä¾‹å¦‚æŠŠ <code>foo</code> å…‹éš†ä¸º <code>foo</code>ã€<code>foo_unsafe</code> ä¸ <code>foo_overlapping</code>ã€‚ç„¶ååœ¨è°ƒç”¨å›¾ä¸Šä»¥â€œåˆ†é…ç‚¹çš„å®‰å…¨çº§åˆ«â€ä¸ºä¾æ®ï¼Œ<strong>æ›¿æ¢</strong>å¯¹åº”çš„å‡½æ•°è°ƒç”¨ã€‚æœ€åï¼Œå†æŠŠè°ƒç”¨å›¾ä¸Šå‡ºç°çš„â€œå †åˆ†é…è°ƒç”¨â€ï¼Œç»Ÿä¸€æ›¿æ¢ä¸º RustSan çš„<strong>åˆ†é…å™¨å°è£…</strong>ï¼Œä»¥æ‰§è¡Œå½±å­å†…å­˜ç®¡ç†ã€‚</p><p><strong>å½±å­å­—èŠ‚æ–¹æ¡ˆï¼ˆShadow byte schemeï¼‰ã€‚</strong><br> RustSan æŒ‰<strong>å¯¹è±¡çš„å®‰å…¨ç±»åˆ«</strong>ä¸ºå¯¹è±¡â€œç€è‰²â€ã€‚<strong>ä¸å®‰å…¨å¯¹è±¡</strong>ä¸ç€è‰²ï¼›ä¸ºäº†ä¾¿äºè¯»è€…ç†è§£ï¼ˆè§å›¾3ï¼‰ï¼Œæˆ‘ä»¬å°†<strong>å®‰å…¨å¯¹è±¡</strong>æ¦‚å¿µæ€§åœ°å¯¹åº”ä¸º<strong>æ´‹çº¢è‰²</strong>ï¼Œ<strong>é‡å å¯¹è±¡</strong>å¯¹åº”ä¸º<strong>ç²‰è‰²</strong>ï¼ˆpinkzoneï¼‰ã€‚åœ¨å½±å­å­—èŠ‚çš„<strong>é«˜ 5 ä½</strong>ä¸­ï¼ŒASan å·²ç”¨æ¥è¡¨ç¤ºå„ç§ <strong>redzone</strong>ï¼›RustSan é€‰å–å…¶ä¸­çš„<strong>ç¬¬ 4 ä¸ç¬¬ 5 ä½</strong>æ¥è¡¨ç¤º<strong>å®‰å…¨å¯¹è±¡</strong>ä¸<strong>é‡å å¯¹è±¡</strong>ï¼š</p><figure><img src="/assets/images/scholar/RustSan/figure3.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>å®‰å…¨å¯¹è±¡ä¸é‡å å¯¹è±¡çš„å½±å­å­—èŠ‚å½¢å¦‚ <code>0b00001aaa</code> ä¸ <code>0b00010aaa</code>ï¼Œå…¶ä¸­ä½ 3 ä½ <code>aaa</code> ç”± ASan ä½¿ç”¨ï¼Œç”¨äºåœ¨å½±å­å†…å­˜æ˜ å°„çš„â€œæ¯ 8 å­—èŠ‚çœŸå®å†…å­˜â€åŒºé—´å†…ï¼Œè¡¨è¾¾<strong>å¯å¯»å€å­—èŠ‚</strong>çš„ä½ç½®ã€‚</p><blockquote><p>ç¬”è€…æ³¨ï¼šä½3ä½è¡¨ç¤º8å­—èŠ‚ç©ºé—´ä¸­å¯å¯»å€å­—èŠ‚çš„offset</p></blockquote><p>é™¤â€œå®‰å…¨/é‡å â€ä¸¤ç§ç€è‰²å¤–ï¼Œæˆ‘ä»¬è¿˜ä½¿ç”¨äº†æ­¤å‰æœªå ç”¨çš„ä¸¤ç§<strong>5 ä½ç»„åˆ</strong>æ¥è¡¨ç¤º<strong>éš”ç¦»ï¼ˆquarantinedï¼‰çš„ä¸å®‰å…¨å¯¹è±¡</strong>ä¸<strong>éš”ç¦»çš„é‡å å¯¹è±¡</strong>ã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ª<strong>é‡å å¯¹è±¡</strong>è¢«é‡Šæ”¾æ—¶ï¼Œä¼šæŠŠå…¶å¯¹è±¡å†…å­˜å¯¹åº”çš„å½±å­å­—èŠ‚æ›´æ–°ä¸º<strong>éš”ç¦»çš„ç²‰è‰²å¯¹è±¡</strong>ã€‚éšåï¼Œæˆ‘ä»¬æ‰©å±•äº† ASan åœ¨æ£€æµ‹åˆ°å†…å­˜é”™è¯¯åè°ƒç”¨çš„ <code>report()</code> å‡½æ•°ï¼Œä½¿å…¶èƒ½å¤ŸæŠ¥å‘Š<strong>å‘ç”Ÿåœ¨ä¸å®‰å…¨å¯¹è±¡æˆ–é‡å å¯¹è±¡ä¸Šçš„ use-after-free</strong> æƒ…å†µã€‚</p><h3 id="_6-2-é€‰æ‹©æ€§æ’æ¡©-selective-instrumentation" tabindex="-1"><a class="header-anchor" href="#_6-2-é€‰æ‹©æ€§æ’æ¡©-selective-instrumentation"><span>6.2 é€‰æ‹©æ€§æ’æ¡©ï¼ˆSelective instrumentationï¼‰</span></a></h3><p>åœ¨ä¾æ® <strong>I5</strong> å®Œæˆå¯¹è±¡å®‰å…¨æ€§åˆ†ç±»ä¹‹åï¼Œ<strong>RustSan</strong> éœ€è¦æŒ‰å„è®¿é—®ç‚¹çš„å®‰å…¨çº§åˆ«è¿›è¡Œæ’æ¡©ã€‚é€šè¿‡<strong>ç§»é™¤å®‰å…¨è®¿é—®ç‚¹</strong>ä¸Šä»£ä»·é«˜æ˜‚çš„ã€åŸºäºå½±å­å†…å­˜çš„æ£€æŸ¥ï¼ŒRustSan æ˜¾è‘—é™ä½äº†è¿è¡Œæ—¶å¼€é”€ã€‚ä¸è¿‡ï¼Œå¯¹<strong>ä¼ªå®‰å…¨</strong>ä¸<strong>ä¸å®‰å…¨</strong>è®¿é—®ç‚¹ï¼ŒRustSan ä»ä¼šæ‰§è¡Œå…¶<strong>è·¨å®‰å…¨çº§åˆ«çš„å†…å­˜è®¿é—®æ ¡éªŒ</strong>ï¼ŒåŒæ—¶ä¿ç•™ <strong>ASan</strong> æ—¢æœ‰çš„å†…å­˜é”™è¯¯æ£€æµ‹åŠŸèƒ½ã€‚ä¸‹é¢å¯¹è¿™ä¸¤ç‚¹åšæ›´ç»†è‡´çš„è¯´æ˜ã€‚</p><p><strong>è·¨å®‰å…¨çº§åˆ«çš„å†…å­˜è®¿é—®æ ¡éªŒï¼ˆCross-safety memory access validationï¼‰ã€‚</strong><br> RustSan å¼•å…¥ä¸€ç§ç‹¬ç‰¹çš„<strong>è·¨å®‰å…¨çº§åˆ«</strong>å†…å­˜è®¿é—®æ ¡éªŒæ¨¡å‹ï¼šå¯¹<strong>ä¼ªå®‰å…¨</strong>ä¸<strong>ä¸å®‰å…¨</strong>è®¿é—®ç‚¹æ–½åŠ <strong>ä¸åŒ</strong>çš„å†…å­˜è®¿é—®æ ¡éªŒé€»è¾‘ï¼ˆè§ <em>Listing 2</em>ï¼‰ã€‚</p><div style="width:100%;margin:auto;text-align:center;"><img src="/assets/images/scholar/RustSan/listing2.png" style="width:70%;"></div><ul><li>å¯¹<strong>ä¸å®‰å…¨è®¿é—®ç‚¹</strong>ï¼Œåªè¦å½±å­å­—èŠ‚å€¼<strong>éé›¶</strong>ï¼ŒRustSan å°±æŠ¥å‘Š<strong>éæ³•è®¿é—®é”™è¯¯</strong>ï¼ˆ<em>Listing 2a</em>ï¼‰ã€‚è¿™æ„å‘³ç€ï¼šå¯¹ <strong>æ´‹çº¢è‰²ï¼ˆå®‰å…¨å¯¹è±¡ï¼‰</strong> ä¸ <strong>ç²‰è‰²ï¼ˆé‡å å¯¹è±¡ï¼‰</strong> çš„è®¿é—®éƒ½ä¼šåœ¨ sanitizer æ£€æŸ¥æ—¶è¢«å‘ç°ã€‚</li><li>å¦ä¸€æ–¹é¢ï¼Œ<strong>ä¼ªå®‰å…¨è®¿é—®ç‚¹</strong>è¢«å…è®¸è®¿é—®<strong>ç²‰è‰²çš„é‡å å¯¹è±¡</strong>ï¼Œå› æ­¤å®ƒä»¬æ—¢å¯ä»¥è®¿é—®<strong>ä¸å®‰å…¨å¯¹è±¡</strong>ï¼Œä¹Ÿå¯ä»¥è®¿é—®<strong>é‡å å¯¹è±¡</strong>ï¼ˆ<em>Listing 2b</em>ï¼‰ã€‚</li></ul><p>ç”±æ­¤ï¼Œå¯¹<strong>å®‰å…¨å¯¹è±¡</strong>çš„è®¿é—®ä¼šåœ¨<strong>ä¸å®‰å…¨</strong>ä¸<strong>ä¼ªå®‰å…¨</strong>è®¿é—®ç‚¹ä¸Šè¢«æ£€æµ‹å‡ºæ¥ã€‚</p><p>è¯·æ³¨æ„ï¼ŒRustSan åœ¨ä¼ªå®‰å…¨è®¿é—®ç‚¹ä¸Šçš„è®¾è®¡æ˜¯<strong>æœ‰æ„è¯†çš„å–èˆ</strong>ï¼šASan çš„â€œåŸºäºåœ°å€â€çš„å‡€åŒ–æ–¹å¼<strong>æ— æ³•</strong>è¿›è¡Œ<strong>ä¸Šä¸‹æ–‡æ•æ„Ÿ</strong>çš„æ£€æŸ¥ï¼Œå› ä¸ºæ²¡æœ‰å¯è¡Œçš„åŠæ³•åœ¨è¿è¡Œæ—¶åŒºåˆ†å¯¹è±¡åˆ°åº•æ²¿å“ªæ¡æ•°æ®æµè·¯å¾„ä¼ æ’­è€Œæ¥ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„è®¾è®¡é€‰æ‹©æ˜¯<strong>ç»§æ‰¿ ASan çš„å…¼å®¹æ€§ä¸æ€§èƒ½</strong>ï¼ŒåŒæ—¶åœ¨ä¼ªå®‰å…¨è®¿é—®ç‚¹ä¸Š<strong>æ”¾å®½</strong>æ£€æµ‹è¦†ç›–é¢ã€‚</p><p><strong>ä¸ ASan æ—¢æœ‰èƒ½åŠ›çš„äº’æ“ä½œï¼ˆInteroperability with existing ASan capabilitiesï¼‰ã€‚</strong><br> RustSan çš„å½±å­å†…å­˜æ–¹æ¡ˆåœ¨<strong>ä¸å®‰å…¨</strong>ä¸<strong>ä¼ªå®‰å…¨</strong>è®¿é—®ç‚¹ä¸Š<strong>å®Œæ•´ä¿ç•™</strong>äº† ASan çš„æ£€æµ‹èƒ½åŠ›ã€‚å›é¡¾ ASan çš„æ£€æµ‹æœºåˆ¶ï¼šå®ƒé€šè¿‡ä¸¤ç§æ–¹å¼åˆ©ç”¨ <strong>redzone</strong>â€”â€”ï¼ˆ1ï¼‰åœ¨å¯¹è±¡ä¹‹é—´æ’å…¥ redzone ä»¥æ£€æµ‹<strong>è¶Šç•Œ</strong>ï¼›ï¼ˆ2ï¼‰åœ¨å¯¹è±¡è¢«é‡Šæ”¾æ—¶ï¼Œä»¥ redzone <strong>ä½œåºŸå¯¹è±¡æœ¬èº«</strong>ã€‚ç”±äºï¼ˆ1ï¼‰ä¸­â€œå¯¹è±¡é—´ redzoneâ€ä¸å¯¹è±¡å®‰å…¨çº§åˆ«<strong>æ— å…³</strong>ï¼Œå› æ­¤åœ¨ä¸å®‰å…¨ä¸ä¼ªå®‰å…¨è®¿é—®ç‚¹å‘ç”Ÿçš„<strong>è¶Šç•Œ</strong>éƒ½èƒ½è¢«æ£€æµ‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€æ¬¡<strong>åˆæ³•</strong>çš„å¯¹è±¡è®¿é—®ï¼ˆå¦‚ä¼ªå®‰å…¨ç‚¹ä¸Šå¯¹é‡å æˆ–ä¸å®‰å…¨å¯¹è±¡çš„è®¿é—®ï¼‰<strong>è¶Šç•Œ</strong>è§¦ç¢°åˆ°â€œå¯¹è±¡æœ«ç«¯ redzoneâ€ï¼Œè¯¥é”™è¯¯å°±ä¼šè¢«å‘ç°å¹¶æŠ¥å‘Šã€‚</p><p>åŒæ ·åœ°ï¼Œ<strong>ä¸å®‰å…¨å¯¹è±¡</strong>ä¸<strong>é‡å å¯¹è±¡</strong>ä¹Ÿé€‚ç”¨ ASan åŸºäº<strong>éš”ç¦»åŒºï¼ˆquarantineï¼‰<strong>çš„ <strong>use-after-free</strong> æ£€æµ‹ï¼šé€šè¿‡</strong>å¯¹è±¡ä½œåºŸ</strong>å®ç°ã€‚RustSan çš„å †åˆ†é…å™¨ä¿ç•™äº† ASan åˆ†é…å™¨çš„â€œå¯¹è±¡ä½œåºŸä¸æ”¾å…¥éš”ç¦»åŒºâ€çš„æœºåˆ¶â€”â€”å³ç”¨ redzone æ ‡è®°å¯¹è±¡åœ°å€èŒƒå›´å¹¶æ”¾å…¥éš”ç¦»åˆ—è¡¨ã€‚RustSan çš„ä¸€ä¸ªå…³é”®å¢è¡¥æ˜¯ï¼šåˆ©ç”¨å½±å­å­—èŠ‚ä¸­<strong>æœªä½¿ç”¨çš„ä½</strong>æ¥è¡¨ç¤ºâ€œ<strong>éš”ç¦»çš„ä¸å®‰å…¨å¯¹è±¡</strong>â€ä¸â€œ<strong>éš”ç¦»çš„é‡å å¯¹è±¡</strong>â€ï¼ˆå‰æ–‡å·²è¿°ï¼‰ï¼Œè¿™æœ‰åŠ©äºåœ¨é”™è¯¯æ£€æµ‹æ—¶<strong>ç”Ÿæˆæ›´ä¸°å¯Œçš„æŠ¥å‘Š</strong>ï¼ˆåŒæ—¶åŒ…å«è®¿é—®ç‚¹ä¸å¯¹è±¡å®‰å…¨çº§åˆ«çš„ä¿¡æ¯ï¼‰ã€‚</p><blockquote><p>ç¬”è€…æ³¨ï¼šASanä¹Ÿèƒ½æ£€æµ‹use-after-freeï¼Œåªæ˜¯RustSanåˆ©ç”¨å½±å­å­—èŠ‚ä¸­æœªä½¿ç”¨çš„ä½ï¼Œä½¿æ£€æµ‹ç»“æœæ›´ç»†åŒ–</p></blockquote><h2 id="_7-è¯„ä¼°-evaluation" tabindex="-1"><a class="header-anchor" href="#_7-è¯„ä¼°-evaluation"><span>7. è¯„ä¼°ï¼ˆEvaluationï¼‰</span></a></h2><p>æœ¬èŠ‚æˆ‘ä»¬è¯„ä¼° <strong>RustSan</strong> çš„å®ç°ã€‚å®ç°åŸºäº <strong>LLVM 13.0.0</strong> [39] ä¸ <strong>rustc 1.66.0 nightly</strong> [46]ã€‚æ‰€æœ‰å®éªŒå‡åœ¨ä¸€å°å·¥ä½œç«™ä¸Šå®Œæˆï¼š<strong>AMD Ryzen Threadripper 3990X</strong>ï¼ˆ64 æ ¸ @ 2.9GHzï¼‰ã€<strong>256GB RAM</strong>ã€<strong>Ubuntu 20.04 LTS</strong>ã€‚</p><p>æˆ‘ä»¬ç”¨å¤§è§„æ¨¡æµ‹è¯•é›†ä»<strong>æ£€æµ‹èƒ½åŠ›</strong>ã€<strong>å¯æ‰©å±•æ€§</strong>ä¸ç›¸å¯¹ <strong>ASan</strong> çš„<strong>æ€§èƒ½æ”¹è¿›</strong>ä¸‰æ–¹é¢è¯„ä¼° <strong>RustSan</strong>ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æ„å»ºäº†å››ç±» Rust ç¨‹åºæµ‹è¯•é›†ï¼š<strong>CVE å¤ç°å®éªŒé›†</strong>ã€<strong>å¯æ‰©å±•æ€§è¯„ä¼°é›†</strong>ã€<strong>é€šç”¨æ€§èƒ½åŸºå‡†é›†</strong>ä¸<strong>æ¨¡ç³Šæµ‹è¯•åŸºå‡†é›†</strong>ã€‚<br> å…¶ä¸­ï¼Œ<strong>CVE å¤ç°å®éªŒé›†</strong>æ˜¯ä¸€äº›å«æœ‰ä¸€ä¸ªæˆ–å¤šä¸ª<strong>CVE æŠ«éœ²çš„å†…å­˜é”™è¯¯</strong>çš„ç¨‹åºç‰ˆæœ¬ï¼Œå¹¶é™„å¸¦<strong>ç¡®å®šæ€§çš„è¾“å…¥åºåˆ—</strong>æ¥è§¦å‘è¿™äº›ç¼ºé™·ã€‚æˆ‘ä»¬åœ¨ Â§7.2 ä¸­é€šè¿‡å¤ç°è¿™äº› CVE æ¥<strong>ç»éªŒæ€§éªŒè¯</strong> RustSan çš„æ£€æµ‹èƒ½åŠ›ã€‚<br><strong>å¯æ‰©å±•æ€§è¯„ä¼°é›†</strong>åŒ…å«<strong>ç›¸å¯¹è¾ƒå¤§çš„ä»£ç åº“</strong>ï¼Œæˆ‘ä»¬åœ¨ Â§7.4 ä¸­ç”¨å®ƒè¯„ä¼° RustSan çš„<strong>ç¨‹åºåˆ†æè¿‡ç¨‹</strong>åœ¨<strong>å¤§å‹ Rust MIR ä¸ LLVM IR</strong> ä¸Šçš„å¯æ‰©å±•æ€§ã€‚<br><strong>é€šç”¨æ€§èƒ½</strong>ä¸<strong>æ¨¡ç³Šæµ‹è¯•</strong>ä¸¤å¥—åŸºå‡†ç”¨äºåº¦é‡ RustSan å¯¹ç›®æ ‡ç¨‹åºå¼•å…¥çš„<strong>è¿è¡Œæ—¶å¼€é”€å˜åŒ–</strong>ï¼ˆè§ Â§7.6 ä¸ Â§7.7ï¼‰ã€‚</p><hr><h3 id="_7-1-unsafe-rust-çš„ä½¿ç”¨ç»Ÿè®¡-unsafe-rust-usage-statistics" tabindex="-1"><a class="header-anchor" href="#_7-1-unsafe-rust-çš„ä½¿ç”¨ç»Ÿè®¡-unsafe-rust-usage-statistics"><span>7.1 <code>unsafe</code> Rust çš„ä½¿ç”¨ç»Ÿè®¡ï¼ˆUnsafe Rust usage statisticsï¼‰</span></a></h3><figure><img src="/assets/images/scholar/RustSan/table1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>Table 1</strong> å±•ç¤ºäº†æˆ‘ä»¬ç”¨äºè¯„ä¼°çš„å…¨éƒ¨ Rust crates ä¸­ï¼Œ<strong>å†…å­˜è®¿é—®ç‚¹çš„å‡ºç°ä¸å®‰å…¨æ€§</strong>ç»Ÿè®¡ã€‚è¡¨ä¸­ç»™å‡ºäº†<strong>æ‰€æœ‰å†…å­˜è®¿é—®æŒ‡ä»¤</strong>ï¼ˆåŒ…æ‹¬<strong>å†…å­˜å†…å»ºæŒ‡ä»¤</strong>ï¼‰çš„æ€»æ•°ã€‚è·¨æ‰€æœ‰ crates ç»Ÿè®¡ï¼Œ<strong>ä¸å®‰å…¨è®¿é—®ç‚¹æ¯”ä¾‹</strong>ï¼ˆ<code>unsafe</code> ä»£ç å— + <strong>ä¼ªå®‰å…¨</strong>ï¼‰çš„<strong>å¹³å‡å€¼</strong>ä¸º <strong>10.24%</strong>ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œé‚£äº›<strong>éœ€è¦åŸå§‹æŒ‡é’ˆæ“ä½œ</strong>ï¼ˆå¦‚ <code>linked_list</code>ï¼‰æˆ–<strong>å¤„ç†åº•å±‚æ•°æ®</strong>ï¼ˆå¦‚ <code>string</code>ã€<code>bytes</code>ï¼‰çš„ cratesï¼Œå¾€å¾€å…·æœ‰<strong>æ›´é«˜æ¯”ä¾‹</strong>çš„ <code>unsafe Rust</code>ã€‚</p><p>è¿™ä¸€ä¸å®‰å…¨è®¿é—®ç‚¹æ¯”ä¾‹æ”¯æŒäº† <strong>RustSan</strong> çš„åŠ¨æœºä¸æ–¹æ³•ï¼š<strong>éœ€è¦ sanitizer æ£€æŸ¥</strong>çš„å†…å­˜è®¿é—®ç‚¹ï¼Œæœ€å¤šå¯è¾¾<strong>34.60%</strong>ï¼ˆ<code>vec_deque</code>ï¼‰ï¼Œè€Œæœ€ä½ä»…<strong>0.7%</strong>ï¼ˆ<code>uuid</code>ï¼‰ã€‚ä¸è¿‡ï¼Œè¿™äº›æ•°å­—<strong>å¹¶ä¸ç›´æ¥ç­‰ä»·äº</strong> RustSan èƒ½<strong>æ¶ˆé™¤çš„è¿è¡Œæ—¶å¼€é”€</strong>ï¼Œå› ä¸ºå®é™…æ€§èƒ½è¿˜å–å†³äº<strong>ç¨‹åºæ‰§è¡ŒæœŸé—´å®é™…é‡åˆ°çš„æ£€æŸ¥æ¬¡æ•°</strong>ã€‚å…³äºè¿è¡Œæ—¶å¼€é”€é™ä½ï¼Œæˆ‘ä»¬åœ¨åæ–‡çš„ <strong>crate åŸºå‡†</strong>ï¼ˆÂ§7.6ï¼‰ä¸<strong>æ¨¡ç³Šæµ‹è¯•å®éªŒ</strong>ï¼ˆÂ§7.7ï¼‰ä¸­è¯¦ç»†è®¨è®ºã€‚</p><hr><h3 id="_7-2-æ£€æµ‹èƒ½åŠ›-é€‰æ‹©æ€§æ’æ¡©çš„ç¨³å¥æ€§-detection-capability-robustness-of-selective-instrumentation" tabindex="-1"><a class="header-anchor" href="#_7-2-æ£€æµ‹èƒ½åŠ›-é€‰æ‹©æ€§æ’æ¡©çš„ç¨³å¥æ€§-detection-capability-robustness-of-selective-instrumentation"><span>7.2 æ£€æµ‹èƒ½åŠ›ï¼šé€‰æ‹©æ€§æ’æ¡©çš„ç¨³å¥æ€§ï¼ˆDetection capability: robustness of selective instrumentationï¼‰</span></a></h3><p>å›´ç»•æ£€æµ‹èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯¹ <strong>RustSan</strong> å¯èƒ½çš„<strong>æ¼æŠ¥ï¼ˆfalse negativesï¼‰<strong>è¿›è¡Œç»éªŒæ€§éªŒè¯ï¼›æ¢è¨€ä¹‹ï¼Œæˆ‘ä»¬éªŒè¯ <strong>RustSan</strong> æ‰€</strong>ç§»é™¤çš„æ£€æŸ¥</strong>ä¸ä¼šå¯¼è‡´<strong>æ¼æŠ¥</strong>ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬é€‰å–äº†<strong>31</strong> ä¸ªå¯è¢« <strong>ASan</strong> æ£€å‡ºçš„<strong>å†…å­˜ç›¸å…³ CVE</strong>ï¼Œå¹¶ç”¨ <strong>RustSan</strong> å¤ç°è¿™äº›ç»“æœã€‚</p><p><strong>CVE æµ‹è¯•é›†æ”¶é›†ï¼ˆCVE test set collectionï¼‰ã€‚</strong><br> æˆ‘ä»¬ä»å¸¸è§ Rust ç¨‹åºä¸­æ”¶é›†äº†ä¸€æ‰¹å¯å¤ç°ã€ä¸”å¯è¢« <strong>ASan</strong> æ£€æµ‹çš„<strong>CVE çº§å†…å­˜æ¼æ´</strong>æµ‹è¯•ç”¨ä¾‹ã€‚æ¼æ´æ¥æºäº <strong>RustSec Advisory Database</strong> [55]ï¼ˆå…¶ä¸­æ±‡æ€»äº†æ¥è‡ª <strong>crates.io</strong> çš„ Rust ç¨‹åº CVE æŠ¥å‘Šï¼‰ã€‚æˆ‘ä»¬æ”¶é›†äº†æ•°æ®åº“ä¸­<strong>å…¨éƒ¨ 408 æ¡</strong> CVEï¼Œå¹¶è¯„ä¼°å…¶<strong>å¯å¤ç°æ€§</strong>ã€‚åœ¨è¿™ 408 æ¡ä¸­ï¼Œä¾æ®æ•°æ®åº“é‡Œçš„ç±»åˆ«å­—æ®µï¼Œæˆ‘ä»¬è¯†åˆ«å‡º<strong>227 æ¡</strong>ä¸º<strong>å†…å­˜ç›¸å…³æ¼æ´</strong>ï¼›å…¶ä¸­ <strong>91 æ¡</strong>åŒ…å«<strong>å¯å¤ç°æ¼æ´çš„ PoC ä»£ç </strong>ï¼Œ<strong>52 æ¡</strong>èƒ½è¢« <strong>ASan</strong> æˆåŠŸæ£€æµ‹ã€‚<strong>RustSan</strong> åŒæ ·<strong>å…¨éƒ¨æ£€å‡º</strong>äº†è¿™ <strong>52</strong> ä¸ªæ¡ˆä¾‹ã€‚</p><blockquote><p>ç¬”è€…æ³¨ï¼šå¯ä»¥å­¦ä¸€ä¸‹æ€ä¹ˆå»æ‰¾CVE</p></blockquote><p><strong>æ£€æµ‹ç»“æœï¼ˆDetection resultsï¼‰ã€‚</strong><br><strong>è¡¨2</strong> é‡ç‚¹åˆ—å‡ºäº† 52 ä¸ªå¤ç°æ¡ˆä¾‹ä¸­çš„ <strong>31</strong> ä¸ªï¼Œç”¨ä»¥å±•ç¤º <strong>RustSan</strong> çš„<strong>ç¨³å¥æ€§</strong>ã€‚è¿™äº›æ¡ˆä¾‹æ˜¯é€šè¿‡<strong>å†…è”çš„å½±å­å†…å­˜æ£€æŸ¥</strong>ï¼ˆå— RustSan çš„<strong>é€‰æ‹©æ€§æ’æ¡©</strong>æ§åˆ¶ï¼‰æ£€å‡ºçš„ã€‚å°½ç®¡ <strong>RustSan</strong> <strong>å¤§å¹…å‡å°‘</strong>äº† Rust ç¨‹åºä¸­çš„å½±å­å†…å­˜æ£€æŸ¥ï¼ˆè§ <strong>Table 1</strong>ï¼‰ï¼Œä½†<strong>æ‰€æœ‰ CVE æ¡ˆä¾‹</strong>éƒ½<strong>æˆåŠŸæ£€å‡º</strong>ã€‚å¦å¤– <strong>21</strong> ä¸ªæœªåœ¨ <strong>Table 2</strong> åˆ—å‡ºçš„å¤ç°æ¡ˆä¾‹ï¼ˆå¦‚<strong>åŒé‡é‡Šæ”¾</strong>ï¼‰ï¼Œæ˜¯é€šè¿‡<strong>æ‹¦æˆªæ ‡å‡†åº“è°ƒç”¨</strong>ï¼ˆä¾‹å¦‚ <code>free</code>ï¼‰æ¥æ£€æµ‹çš„ï¼›è¿™éƒ¨åˆ†ä¸å— <strong>RustSan</strong> çš„â€œæ£€æŸ¥æ¶ˆé™¤â€å½±å“ï¼Œå› è€Œå¦‚é¢„æœŸèˆ¬è¢« <strong>RustSan</strong> æ£€å‡ºã€‚</p><div style="width:100%;margin:auto;text-align:center;"><img src="/assets/images/scholar/RustSan/table2.png" style="width:50%;"></div><p><strong>ä¼ªå®‰å…¨è®¿é—®ç‚¹ä¸­çš„å†…å­˜é”™è¯¯ï¼ˆMemory errors in false-safe sitesï¼‰ã€‚</strong><br><strong>Table 2</strong> çš„ <strong>FS/U*</strong> åˆ—æ˜¾ç¤ºï¼š31 ä¸ªå¤ç°çš„å†…å­˜é”™è¯¯ä¸­ï¼Œæœ‰ <strong>21 ä¸ª</strong>æ˜¯<strong>åœ¨ä¼ªå®‰å…¨è®¿é—®ç‚¹</strong>è¢«æ£€æµ‹åˆ°çš„ã€‚æˆ‘ä»¬è¿˜åœ¨ <code>unsafe</code> å†…éƒ¨çš„å†…å­˜æŒ‡ä»¤ä¸Š<strong>é¢å¤–æ”¾ç½®æ’æ¡©</strong>ï¼Œç”±æ­¤è¯†åˆ«å‡º <strong>10</strong> ä¸ª<strong>ä½äº <code>unsafe</code> å†…éƒ¨</strong>çš„æ¡ˆä¾‹ã€‚å¤§é‡<strong>å‘ç”Ÿåœ¨ä¼ªå®‰å…¨å†…å­˜æŒ‡ä»¤</strong>ä¸Šçš„é”™è¯¯ï¼Œè¿›ä¸€æ­¥å°è¯äº† <strong>RustSan</strong> å¯¹<strong>ä¼ªå®‰å…¨è®¿é—®ç‚¹è¯†åˆ«</strong>çš„<strong>å‡†ç¡®æ€§</strong>ï¼Œä»¥åŠæ‰€æ”¹é€ çš„<strong>å½±å­å†…å­˜æ–¹æ¡ˆ</strong>çš„<strong>æ­£ç¡®æ€§</strong>ã€‚æˆ‘ä»¬å¯¹è¿™ 21 ä¸ªä¼ªå®‰å…¨æ¡ˆä¾‹ä¸­çš„éƒ¨åˆ† CVE åšäº†<strong>äººå·¥å¤æ ¸</strong>ï¼›ä¾‹å¦‚åœ¨<strong>é™„å½• Aï¼ˆAppendix Aï¼‰<strong>ä¸­ï¼Œæˆ‘ä»¬ç»™å‡ºäº†ä¸€ä¸ª</strong>å †æº¢å‡º</strong>ï¼ˆCVE-2018-21000ï¼‰ä¸ä¸€ä¸ª <strong>use-after-free</strong>ï¼ˆCVE-2021-45713ï¼‰çš„<strong>ä»£ç ç¤ºä¾‹</strong>ã€‚</p><h3 id="_7-3-æ£€æµ‹èƒ½åŠ›-è·¨å®‰å…¨çº§åˆ«çš„å¯¹è±¡è®¿é—®-detection-capability-cross-safety-object-access" tabindex="-1"><a class="header-anchor" href="#_7-3-æ£€æµ‹èƒ½åŠ›-è·¨å®‰å…¨çº§åˆ«çš„å¯¹è±¡è®¿é—®-detection-capability-cross-safety-object-access"><span>7.3 æ£€æµ‹èƒ½åŠ›ï¼šè·¨å®‰å…¨çº§åˆ«çš„å¯¹è±¡è®¿é—®ï¼ˆDetection capability: cross-safety object accessï¼‰</span></a></h3><p>æœ¬èŠ‚è¯„ä¼° <strong>RustSan</strong> çš„ç‹¬æœ‰èƒ½åŠ›â€”â€”Â§6.2 æ‰€è¿°çš„<strong>å¯¹å®‰å…¨å¯¹è±¡è®¿é—®çš„æ£€æµ‹</strong>ã€‚æˆ‘ä»¬å‡†å¤‡äº†ä¸¤ä¸ª<strong>åˆæˆç¤ºä¾‹</strong>ï¼Œå±•ç¤ºæ¥è‡ª <strong>unsafe</strong> ä¸ <strong>false-safe</strong> ä½ç½®å¯¹<strong>å®‰å…¨å¯¹è±¡</strong>è¿›è¡Œç ´åçš„æƒ…å½¢ï¼ˆè§ <em>Listing 3</em>ï¼‰ã€‚</p><div style="width:100%;margin:auto;text-align:center;"><img src="/assets/images/scholar/RustSan/listing3.png" style="width:70%;"></div><p>ä¹‹æ‰€ä»¥é‡‡ç”¨åˆæˆç¤ºä¾‹è€Œä¸æ˜¯çœŸå®æ¼æ´ï¼Œæ˜¯å› ä¸ºçœŸå®æ¡ˆä¾‹å¾€å¾€<strong>éš¾ä»¥å®šä½ä¸å¤ç°</strong>ã€‚è®¸å¤šçœŸå®ä¸–ç•Œçš„å†…å­˜é”™è¯¯æ˜¯é€šè¿‡ ASan çš„<strong>å¯¹è±¡é—´ redzoneï¼ˆinter-object redzonesï¼‰<strong>é¦–å…ˆè¢«å‘ç°çš„ã€‚æˆ‘ä»¬å‘ç°ï¼šå¦‚æœä¸€ä¸ªé”™è¯¯å‘ç”Ÿåœ¨ <strong>unsafe</strong> æˆ– <strong>false-safe</strong> è®¿é—®ç‚¹ï¼Œå¹¶ä¸”</strong>ä¸è§¦ç¢°ä»»ä½•å¯¹è±¡é—´ redzone</strong>ï¼Œè€Œåªæ˜¯<strong>ç ´åäº†å®‰å…¨å¯¹è±¡çš„å†…å®¹</strong>ï¼ˆå³<strong>å¯¹è±¡å†…éƒ¨ç ´åï¼Œintra-object corruption</strong>ï¼‰ï¼Œåˆ™ ASan å¾€å¾€<strong>ä¸ä¼šæŠ¥è­¦</strong>ï¼Œè€Œä¸”è¿™æ ·çš„çœŸå®æ¡ˆä¾‹è¿‡äº<strong>ç‰¹å®š</strong>ã€éš¾ä»¥è¯†åˆ«ä¸å¤ç°ã€‚ä¸¤ä¸ªç¤ºä¾‹å‡å—åˆ°çœŸå® CVEï¼ˆCVE-2017-1000430 ä¸ CVE-2018-21000ï¼‰çš„å¯å‘ï¼Œå¹¶åšäº†è½»å¾®æ”¹åŠ¨ï¼Œä½¿æ”»å‡»è€…å¯ä»¥å¯¹<strong>å®‰å…¨å¯¹è±¡</strong>ä»»æ„è¿›è¡Œå†…å­˜ç ´åã€‚åœ¨ <em>Listing 3a</em> ä¸ <em>Listing 3b</em> ä¸­ï¼Œæ”»å‡»è€…åˆ†åˆ«å¯ä»¥åœ¨ <strong>unsafe</strong> ä¸ <strong>false-safe</strong> è®¿é—®ç‚¹å¤„æ§åˆ¶å‡½æ•°å®å‚ï¼Œä½¿å…¶æŒ‡å‘<strong>å®‰å…¨å¯¹è±¡</strong>ã€‚</p><p>è¿™äº›æ¡ˆä¾‹<strong>ä¸ä¸€å®š</strong>è§¦ç¢° redzoneï¼Œä½†èƒ½å¤Ÿåªç ´å<strong>å®‰å…¨å¯¹è±¡çš„å†…å®¹</strong>ã€‚è¿™äº›ç¤ºä¾‹è¯´æ˜äº† <strong>RustSan</strong> çš„<strong>è·¨å®‰å…¨çº§åˆ«å†…å­˜è®¿é—®æ£€æµ‹</strong>ï¼š<strong>æœªæ”¹é€ çš„ ASan</strong> æ— æ³•æ£€æµ‹åˆ°è¿™ç±»é”™è¯¯ï¼Œè€Œ <strong>RustSan</strong> é€šè¿‡æ‰©å±• ASanï¼Œå…·å¤‡äº†æ£€æµ‹<strong>Rust ç‰¹æœ‰</strong>æ–°ç±»åˆ«å†…å­˜é”™è¯¯çš„èƒ½åŠ›ã€‚</p><blockquote><p>ç¬”è€…æ³¨ï¼šä¸è¶Šç•Œï¼Œåªæ˜¯é€šè¿‡è®©ä¼ªå®‰å…¨/ä¸å®‰å…¨çš„è®¿é—®ç‚¹æŒ‡å‘å®‰å…¨å¯¹è±¡ï¼Œä»è€Œåªç ´åå®‰å…¨å¯¹è±¡çš„å†…å®¹</p></blockquote><hr><h3 id="_7-4-ä½¿ç”¨-rustsan-çš„ç¼–è¯‘æ—¶é—´-compile-time-with-rustsan" tabindex="-1"><a class="header-anchor" href="#_7-4-ä½¿ç”¨-rustsan-çš„ç¼–è¯‘æ—¶é—´-compile-time-with-rustsan"><span>7.4 ä½¿ç”¨ RustSan çš„ç¼–è¯‘æ—¶é—´ï¼ˆCompile time with RustSanï¼‰</span></a></h3><p>æˆ‘ä»¬æ¥ä¸‹æ¥åœ¨<strong>è¾ƒå¤§çš„ Rust crates</strong> ä¸Šæµ‹é‡ <strong>RustSan</strong> çš„<strong>ç¼–è¯‘æ—¶é—´</strong>ï¼Œä»¥è¯„ä¼°å…¶å¯æ‰©å±•æ€§ã€‚</p><p><strong>å¯æ‰©å±•æ€§æµ‹è¯•é›†æ”¶é›†ã€‚</strong><br> æˆ‘ä»¬åŸºäº crate çš„<strong>å—æ¬¢è¿ç¨‹åº¦</strong>ï¼ˆä¾‹å¦‚ Github â˜…â‰¥1 ä¸‡ï¼‰ä»¥åŠ<strong>ä»£ç è§„æ¨¡</strong>é€‰æ‹©äº† 9 ä¸ª crateã€‚<strong>è¡¨3</strong> å±•ç¤ºäº†å¯æ‰©å±•æ€§é›†åˆä¸­å¤§å‹ç¨‹åºçš„ <strong>RustSan</strong> ç¼–è¯‘æ—¶é—´ã€‚</p><figure><img src="/assets/images/scholar/RustSan/table3.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>ç»“æœè®¨è®ºã€‚</strong><br> æ•´ä½“è€Œè¨€ï¼Œ<strong>RustSan</strong> å°†è¿™äº› crate çš„<strong>ç¼–è¯‘æ—¶é—´</strong>æå‡ä¸º<strong>åŸæ¥çš„ 19.50Ã—</strong>ã€‚å…¶ä¸­ <strong>wasmtime</strong>ï¼ˆWebAssembly è§£é‡Šå™¨ï¼‰äº§ç”Ÿçš„<strong>æ•´ç¨‹åº LLVM IR</strong> æœ€å¤§ï¼Œå¤§å°ä¸º <strong>2253MB</strong>ï¼›ä½¿ç”¨ <strong>RustSan</strong> çš„ç¼–è¯‘è€—æ—¶ <strong>29 åˆ† 56 ç§’</strong>ï¼Œæ¯”å¸¦æ’æ¡©çš„<strong>å¸¸è§„æ„å»º</strong>æ…¢ <strong>30.45Ã—</strong>ã€‚ç¬¬äºŒå¤§çš„æ˜¯ <strong>RustPython</strong>ï¼Œå…¶ <strong>LLVM IR</strong> ä¸º <strong>2127MB</strong>ã€ç¼–è¯‘è€—æ—¶ <strong>1688sï¼ˆ28 åˆ† 8 ç§’ï¼‰</strong>ï¼Œç›¸å½“äºå¸¸è§„æ„å»ºçš„ <strong>24.82Ã—</strong>ã€‚</p><blockquote><p>ç¬”è€…æ³¨ï¼šè™½ç„¶ç¼–è¯‘æ—¶é—´çš„å¢é•¿éå¸¸ææ€–ï¼Œä½†ç¼–è¯‘å®Œçš„ç¨‹åºåœ¨è·‘æµ‹è¯•æ—¶å¾€å¾€ä»¥å¤©ä¸ºå•ä½è·‘ï¼Œç”¨è¾ƒé•¿çš„ç¼–è¯‘æ—¶é—´æ¢å–ç¼–è¯‘åç¨‹åºçš„æ€§èƒ½æå‡æœ‰ä¸€å®šæ„ä¹‰ã€‚</p></blockquote><p>æˆ‘ä»¬è®¤ä¸ºï¼Œå³ä¾¿å¯¹å¤§ç¨‹åºï¼Œ<strong>RustSan</strong> çš„è®¡ç®—å¤æ‚åº¦ä»åœ¨<strong>å¯æ¥å—èŒƒå›´</strong>ã€‚ä¸€ä¸ªä¿ƒæˆå› ç´ æ˜¯ HIR/MIR å±‚çš„<strong>ç²¾ç‚¼ä¿¡æ¯æŠ½å–</strong>ï¼šä¸æ—¢æœ‰å·¥ä½œ [38] ç›¸æ¯”ï¼Œæˆ‘ä»¬æŠŠ<strong>æ±¡ç‚¹æºæ•°é‡</strong>ï¼ˆå°† Â§4 ä¸­çš„ <strong>I2</strong> ä» Â§4b çš„è§„æ¨¡ï¼‰åœ¨å®éªŒä¸­<strong>é™ä½äº† 12.86%</strong>ï¼ˆè¯¦è§<strong>é™„å½• B</strong>ï¼‰ã€‚</p><p>è€ƒè™‘åˆ° <strong>RustSan</strong> é¢å‘çš„å…¸å‹<strong>åŠ¨æ€æµ‹è¯•åœºæ™¯</strong>ï¼Œåœ¨æµ‹è¯•å‰å¯¹ç›®æ ‡ç¨‹åºç”¨ <strong>RustSan</strong> è¿›è¡Œä¸€æ¬¡æ„å»ºçš„<strong>é¢å¤–æˆæœ¬</strong>æ˜¯<strong>å¯æ‰¿å—çš„</strong>ã€‚TRust [15] æåˆ°å…¶å¤„ç†è¶…å¤§ç¨‹åºçš„ç­–ç•¥æ˜¯<strong>å›é€€åˆ°ç²¾åº¦è¾ƒä½çš„ä¸Šä¸‹æ–‡æ•æ„Ÿåˆ†æ</strong>ï¼›è¯¥å·¥ä½œåœ¨è¯„ä¼°ä¸­ä»¥ <strong>tokio</strong> ä¸ <strong>hyper</strong> ä½œä¸ºå¤§å‹ç¨‹åºçš„ç¤ºä¾‹ï¼ˆäºŒè€…ä¹ŸåŒ…å«åœ¨æˆ‘ä»¬çš„ <strong>Table 3</strong> ä¸­ï¼‰ã€‚ç”±äºå…¶å®ç°æ’°å†™æ—¶å°šæœªå…¬å¼€ï¼Œéš¾ä»¥è¿›è¡Œ<strong>ç›´æ¥å¯¹æ¯”</strong>ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å±•ç¤ºäº† <strong>RustSan</strong> å¯ä»¥ç”¨<strong>å¯ç®¡ç†çš„ç¼–è¯‘æ—¶é—´</strong>æ„å»º<strong>æ›´å¤§è§„æ¨¡</strong>çš„ç¨‹åºã€‚</p><blockquote><p>ç¬”è€…æ³¨ï¼šæ„æ€æ˜¯æ¯”TRustå¥½ç‚¹ï¼Ÿæ€ä¹ˆä¸è·Ÿbaseline ASanæ¯”ï¼Œä½•æ„å‘³ï¼Ÿ</p></blockquote><h3 id="_7-5-å¾®åŸºå‡†-microbenchmarks" tabindex="-1"><a class="header-anchor" href="#_7-5-å¾®åŸºå‡†-microbenchmarks"><span>7.5 å¾®åŸºå‡†ï¼ˆMicrobenchmarksï¼‰</span></a></h3><p>æˆ‘ä»¬é’ˆå¯¹ <strong>RustSan</strong> çš„â€œæ„ŸçŸ¥å®‰å…¨æ€§çš„å½±å­å†…å­˜æ–¹æ¡ˆâ€å’Œâ€œæ”¹é€ åçš„å †åˆ†é…å™¨â€åšäº†å¾®åŸºå‡†æµ‹è¯•ã€‚å¯¹è¿™ä¸¤ä¸ªç»„ä»¶å¼€é”€çš„ç»†åŒ–è§‚å¯Ÿï¼Œæœ‰åŠ©äºç†è§£éšååœ¨æœ¬èŠ‚ååŠéƒ¨åˆ†ç»™å‡ºçš„é€šç”¨åº”ç”¨ä¸æ¨¡ç³Šæµ‹è¯•åŸºå‡†ç»“æœã€‚</p><p><strong>å½±å­å†…å­˜æ£€æŸ¥ã€‚</strong><br><strong>RustSan</strong> çš„å½±å­å†…å­˜æ–¹æ¡ˆåœ¨<strong>ä¼ªå®‰å…¨è®¿é—®ç‚¹</strong>ä¸Šå¼•å…¥äº†ä¸€æ­¥é¢å¤–çš„<strong>å½±å­å­—èŠ‚æ©ç </strong>æ“ä½œï¼ˆè§ <em>Listing 2b</em>ï¼‰ã€‚å› æ­¤ï¼Œå°½ç®¡ <strong>RustSan</strong> é€šè¿‡<strong>æ¶ˆé™¤æ£€æŸ¥</strong>æ˜¾è‘—æå‡äº†å‡€åŒ–å™¨ï¼ˆsanitizerï¼‰çš„è¿è¡Œæ€§èƒ½ï¼Œä½†å…¶åœ¨ä¼ªå®‰å…¨è®¿é—®ç‚¹ä¸Šçš„æ£€æŸ¥<strong>å¯èƒ½</strong>å¸¦æ¥å°‘é‡é¢å¤–å¼€é”€ã€‚ä¸ºäº†æµ‹é‡æ­¤ç±»â€œ<strong>å…ˆæ©ç ã€å†åˆ†æ”¯</strong>ï¼ˆmask-then-branchï¼‰â€æ£€æŸ¥çš„<strong>ç‹¬ç«‹</strong>å¼€é”€ï¼Œæˆ‘ä»¬å°† <strong>nbench</strong> [52] ç¼–è¯‘ä¸ºä¸¤ä¸ªç‰ˆæœ¬ï¼šä¸€ä¸ªä½¿ç”¨<strong>æœªæ”¹é€ çš„ ASan</strong>ï¼Œå¦ä¸€ä¸ªä½¿ç”¨<strong>ç†è®ºä¸Šçš„æœ€åæƒ…å½¢ RustSan</strong>ã€‚æ‰€è°“æœ€åæƒ…å½¢ï¼Œæ˜¯æŒ‡ <strong>RustSan</strong> åœ¨<strong>æ‰€æœ‰</strong>å†…å­˜è®¿é—®ç‚¹éƒ½æ’å…¥ä¼ªå®‰å…¨è®¿é—®ç‚¹é‚£æ ·çš„â€œmask-then-branch æ£€æŸ¥â€ï¼Œå¹¶ä¸”<strong>ä¸</strong>è¿›è¡Œä»»ä½•æ£€æŸ¥æ¶ˆé™¤ã€‚<strong>å›¾4</strong> æ˜¾ç¤ºäº†æœ€åæƒ…å½¢ <strong>RustSan</strong> ä¸æœªæ”¹é€  <strong>ASan</strong> çš„å¯¹æ¯”ï¼šå¹³å‡è€Œè¨€ï¼ŒASan ç‰ˆæœ¬çš„<strong>è¿è¡Œæ—¶å¼€é”€</strong>ä¸º <strong>2.06Ã—</strong>ï¼Œè€Œç†è®ºæœ€åæƒ…å½¢çš„ <strong>RustSan</strong> ç‰ˆæœ¬ä¸º <strong>2.08Ã—</strong>ã€‚å®éªŒè¡¨æ˜ï¼Œ<strong>ä¼ªå®‰å…¨è®¿é—®ç‚¹æ£€æŸ¥</strong>å¸¦æ¥çš„<strong>æ€§èƒ½å¼€é”€æå°</strong>ã€‚</p><figure><img src="/assets/images/scholar/RustSan/figure4.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>å †åˆ†é…å™¨ã€‚</strong><br> æˆ‘ä»¬çš„åŸºå‡†æ˜¾ç¤ºï¼š<strong>RustSan</strong> çš„å †åˆ†é…å™¨åœ¨ <strong>ASan</strong> çš„åŸºç¡€ä¸Š<strong>é¢å¤–</strong>å¼•å…¥äº† <strong>5.52%</strong> çš„å¼€é”€ã€‚é‰´äºå…¶å¼€é”€å¾ˆå°ä¸”å®éªŒæ–¹æ³•ç›´è§‚ï¼Œæˆ‘ä»¬å°†è¯¦ç»†è®¨è®ºæ”¾åœ¨<strong>é™„å½• C</strong>ã€‚</p><hr><h3 id="_7-6-é€šç”¨åº”ç”¨ä¸­çš„è¿è¡Œæ—¶å¼€é”€-runtime-overhead-in-general-applications" tabindex="-1"><a class="header-anchor" href="#_7-6-é€šç”¨åº”ç”¨ä¸­çš„è¿è¡Œæ—¶å¼€é”€-runtime-overhead-in-general-applications"><span>7.6 é€šç”¨åº”ç”¨ä¸­çš„è¿è¡Œæ—¶å¼€é”€ï¼ˆRuntime overhead in general applicationsï¼‰</span></a></h3><p>æˆ‘ä»¬ç”¨å„ä¸ª crate è‡ªå¸¦çš„åŸºå‡†é›†ï¼ˆå³ <code>cargo bench</code>ï¼‰ï¼Œå¯¹æ¯”æµ‹é‡ <strong>RustSan</strong> ç›¸å¯¹ <strong>ASan</strong> åœ¨<strong>é€šç”¨ Rust ç¨‹åº</strong>ä¸­çš„è¿è¡Œæ—¶å¼€é”€ã€‚</p><p><strong>é€šç”¨åº”ç”¨åŸºå‡†é›†æ”¶é›†ã€‚</strong><br> æˆ‘ä»¬ä» <strong>Crates.io</strong> [20] æ”¶é›†äº†<strong>ä¸‹è½½é‡æœ€é«˜</strong>çš„ Rust ç¨‹åºï¼Œå¹¶å‚è€ƒäº†æ—¢æœ‰å·¥ä½œçš„è¢«åŸºå‡†åŒ–ç¨‹åº [15, 38]ã€‚æˆ‘ä»¬å¯¹è¿™äº›åŸºå‡†é€ä¸€è¿›è¡Œ<strong>äººå·¥éªŒè¯</strong>ï¼Œç¡®ä¿å…¶èƒ½å¤Ÿ<strong>æ­£ç¡®è¿è¡Œ</strong>å¹¶äº§ç”Ÿ<strong>å•ä¸€æ•°å€¼</strong>ï¼Œä¾¿äºç›´æ¥æ¯”è¾ƒ <strong>RustSan</strong> ä¸ <strong>ASan</strong> çš„æ€§èƒ½ã€‚</p><p><strong>åŸºå‡†ç»“æœã€‚</strong><br><strong>å›¾5</strong> æ¯”è¾ƒäº† <strong>ASan</strong> ä¸ <strong>RustSan</strong> çš„<strong>è¿è¡Œæ—¶å¼€é”€</strong>ï¼šå°†å®ŒæˆåŸºå‡†æ‰€ç”¨çš„å¹³å‡æ‰§è¡Œæ—¶é—´<strong>å½’ä¸€åŒ–</strong>åˆ°æœªæ’æ¡©ç‰ˆæœ¬ã€‚ç»“æœæ˜¾ç¤ºï¼ŒASan çš„<strong>å¹³å‡å½’ä¸€åŒ–æ‰§è¡Œæ—¶é—´</strong>ä¸º <strong>2.40Ã—</strong>ï¼ˆå³ <strong>+140.3%</strong> å¼€é”€ï¼‰ï¼Œè€Œ <strong>RustSan</strong> ä¸º <strong>1.53Ã—</strong>ï¼ˆå³ <strong>+52.9%</strong> å¼€é”€ï¼‰ï¼Œ<strong>RustSan å¹³å‡å°†å¼€é”€é™ä½è‡³ 62.3%</strong>ã€‚ä¸ºéªŒè¯æ€§èƒ½æå‡ç¡®ç”±â€œæ¶ˆé™¤æ£€æŸ¥â€å¸¦æ¥ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæŒ‡æ ‡ <strong>sanitizer æ£€æŸ¥å‘½ä¸­å‡å°‘ç‡</strong>ï¼ˆ<strong>Check Hit Decr. (%)</strong>ï¼Œè§å›¾ 5ï¼‰ï¼šè¯¥æŒ‡æ ‡è¡¨ç¤º <strong>ASan</strong> è¿è¡ŒæœŸçš„<strong>sanitizer å‘½ä¸­æ¬¡æ•°</strong>ä¸­ï¼Œæœ‰å¤šå°‘<strong>è¢« RustSan æ¶ˆé™¤äº†</strong>ã€‚æˆ‘ä»¬ç¡®è®¤<strong>æ€§èƒ½æå‡ä¸è¯¥æŒ‡æ ‡è¿‘ä¼¼æˆæ­£æ¯”</strong>ã€‚</p><figure><img src="/assets/images/scholar/RustSan/figure5.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>åœ¨å„ä¸ª crate ä¸­ï¼Œ<strong>å¼€é”€ä¸‹é™å¹…åº¦æœ€å¤§</strong>çš„æ˜¯ <strong>adler</strong>ï¼šASan æ’æ¡©ç‰ˆæœ¬çš„<strong>è¿è¡Œé€Ÿåº¦</strong>ä¸‹é™ <strong>5.4Ã—</strong>ï¼Œè€Œ <strong>RustSan</strong> <strong>ç§»é™¤äº† 100% çš„æ£€æŸ¥</strong>ï¼Œå‡ ä¹è¾¾åˆ°äº†<strong>æ¥è¿‘åŸç”Ÿ</strong>çš„é€Ÿåº¦ã€‚å¦ä¸€æ–¹é¢ï¼Œéƒ¨åˆ† crate çš„ ASan å¼€é”€<strong>å‡ ä¹æ²¡æœ‰ä¸‹é™</strong>ï¼Œä¾‹å¦‚ <code>vec_deque</code> ä¸ <code>vec</code>ã€‚æˆ‘ä»¬æ¨æµ‹è¿™äº›ç¨‹åºåœ¨è¿è¡Œæ—¶<strong>æå°‘é‡åˆ°</strong>ä¸å®‰å…¨æˆ–ä¼ªå®‰å…¨è®¿é—®ç‚¹ï¼Œå› æ­¤<strong>éš¾ä»¥ä» RustSan çš„â€œæ£€æŸ¥ç§»é™¤â€ä¸­è·ç›Š</strong>ã€‚</p><p>åœ¨è¢«è¯„æµ‹çš„ crates ä¸­ï¼Œ<strong>wasmtime</strong> ä¸ <strong>RustPython</strong> å±äº Rust ç”Ÿæ€ä¸­<strong>æœ€å¤æ‚ä¸”è§„æ¨¡è¾ƒå¤§</strong>çš„é¡¹ç›®ï¼ˆä¸¤è€…ä¹ŸåŒ…å«åœ¨æˆ‘ä»¬çš„å¯æ‰©å±•æ€§é›†åˆé‡Œï¼‰ã€‚å®éªŒå› æ­¤ä¹Ÿè¡¨æ˜ï¼š<strong>RustSan</strong> åœ¨<strong>å¤§å‹ Rust ç¨‹åº</strong>ä¸Šæ˜¯<strong>å¯è¡Œ</strong>çš„ï¼Œæ›´ä¸ç”¨è¯´å…¶<strong>æ˜¾è‘—çš„æ€§èƒ½æ”¹è¿›</strong>ï¼ˆç›¸å¯¹ ASan åˆ†åˆ«æå‡ <strong>64%</strong> ä¸ <strong>63%</strong>ï¼‰ã€‚</p><p>é™¤äº†æ€§èƒ½ä¹‹å¤–ï¼Œè¿™äº› crates åœ¨åŸºå‡†æ‰§è¡ŒæœŸé—´<strong>æ²¡æœ‰å‡ºç°</strong>å›  <strong>RustSan</strong> å¯¼è‡´çš„<strong>è¯¯æŠ¥</strong>è€Œå¼•å‘çš„<strong>ç¨‹åºå´©æºƒ</strong>ã€‚</p><h3 id="_7-7-æ¨¡ç³Šæµ‹è¯•-fuzzing" tabindex="-1"><a class="header-anchor" href="#_7-7-æ¨¡ç³Šæµ‹è¯•-fuzzing"><span>7.7 æ¨¡ç³Šæµ‹è¯•ï¼ˆFuzzingï¼‰</span></a></h3><p>æˆ‘ä»¬è¿›ä¸€æ­¥åœ¨æ¨¡ç³Šæµ‹è¯•åœºæ™¯ä¸‹è€ƒå¯Ÿ <strong>RustSan</strong> ç›¸å¯¹ <strong>ASan</strong> çš„æ€§èƒ½æ”¶ç›Šã€‚</p><p><strong>æ¨¡ç³Šæµ‹è¯•é›†æ”¶é›†ã€‚</strong><br> æˆ‘ä»¬ä» Rust çš„ trophy-case [13] ä¸­æŒ‘é€‰ç›®æ ‡ç¨‹åºï¼Œé€‰å–<strong>å·²æŠ¥å‘Šç¼ºé™·æ•°æœ€å¤š</strong>ä¸”<strong>è‡ªå¸¦ fuzzing harness</strong> çš„å‰å…­ä¸ª crateã€‚</p><p><strong>æ€§èƒ½åº¦é‡ã€‚</strong><br> ä¸é€šç”¨åº”ç”¨åŸºå‡†ç›¸åŒï¼Œæˆ‘ä»¬åˆ†åˆ«ç”¨ <strong>RustSan</strong> ä¸ <strong>ASan</strong> ç¼–è¯‘è¿™äº› crateã€‚éšåï¼Œä½¿ç”¨ <strong>AFL++</strong> [23] 4.05c ç‰ˆæœ¬å¯¹æ¯ä¸ª crate çš„ä¸¤ä¸ªç‰ˆæœ¬åˆ†åˆ«è¿›è¡Œ <strong>24 å°æ—¶</strong>çš„ fuzzã€‚æˆ‘ä»¬ä½¿ç”¨å„ crate è‡ªå¸¦çš„ harness ä¸ç§å­é›†ã€‚æˆ‘ä»¬ä»¥<strong>æ¯ç§’æ‰§è¡Œæ¬¡æ•°ï¼ˆrun executions per secondï¼‰<strong>è¿™ä¸€æ¨¡ç³Šæµ‹è¯•æ€§èƒ½è¯„ä¼°ä¸­è¢«å¹¿æ³›æ¥å—çš„ç»Ÿè®¡é‡æ¥å±•ç¤º <strong>RustSan</strong> çš„æ€§èƒ½å¢ç›Š [23, 60]ã€‚å¾—ç›Šäº <strong>RustSan</strong> çš„</strong>è¿è¡Œæ—¶å¼€é”€é™ä½</strong>ï¼Œåœ¨å›ºå®šæŒç»­æ—¶é—´ï¼ˆ24 å°æ—¶ï¼‰ä¸‹ï¼Œfuzzer èƒ½åœ¨ <strong>RustSan</strong> ç‰ˆæœ¬ä¸Šæ‰§è¡Œ<strong>æ›´å¤šè½®æ¬¡</strong>ã€‚</p><figure><img src="/assets/images/scholar/RustSan/table4.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>è¡¨4</strong> å¯¹æ¯”äº† <strong>RustSan</strong> ä¸ <strong>ASan</strong>ã€‚é¦–å…ˆä»<strong>æ¯ç§’æ‰§è¡Œæ¬¡æ•°</strong>çœ‹ï¼Œ<strong>RustSan</strong> ç›¸æ¯” <strong>ASan</strong> çš„<strong>å¹³å‡æ€§èƒ½æå‡</strong>ä¸º <strong>23.52%</strong>ï¼ˆè®°ä½œ <strong>Incr(%)</strong>ï¼‰ã€‚ä¸ºæ›´å¥½åœ°è¯´æ˜æ€§èƒ½æå‡çš„æ¥æºï¼Œæˆ‘ä»¬è¿˜æµ‹é‡äº†<strong>æ¯æ¬¡æ‰§è¡Œçš„å¹³å‡æ£€æŸ¥æ•°ï¼ˆaverage checks per executionï¼‰</strong>ã€‚ç”±äº <strong>RustSan</strong> çš„<strong>æ€»æ‰§è¡Œæ¬¡æ•°</strong>é€šå¸¸å¤šäº <strong>ASan</strong>ï¼Œæˆ‘ä»¬ä½¿ç”¨<strong>å¹³å‡å€¼</strong>è€Œéæ€»æ£€æŸ¥æ¬¡æ•°ã€‚å„ç›®æ ‡ä¸­ï¼Œ<strong>brotli-rs</strong> çš„æ”¹å–„æœ€æ˜¾è‘—ï¼ˆ<strong>57%</strong>ï¼‰ï¼šåœ¨è¿è¡ŒæœŸé—´ï¼Œ<strong>RustSan</strong> æ¯æ¬¡æ‰§è¡Œå¤§çº¦ç§»é™¤äº† <strong>39 ä¸‡æ¬¡</strong> sanitizer æ£€æŸ¥ï¼Œè¿™èƒ½ç›´æ¥è§£é‡Šå…¶æ€§èƒ½æå‡ã€‚ç›¸å¯¹åœ°ï¼Œ<strong>cpp_demangle</strong> çš„æ•´ä½“å¼€é”€ä¸‹é™å¾ˆå°ï¼ˆ<strong>0.87%</strong>ï¼‰ï¼Œå°½ç®¡<strong>æ£€æŸ¥å‡å°‘ç‡</strong>å¾ˆé«˜ï¼ˆ<strong>98.37%</strong>ï¼‰ã€‚åŸå› åœ¨äºè¯¥ç›®æ ‡çš„<strong>å†…å­˜è®¿é—®å‡ºç°æ¬¡æ•°</strong>æœ¬å°±æœ‰é™ï¼ˆ<strong>2535.67 æ¬¡æ£€æŸ¥/ç§’</strong>ï¼‰ï¼Œæ€»ä½“å¼€é”€è¢«å…¶å®ƒå› ç´ ä¸»å¯¼ï¼ˆå¦‚ç§å­å˜å¼‚ã€è¿›ç¨‹é‡å¯ç­‰ï¼‰ã€‚</p><p><strong>ç»“æœè®¨è®ºã€‚</strong><br> åœ¨å¤šä¸ª crate çš„æ¨¡ç³Šæµ‹è¯•ä¸­ï¼ˆå¦‚ <strong>brotli-rs</strong>ï¼‰ï¼Œ<strong>RustSan</strong> å±•ç°å‡ºå¯è§‚çš„æ€§èƒ½æ”¶ç›Šã€‚ç„¶è€Œï¼Œæ¨¡ç³Šæµ‹è¯•çš„æ•´ä½“æ€§èƒ½å—å¤šç§å› ç´ å½±å“ã€‚ä¾‹å¦‚ï¼Œç›®æ ‡ç¨‹åºä¸­<strong>load/store æŒ‡ä»¤å æ¯”</strong>å¯èƒ½è¾ƒä½ï¼›åˆå¦‚ï¼ŒæŸäº›ç¨‹åºä¸­<strong>çº¯ç›®æ ‡ä»£ç çš„æ‰§è¡Œæ—¶é—´</strong>è¾ƒçŸ­ï¼Œå¯¼è‡´ fuzzer è‡ªèº«æ“ä½œï¼ˆè¿›ç¨‹é‡å¯ã€ç§å­å˜å¼‚ç­‰ï¼‰ä¸»å¯¼äº†æ€»æ‰§è¡Œæ—¶é—´ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œ<strong>RustSan</strong> åªèƒ½åœ¨<strong>å°½é‡å‡å°‘å½±å­å†…å­˜æ£€æŸ¥</strong>ï¼ˆå³ <strong>è¡¨4</strong> ä¸­çš„ <strong>Reduc.%</strong>ï¼‰ä¸Šåšå‡ºè´¡çŒ®ã€‚æœ¬å®éªŒçš„é‡ç‚¹æ˜¯åœ¨<strong>çœŸå®åœºæ™¯</strong>ä¸‹å±•ç¤º <strong>RustSan</strong> çš„<strong>ç‹¬ç«‹</strong>æ€§èƒ½å¢ç›Šã€‚æˆ‘ä»¬é¢„è®¡ <strong>RustSan</strong> è¿˜å¯ä»¥ä¸å…¶å®ƒ <strong>ASan</strong> ä¼˜åŒ–ç»“åˆä»¥ç¼“è§£ä¸Šè¿°å› ç´ ã€‚ä¾‹å¦‚ <strong>FuZZan</strong> [27] ä¼˜åŒ–äº†å½±å­å†…å­˜åˆå§‹åŒ–ï¼Œèƒ½ç›´æ¥é™ä½ fuzzer çš„è¿›ç¨‹é‡å¯æ—¶é—´ã€‚</p><p><strong>æ£€æµ‹åˆ°çš„é”™è¯¯ã€‚</strong><br> æ— è®ºæ˜¯ <strong>ASan</strong> è¿˜æ˜¯ <strong>RustSan</strong>ï¼Œéƒ½<strong>æœª</strong>å‘ç°ç”±<strong>å†…å­˜é”™è¯¯æ£€æµ‹</strong>å¯¼è‡´çš„å´©æºƒã€‚ç»“åˆè¿™äº› crate çš„ harness ä¸æ–‡æ¡£ï¼Œæˆ‘ä»¬æ¨æµ‹åŸå› æ˜¯å®ƒä»¬<strong>æ­¤å‰å·²è¢« fuzz åˆ°ä¸€å®šç¨‹åº¦</strong>ï¼ˆä¾‹å¦‚å·²è¶…è¿‡ 24 å°æ—¶ï¼‰ï¼Œå› æ­¤å®¹æ˜“è§¦è¾¾çš„ç¼ºé™·å¤§æ¦‚ç‡<strong>å·²è¢«ä¿®å¤</strong>ã€‚å³ä¾¿å¦‚æ­¤ï¼Œè¯¥ç»“æœè‡³å°‘è¯´æ˜ <strong>RustSan</strong> <strong>æ²¡æœ‰</strong>å‡ºç°<strong>è¯¯æŠ¥</strong>å¯¼è‡´çš„å´©æºƒã€‚</p><h2 id="_8-å®‰å…¨æ€§ä¸ç¨³å¥æ€§è®¨è®º" tabindex="-1"><a class="header-anchor" href="#_8-å®‰å…¨æ€§ä¸ç¨³å¥æ€§è®¨è®º"><span>8. å®‰å…¨æ€§ä¸ç¨³å¥æ€§è®¨è®º</span></a></h2><p><strong>Sanitizer</strong>ï¼ˆå‡€åŒ–å™¨ï¼‰å§‹ç»ˆæ˜¯ä¸€ç§â€œå°½åŠ›è€Œä¸ºï¼ˆbest-effortï¼‰â€çš„è§£å†³æ–¹æ¡ˆï¼šä¸ºäº†å®ç”¨æ€§ï¼Œå®ƒä»¬å¿…é¡»åœ¨<strong>æ£€æµ‹è¦†ç›–ç‡</strong>ã€<strong>å¯ç§»æ¤æ€§</strong>ä¸<strong>æ€§èƒ½</strong>ä¹‹é—´æƒè¡¡ã€‚å°±æ­¤è€Œè¨€ï¼Œæˆ‘ä»¬è®¤ä¸º <strong>RustSan</strong> é€šè¿‡å¤§é‡å®è¯æµ‹è¯•ï¼Œå·²ç»å±•ç¤ºå‡ºå…¶ä½œä¸ºä¸€ç§<strong>å®ç”¨æ–¹æ¡ˆ</strong>çš„ä»·å€¼ã€‚ä¸‹é¢æˆ‘ä»¬ä»<strong>ç¨³å¥æ€§è§†è§’</strong>é‡æ–°å®¡è§†å‰æ–‡çš„è¯„ä¼°ï¼Œå¹¶<strong>å®šæ€§</strong>è®¨è®º <strong>RustSan</strong> ä¸­æ½œåœ¨çš„ä¸æ­£ç¡®æ€§æ¥æºã€‚</p><hr><h3 id="_8-1-å®è¯éªŒè¯-empirical-validation" tabindex="-1"><a class="header-anchor" href="#_8-1-å®è¯éªŒè¯-empirical-validation"><span>8.1 å®è¯éªŒè¯ï¼ˆEmpirical validationï¼‰</span></a></h3><p>æˆ‘ä»¬çš„è¯„ä¼°ä¸ä»…ç¡®è®¤äº† <strong>RustSan</strong> çš„<strong>æ€§èƒ½ä¼˜åŠ¿</strong>ï¼Œåœ¨<strong>æµ‹è¯•æ ·æœ¬æ•°é‡å¾ˆå¤§</strong>çš„å‰æä¸‹ä¹Ÿå¯¹å…¶æ•ˆæœç»™å‡ºäº†<strong>ç»éªŒæ€§éªŒè¯</strong>ã€‚æ­£å¦‚åœ¨ <strong>CVE å¤ç°å®éªŒï¼ˆÂ§7.2ï¼‰<strong>ä¸­æ‰€è¿°ï¼Œæˆ‘ä»¬ç¡®è®¤ <strong>RustSan</strong> èƒ½</strong>æˆåŠŸæ£€å‡º</strong>å…¨éƒ¨ CVE æ¡ˆä¾‹ã€‚</p><p>åœ¨æ‰€æœ‰åŸºå‡†æµ‹è¯•ä¸­ï¼Œ<strong>RustSan æœªå‡ºç°ä»»ä½•è¯¯æŠ¥</strong>ï¼ˆå³ä¸ä¼šå› ä¸ºæ£€æµ‹è€Œå¯¼è‡´<strong>ç¨‹åºå´©æºƒ</strong>ï¼‰ã€‚è¿™äº› crate è‡ªå¸¦çš„åŸºå‡†å¹¶éç”¨äºâ€œè§¦å‘ç¼ºé™·â€ï¼Œå› æ­¤å®ƒä»¬ä¹Ÿå¯ä»¥è¢«è§†ä½œå¯¹ <strong>RustSan</strong> çš„ä¸€æ¬¡<strong>ç‹¬ç«‹ç¨³å¥æ€§æµ‹è¯•</strong>ã€‚å›æº¯æ¥çœ‹ï¼Œ<strong>RustSan</strong> åœ¨ 18 ä¸ª Rust crate ä¸Šå…±æ£€æŸ¥äº†<strong>çº¦ 15 äº¿</strong>æ¬¡<strong>å†…å­˜è®¿é—®ç‚¹</strong>ï¼›è‹¥å…¶ä¸­<strong>ä»»æ„ä¸€ä¸ªçœŸæ­£çš„å®‰å…¨è®¿é—®ç‚¹</strong>è¢«é”™è¯¯åœ°æ ‡è®°ä¸º <strong>unsafe</strong> æˆ– <strong>false-safe</strong>ï¼Œå°±ä¼šå¯¼è‡´<strong>ç¨‹åºå´©æºƒå¼çš„è¯¯æŠ¥</strong>ï¼Œå› ä¸ºè¿™ç±»è®¿é—®ç‚¹éšåå°†<strong>æ— æ³•è®¿é—®å®‰å…¨å¯¹è±¡</strong>ã€‚</p><p>åœ¨æ¨¡ç³Šæµ‹è¯•å®éªŒä¸­ï¼Œ<strong>RustSan</strong> åœ¨ 6 ä¸ª crate ä¸Šã€<strong>24 å°æ—¶</strong>å†…å…±æ£€æŸ¥äº†<strong>890 äº¿</strong>æ¬¡å†…å­˜è®¿é—®ç‚¹ï¼ŒåŒæ ·<strong>æœªå‡ºç°è¯¯æŠ¥</strong>ã€‚ä¸ CVE å®éªŒä¸€æ ·ï¼Œæ¨¡ç³Šæµ‹è¯•å®éªŒä¹Ÿå¯è¢«è§†ä½œ<strong>æ¼æŠ¥</strong>çš„é—´æ¥éªŒè¯ã€‚ä¸è¿‡ï¼Œæ­£å¦‚æˆ‘ä»¬æåˆ°çš„ï¼ŒåŸºçº¿ <strong>ASan</strong> åœ¨è¯¥æ—¶æ®µä¹Ÿæœªå‘ç°<strong>æ­¤å‰æœªçŸ¥</strong>çš„å†…å­˜é”™è¯¯ã€‚è¦åœ¨æœ¬æ–‡èŒƒå›´å†…è¿›ä¸€æ­¥éªŒè¯ï¼Œè¿˜éœ€é’ˆå¯¹<strong>ç›¸å¯¹æœªè¢«å……åˆ†æµ‹è¯•çš„ Rust crate</strong>è¿›è¡Œç†è§£ä¸é€‰æ‹©ï¼Œå¹¶<strong>æ‰‹å·¥æ„é€  fuzzing harness</strong>ï¼Œè¿™æ˜¯ä¸€é¡¹ç›¸å½“è‰°å·¨çš„å·¥ä½œï¼Œå› è€Œæœªçº³å…¥æœ¬ç ”ç©¶ã€‚</p><hr><h3 id="_8-2-å®šæ€§åˆ†æ-qualitative-analysis" tabindex="-1"><a class="header-anchor" href="#_8-2-å®šæ€§åˆ†æ-qualitative-analysis"><span>8.2 å®šæ€§åˆ†æï¼ˆQualitative analysisï¼‰</span></a></h3><p>å°½ç®¡ <strong>RustSan</strong> åœ¨ç¨‹åºåˆ†ææŠ€æœ¯ä¸Š<strong>æœ‰æ„è¯†åœ°ä¿æŒä¿å®ˆ</strong>ï¼Œä½†å¯¹äº<strong>å¤æ‚ç¨‹åºåˆ†æ</strong>è€Œè¨€ï¼Œè¦å®Œå…¨ä¿è¯<strong>å®Œå¤‡æ€§</strong>ä¸<strong>å¥å…¨æ€§</strong>ï¼ˆsoundnessï¼‰ä»å…·æŒ‘æˆ˜ã€‚æˆ‘ä»¬å€ŸåŠ© <strong>è¡¨5</strong>ï¼Œç³»ç»Ÿæ€§åœ°è®¨è®º <strong>RustSan</strong> éªŒè¯æ¨¡å‹å¯èƒ½é¢ä¸´çš„é—®é¢˜ã€‚</p><figure><img src="/assets/images/scholar/RustSan/table5.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>ï¼ˆ1ï¼‰HIR/MIR åˆ†æä¸å®Œæ•´ã€‚</strong><br> æƒ…å½¢ <strong>MC1</strong> ä¸ <strong>MC2</strong> å¯èƒ½æºè‡ª<strong>HIR/MIR åˆ†æä¸å®Œæ•´</strong>ã€‚å›å¿†å®šä¹‰ï¼š<strong>unsafe è®¿é—®ç‚¹</strong>æ˜¯ä½äº <code>unsafe</code> ä»£ç å—å†…éƒ¨çš„<strong>å†…å­˜è®¿é—®ç‚¹</strong>ï¼Œåº”ç”± <strong>MIR å±‚</strong>æ¥è¯†åˆ«ã€‚è‹¥è¢«è¯¯åˆ†ï¼Œåæœæ˜¯ï¼šä¸€ä¸ª <strong>unsafe</strong> è®¿é—®ç‚¹å¯ä»¥<strong>æ‚„ç„¶ç ´åå®‰å…¨å¯¹è±¡</strong>ï¼ˆå¯¹åº” <strong>MC1</strong>ï¼‰ï¼Œæˆ–<strong>ç ´åé‡å å¯¹è±¡</strong>ï¼ˆå¯¹åº” <strong>MC2</strong>ï¼‰ã€‚è¿™äºŒè€…å‡ä¼šå‰Šå¼± <strong>RustSan</strong> çš„<strong>å†…å­˜éªŒè¯æ¨¡å‹</strong>ï¼Œå±äº<strong>æ¼æŠ¥</strong>ã€‚</p><p><strong>ï¼ˆ2ï¼‰HIR/MIR åˆ†æä¸å¥å…¨ã€‚</strong><br> ç›¸ååœ°ï¼Œ<strong>ä¸å¥å…¨</strong>çš„ HIR/MIR åˆ†æå¯èƒ½æŠŠ<strong>ä½äº <code>unsafe</code> ä¹‹å¤–</strong>çš„<strong>å®‰å…¨/ä¼ªå®‰å…¨</strong>è®¿é—®ç‚¹è¯¯åˆ¤ä¸º<strong>unsafe</strong>ï¼ˆæƒ…å½¢ <strong>MC3ã€MC5</strong>ï¼‰ã€‚å…¶ä¸­ <strong>MC5</strong> ä¼šåœ¨æœ¬åº”<strong>åˆæ³•è®¿é—®å®‰å…¨å¯¹è±¡</strong>çš„åœ°æ–¹è§¦å‘<strong>è¯¯æŠ¥</strong>ï¼›æ­¤å¤–ï¼Œå®ƒè¿˜ä¼š<strong>é™ä½æ€§èƒ½ä¼˜åŠ¿</strong>ï¼Œå› ä¸ºç³»ç»Ÿè¢«è¿«åŠ å…¥<strong>ä¸å¿…è¦çš„æ£€æŸ¥</strong>ã€‚<strong>MC3</strong> åŒæ ·æ˜¯<strong>è¯¯æŠ¥</strong>ï¼šåœ¨ <strong>RustSan</strong> çš„éªŒè¯æ¨¡å‹ä¸‹ï¼Œ<strong>ä¼ªå®‰å…¨</strong>è®¿é—®ç‚¹åº”å½“å¯ä»¥è®¿é—®<strong>å®‰å…¨å¯¹è±¡</strong>ï¼›ä¸€æ—¦è¢«è¯¯åˆ¤ï¼Œå®ƒä¸ºäº†è®¿é—®<strong>æ²¿ç€å®‰å…¨æ•°æ®æµåœ¨è¿è¡ŒæœŸé€è¾¾</strong>çš„å®‰å…¨å¯¹è±¡è€Œè§¦å‘å‘Šè­¦ã€‚</p><p><strong>ï¼ˆ3ï¼‰RustSan çš„ HIR/MIR åˆ†æçš„ç¨³å¥æ€§ã€‚</strong><br> æˆ‘ä»¬çš„ <strong>MIR åˆ†æ</strong>æ˜¯<strong>é’ˆå¯¹ <code>unsafe</code> ä»£ç å—</strong>çš„<strong>å®šå‘åˆ†æ</strong>ï¼Œè€Œè¿™äº›ä»£ç å—ä»…å  Rust ç¨‹åºçš„<strong>æå°éƒ¨åˆ†</strong>ã€‚å› æ­¤ï¼Œ<strong>MIR åˆ†æ</strong>æ˜¯å¯ä»¥åšåˆ°<strong>å®Œæ•´ä¸”å¥å…¨</strong>çš„ã€‚è¿›ä¸€æ­¥åœ°ï¼Œ<strong>RustSan</strong> åœ¨ MIR åˆ†æä¸­å¼•å…¥äº†<strong>é€’å½’çš„ä½œç”¨åŸŸå®‰å…¨æ€§</strong>è¯†åˆ«ï¼Œä¿®å¤äº†æ—¢æœ‰å·¥ä½œ [38] ä¸­çš„ä¸€ç±»<strong>æ¼æŠ¥æ¥æº</strong>ã€‚æ®æ­¤ï¼Œæˆ‘ä»¬è®¤ä¸º <strong>HIR/MIR åˆ†ææ˜¯ç¨³å¥çš„</strong>ï¼Œç›¸å…³è¯¯åˆ¤åº”å½“<strong>æä¸ºç½•è§</strong>ï¼›æ­¤å¤–ï¼Œæˆ‘ä»¬çš„<strong>å®è¯è¯„ä¼°</strong>ä¹Ÿä»ä¾§é¢è¯æ˜äº†<strong>æ²¡æœ‰è¯¯æŠ¥</strong>ã€‚</p><p><strong>ï¼ˆ4ï¼‰points-toï¼ˆæŒ‡å‘å…³ç³»ï¼‰åˆ†æä¸å®Œæ•´ã€‚</strong><br><strong>ä¸å®Œæ•´çš„æ•°æ®æµ/points-to åˆ†æ</strong>å¯èƒ½å¯¼è‡´ <strong>MC4</strong>ï¼šåˆ†æå™¨<strong>é—æ¼</strong>äº†â€œè®¿é—®ç‚¹ â†” ä¸å®‰å…¨å¯¹è±¡â€ä¹‹é—´çš„æŒ‡å‘å…³ç³»ã€‚ç»“æœæ˜¯ï¼šæŸä¸ª<strong>å¿…é¡»åªèƒ½è®¿é—®é‡å /ä¸å®‰å…¨å¯¹è±¡</strong>çš„<strong>ä¼ªå®‰å…¨è®¿é—®ç‚¹</strong>è¢«<strong>é”™è¯¯åœ°â€œè¯æ˜â€ä¸ºå®‰å…¨ï¼Œç»•è¿‡äº†æ£€æŸ¥</strong>ã€‚æ­¤æ—¶ <strong>RustSan</strong> å°†<strong>æ— æ³•æ„ŸçŸ¥</strong>è¯¥è®¿é—®ç‚¹å¯¹<strong>å®‰å…¨å¯¹è±¡</strong>çš„ç ´åâ€”â€”è¿™æ˜¯<strong>æ¼æŠ¥</strong>ã€‚</p><p><strong>ï¼ˆ5ï¼‰points-to åˆ†æä¸å¥å…¨ã€‚</strong><br><strong>ä¸å¥å…¨çš„ points-to åˆ†æ</strong>å¯èƒ½å¯¼è‡´ <strong>MC6</strong>ï¼šæŠŠçœŸå®çš„<strong>å®‰å…¨è®¿é—®ç‚¹</strong>è¯¯åˆ†ä¸º<strong>ä¼ªå®‰å…¨è®¿é—®ç‚¹</strong>ã€‚ä¸ <strong>MC5</strong> ç±»ä¼¼ï¼Œè¿™ä¼šå¼•å‘<strong>è¯¯æŠ¥</strong>å¹¶å› <strong>ä¸å¿…è¦çš„æ£€æŸ¥</strong>è€Œ<strong>é™ä½æ€§èƒ½</strong>ã€‚</p><p><strong>ï¼ˆ6ï¼‰points-to åˆ†æçš„ç¨³å¥æ€§ã€‚</strong><br><strong>RustSan</strong> é‡‡ç”¨äº†<strong>å…ˆè¿›çš„ç¨‹åºåˆ†æå·¥å…·</strong> [50]ï¼Œè¯¥å·¥å…·å·²åœ¨<strong>è½¯ä»¶å®‰å…¨</strong>é¢†åŸŸè¢«å¹¿æ³›ä½¿ç”¨ [15, 18, 28â€“30, 38, 44]ã€‚æˆ‘ä»¬çš„è¯„ä¼°æ˜¾ç¤ºï¼Œ<strong>MC6-å‹è¯¯æŠ¥</strong>åº”å½“<strong>ç½•è§</strong>ã€‚ä¸è¿‡ï¼Œ<strong>MC4 çš„é£é™©</strong>ä»ç„¶å­˜åœ¨ï¼Œå› ä¸º points-to å·¥å…·æ˜¯ä¸€ä¸ª<strong>å¤–éƒ¨ä¾èµ–</strong>ï¼›å°½ç®¡å¦‚æ­¤ï¼ŒåŸºäºå…¶åœ¨è¯¥é¢†åŸŸçš„<strong>å¹¿æ³›å®è·µ</strong>ï¼Œæˆ‘ä»¬ä»è®¤ä¸ºè¯¥å·¥å…·<strong>æ€»ä½“å¯é </strong>ã€‚</p><h2 id="_9-ç›¸å…³å·¥ä½œ-related-work" tabindex="-1"><a class="header-anchor" href="#_9-ç›¸å…³å·¥ä½œ-related-work"><span>9. ç›¸å…³å·¥ä½œï¼ˆRelated Workï¼‰</span></a></h2><h3 id="_9-1-é¢å‘å†…å­˜ç¼ºé™·æ£€æµ‹çš„-sanitizer" tabindex="-1"><a class="header-anchor" href="#_9-1-é¢å‘å†…å­˜ç¼ºé™·æ£€æµ‹çš„-sanitizer"><span>9.1 é¢å‘å†…å­˜ç¼ºé™·æ£€æµ‹çš„ Sanitizer</span></a></h3><p>Sanitizer é•¿æœŸä»¥æ¥è¢«ç”¨äºæ£€æµ‹ä»¥<strong>ä¸å®‰å…¨å†…å­˜è¯­è¨€</strong>ç¼–å†™çš„ç¨‹åºä¸­çš„ç¼ºé™·ï¼Œç”¨ä»¥å‘ç°å„ç§<strong>å†…å­˜é”™è¯¯</strong> [12, 34, 40, 42, 47-49, 53, 58]ã€‚å…¶ä¸­æ—¢åŒ…æ‹¬<strong>ç©ºé—´ç±»</strong>å†…å­˜é”™è¯¯çš„å‡€åŒ–ï¼ˆsanitizationï¼‰[12, 19, 40, 42, 47, 54]ï¼Œä¹ŸåŒ…æ‹¬<strong>æ—¶é—´ç±»</strong>å†…å­˜é”™è¯¯çš„å‡€åŒ– [34, 47, 53, 58]ï¼›åœ¨ç¨‹åºåŠ¨æ€æµ‹è¯•é¢†åŸŸå·²æœ‰å¤šç§æˆç†Ÿçš„æ›¿ä»£æ–¹æ¡ˆã€‚</p><p>åœ¨ä¼—å¤šè®¾è®¡ä¸­ï¼Œ<strong>ASan</strong> [24, 47] æ˜¯<strong>æœ€ä¸ºå¹¿æ³›ä½¿ç”¨</strong>å¹¶<strong>é›†æˆè¿›ä¸»æµç¼–è¯‘å™¨</strong>çš„ sanitizerï¼Œå¾—ç›Šäºå…¶<strong>è½»é‡çš„å½±å­å†…å­˜æ£€æŸ¥æœºåˆ¶</strong>ä¸<strong>é«˜åº¦å…¼å®¹æ€§</strong> [48]ã€‚<strong>RustSan</strong> çš„ç›®æ ‡ï¼Œæ˜¯åœ¨ä¿ç•™ ASan çš„å¯ç§»æ¤æ€§ä¸å…¼å®¹æ€§çš„å‰æä¸‹ï¼Œ<strong>ä¸º Rust â€œæ”¹é€ â€ASan</strong>ï¼Œé€šè¿‡<strong>æ¶ˆé™¤å†—ä½™æ£€æŸ¥</strong>æ¥æå‡æ€§èƒ½ã€‚</p><hr><h3 id="_9-2-é¢å‘æ€§èƒ½çš„-sanitizer-ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_9-2-é¢å‘æ€§èƒ½çš„-sanitizer-ä¼˜åŒ–"><span>9.2 é¢å‘æ€§èƒ½çš„ Sanitizer ä¼˜åŒ–</span></a></h3><p>Sanitizer å¾€å¾€å¸¦æ¥<strong>å¾ˆé«˜çš„è¿è¡Œæ—¶å¼€é”€</strong>ï¼Œå› æ­¤å·²æœ‰å¤§é‡å·¥ä½œå°è¯•å¯¹å…¶è¿›è¡Œä¼˜åŒ–ã€‚</p><p><strong>æ¶ˆé™¤ sanitizer æ£€æŸ¥ã€‚</strong><br> è¯†åˆ«å¹¶åˆ é™¤<strong>å†—ä½™æ£€æŸ¥</strong>æ˜¯ä¸€æ¡é™ä½å¼€é”€çš„é‡è¦è·¯å¾„ [16, 25, 32, 43, 51, 60]ã€‚ä¸å°‘ç ”ç©¶é€šè¿‡<strong>ç²¾ç¡®çš„é™æ€åˆ†æ</strong>å®šä½å¹¶ç§»é™¤ä¸å¿…è¦çš„æ£€æŸ¥ï¼ŒåŒæ—¶<strong>ä¸ç‰ºç‰²æ£€æµ‹è¦†ç›–ç‡</strong>ã€‚ä¾‹å¦‚ <strong>SANRAZOR</strong> [59] ç»“åˆ<strong>åŠ¨æ€ä»£ç è¦†ç›–ç‡</strong>ä¸<strong>é™æ€æ•°æ®ä¾èµ–</strong>æ¥å‘ç°å†—ä½™æ£€æŸ¥ï¼›<strong>ASan--</strong> [60] åˆ™é‡‡ç”¨<strong>è½»é‡é™æ€åˆ†æ</strong>æ¥æ£€æµ‹/ç§»é™¤<strong>é‡å¤æ€§</strong>æ£€æŸ¥ï¼Œå¹¶ä¼˜åŒ– sanitizer æ£€æŸ¥ã€‚è¿™äº›å·¥ä½œå¤§å¤šé¢å‘ ASan çš„<strong>å…¸å‹ç›®æ ‡</strong>ï¼ˆå¦‚ C/C++ ç¨‹åºï¼‰è¿›è¡Œä¼˜åŒ–ã€‚ä¸ä¹‹ç›¸å¯¹ï¼Œ<strong>RustSan</strong> æŒ‡å‡ºäº† ASan åœ¨<strong>éƒ¨åˆ†ä¸å®‰å…¨</strong>ï¼ˆpartially-unsafeï¼‰çš„ Rust ç¨‹åºä¸Šçš„<strong>ä½æ•ˆ</strong>ï¼Œå¹¶ç»™å‡ºäº†è§£å†³æ–¹æ¡ˆã€‚</p><p><strong>åšæ€§èƒ½â€”æ£€æµ‹æƒè¡¡ã€‚</strong><br> ä¹Ÿæœ‰å·¥ä½œæå‡ºåœ¨æ—¢å®šçš„<strong>æ€§èƒ½é¢„ç®—</strong>ä¸‹ï¼Œå¯¹â€œæ£€æµ‹èƒ½åŠ›ä¸æ€§èƒ½â€è¿›è¡Œ<strong>æƒè¡¡</strong>ã€‚ä¾‹å¦‚ <strong>ASAP</strong> [47] å¯¹ç›®æ ‡ç¨‹åºåš profileï¼Œæ‰¾å‡ºç§»é™¤æ£€æŸ¥å<strong>æ”¶ç›Šæœ€å¤§çš„çƒ­åŒº</strong>ï¼›<strong>SANRAZOR</strong> [59] æä¾›å¯é…ç½®çš„<strong>å¤šæ¡£ä½æƒè¡¡</strong>ã€‚ä¸è¿™äº›å·¥ä½œä¸åŒï¼Œ<strong>RustSan</strong> <strong>ä¿ç•™</strong>äº† ASan çš„æ£€æµ‹èƒ½åŠ›ï¼ŒåŒæ—¶<strong>æ–°å¢</strong>äº†<strong>Rust ç‰¹å®šçš„å®‰å…¨å¯¹è±¡ä¿æŠ¤</strong>ã€‚</p><p><strong>ä¼˜åŒ– sanitizer è¿è¡ŒæœŸã€‚</strong><br> å¦ä¸€äº›å·¥ä½œç›´æ¥ä¼˜åŒ– sanitizer çš„<strong>è¿è¡Œæ—¶æœºåˆ¶</strong>ï¼Œä½¿å…¶æ›´é€‚é…ç‰¹å®šè´Ÿè½½ï¼ˆå¦‚ fuzzingï¼‰ã€‚<strong>Fuzzan</strong> [27] ä¸º redzone ç®¡ç†è®¾è®¡äº†<strong>é«˜æ•ˆå…ƒæ•°æ®</strong>ï¼ŒåŠ é€Ÿäº†â€œASan+fuzzingâ€ï¼›<strong>PartiSan</strong> [35] å°†åº”ç”¨åˆ’åˆ†ä¸º<strong>å¸¦å‡€åŒ–</strong>ä¸<strong>ä¸å¸¦å‡€åŒ–</strong>çš„åˆ‡ç‰‡ï¼Œä½¿åè€…<strong>ä¸æ‰¿å—é¢å¤–å¼€é”€</strong>ï¼›<strong>Bunshin</strong> [57] åˆ™åœ¨<strong>å¹¶è¡Œè¿è¡Œ</strong>çš„ç¨‹åºé—´<strong>åˆ†æ‘Š</strong>sanitizer æ£€æŸ¥ã€‚æˆ‘ä»¬é¢„è®¡ <strong>RustSan</strong> å¯ä»¥ä¸è¿™äº›æŠ€æœ¯<strong>ç»„åˆ</strong>ï¼Œè¿›ä¸€æ­¥ä¼˜åŒ–å…¶æ€§èƒ½ã€‚</p><hr><h3 id="_9-3-rust-ç¨‹åºåŠ å›º" tabindex="-1"><a class="header-anchor" href="#_9-3-rust-ç¨‹åºåŠ å›º"><span>9.3 Rust ç¨‹åºåŠ å›º</span></a></h3><p><strong>ç”¨äºåŠ å›º Rust çš„é™æ€åˆ†æã€‚</strong><br> å·²æœ‰é™æ€åˆ†æå™¨è¢«ç”¨äºæ£€æµ‹ <strong>unsafe Rust</strong> ä¸­çš„ç¼ºé™·ã€‚ä¾‹å¦‚ <strong>Rudra</strong> [14] åœ¨ Rust çš„ MIR/HIR ä¸Šå¼•å…¥äº†<strong>å¯æ‰©å±•é™æ€åˆ†æ</strong>æ¥å¯»æ‰¾ç‰¹å®šæ¨¡å¼çš„æ¼æ´ï¼›<strong>MirChecker</strong> [37] ç»“åˆ<strong>æ•°å€¼åˆ†æ</strong>ä¸ <strong>MIR ç¬¦å·æ‰§è¡Œ</strong>ä»¥æ£€æµ‹<strong>è¿è¡ŒæœŸ panic</strong>ä¸<strong>å†…å­˜é”™è¯¯</strong>ï¼›<strong>Rupair</strong> [26] å¯åœ¨ <code>unsafe</code> ä»£ç ä¸­<strong>è‡ªåŠ¨æ£€æµ‹è¶Šç•Œ</strong>å¹¶ç”¨ MIR ä¸Šçš„<strong>è½»é‡æ•°æ®æµåˆ†æ</strong>ä¿®å¤ã€‚<strong>RustSan</strong> åŒæ ·åˆ©ç”¨ HIR/MIR åˆ†æï¼Œä½†è¿›ä¸€æ­¥åšäº†<strong>æ›´ç»†ç²’åº¦çš„ä¿¡æ¯æå–</strong>ï¼ˆé¢å‘ <code>unsafe</code> ä»£ç å—çš„è¯­å¥çº§åˆ†æï¼‰ã€‚é™æ€/åŠ¨æ€æµ‹è¯•å„æœ‰ä¼˜åŠ£ï¼Œå…·ä½“é€‚ç”¨å–å†³äºåœºæ™¯ï¼›ä¸è¿™äº›å·¥ä½œä¸åŒï¼Œ<strong>RustSan</strong> æ˜¯<strong>è¿è¡ŒæœŸ</strong>çš„ sanitizerï¼ˆä¾‹å¦‚å¯åœ¨ fuzzing æœŸé—´å‘ç°å†…å­˜é”™è¯¯ï¼‰ã€‚</p><p><strong>Rust ç¨‹åºçš„è¿è¡ŒæœŸéš”ç¦»ã€‚</strong><br> æœ‰å¤§é‡å·¥ä½œæå‡ºäº†<strong>è¿è¡Œæ—¶éš”ç¦»</strong>æœºåˆ¶ï¼Œä»¥<strong>çº¦æŸ</strong>ï¼ˆcontainï¼‰ç”± <code>unsafe</code> ä»£ç å—ä¸<strong>ä¸å®‰å…¨å¤–éƒ¨åº“</strong>è§¦å‘çš„å†…å­˜é”™è¯¯å¸¦æ¥çš„å½±å“ã€‚<strong>XRust</strong> [38] ä¸ <strong>TRust</strong> [15] å¼•å…¥äº†<strong>åˆ†ç¦»çš„å†…å­˜åˆ†é…å™¨æ–¹æ¡ˆ</strong>ï¼šå°†è¢« <code>unsafe</code> è§¦åŠçš„å¯¹è±¡æ”¾å…¥<strong>ä¸å®‰å…¨å †</strong>ï¼›åŒæ—¶ï¼Œå®ƒä»¬è¿˜æä¾›<strong>å®šåˆ¶æ’æ¡©æ¡†æ¶</strong>ï¼Œç”¨ä»¥<strong>éš”ç¦»</strong>ä¼šå—ä¸å®‰å…¨å¯¹è±¡å½±å“çš„<strong>å®‰å…¨å†…å­˜æŒ‡ä»¤</strong>ï¼ˆå³æœ¬è®ºæ–‡ Â§3.1 æ‰€è¿°çš„ <em>false-safe</em>ï¼‰ã€‚æ­¤å¤–ï¼Œä¹Ÿæœ‰ç ”ç©¶æ¢ç´¢åŸºäº <strong>MPKï¼ˆMemory Protection Keyï¼‰</strong> çš„éš”ç¦»ï¼Œç”¨äºé™åˆ¶ C åº“çš„å†…å­˜è®¿é—® [15, 31, 45]ï¼›ä¾‹å¦‚ <strong>PKRUSafe</strong> [31] é€šè¿‡<strong>åŠ¨æ€å‰–æ</strong>è‡ªåŠ¨è¯†åˆ«åœ¨ Rust ä¸ C é—´å…±äº«çš„å¯¹è±¡ï¼Œå¹¶ç”¨ MPK éš”ç¦»å¯¹è¿™äº›å¯¹è±¡çš„è®¿é—®ã€‚</p><p>è¿™äº›ç”¨äºè¯†åˆ« Rust ç¨‹åºæŒ‡ä»¤ä¸å¯¹è±¡å®‰å…¨æ€§çš„<strong>é™æ€åˆ†ææ–¹æ³•</strong> [15, 38] å¯å‘äº† <strong>RustSan</strong>ï¼›è€Œ <strong>RustSan</strong> åˆ™åœ¨ MIR ä¸­æŠŠå®ƒä»¬<strong>ç»†åŒ–åˆ°è¯­å¥çº§</strong>ã€‚å¦ä¸€æ–¹é¢ï¼Œ<strong>RustSan</strong> ä½œä¸ºä¸€ä¸ª sanitizerï¼Œéœ€è¦<strong>åœ¨é”™è¯¯å‘ç”Ÿæ—¶</strong>æ£€æµ‹å‡ºæ¥ã€‚å®ƒ<strong>æœ‰æ„è¯†åœ°ç»§æ‰¿</strong>äº† ASan çš„<strong>å…¼å®¹æ€§</strong>ä¸<strong>å¯ç§»æ¤æ€§</strong>ï¼šä¸€ä¸ªæ˜ç¡®çš„è®¾è®¡é€‰æ‹©æ˜¯<strong>é¿å…</strong>ä¾èµ–<strong>ä½“ç³»ç»“æ„ç‰¹å®š</strong>çš„ç‰¹æ€§ï¼ˆå¦‚ MPKï¼‰ã€‚æ­¤å¤–ï¼Œå®ƒä¹Ÿ<strong>é¿å…</strong>äº†å¦‚ <strong>ä¸Šä¸‹æ–‡æ•æ„Ÿ points-to åˆ†æ</strong> [15] è¿™ç±»<strong>è®¡ç®—å¼€é”€å·¨å¤§</strong>çš„æŠ€æœ¯ï¼Œä»¥ä¿è¯<strong>å¯æ‰©å±•æ€§</strong>ã€‚</p><hr><h2 id="_10-ç»“è®º-conclusion" tabindex="-1"><a class="header-anchor" href="#_10-ç»“è®º-conclusion"><span>10 ç»“è®ºï¼ˆConclusionï¼‰</span></a></h2><p>æœ¬æ–‡æå‡ºäº† <strong>RustSan</strong>ï¼šä¸€ç§ä¸º Rust ç¨‹åº <strong>â€œæ”¹é€ â€ AddressSanitizerï¼ˆASanï¼‰</strong> çš„è®¾è®¡ã€‚<strong>RustSan</strong> é€šè¿‡å¯¹<strong>å†…å­˜è®¿é—®ç‚¹çš„é€‰æ‹©æ€§æ’æ¡©</strong>ï¼Œæ˜¾è‘—æå‡äº† ASan åœ¨ Rust ç¨‹åºä¸Šçš„æ€§èƒ½ã€‚æ ¸å¿ƒæ´è§åœ¨äºï¼š<strong>å¤§é‡è®¿é—®ç‚¹</strong>åœ¨å«æœ‰ <code>unsafe</code> çš„ç¨‹åºä¸­ä¾ç„¶<strong>ä¿æŒ Rust çš„å®‰å…¨æ€§ä¿è¯</strong>ï¼Œå› æ­¤å¯ä»¥è¢«<strong>è¯†åˆ«</strong>å¹¶<strong>å…é™¤</strong>sanitizer æ£€æŸ¥ã€‚æˆ‘ä»¬çš„è¯„ä¼°é€šè¿‡<strong>CVE å¤ç°</strong>å®è¯è¯æ˜äº† <strong>RustSan</strong> çš„<strong>æ£€æµ‹èƒ½åŠ›</strong>ï¼›åœ¨<strong>é€šç”¨åº”ç”¨åŸºå‡†</strong>ä¸Šï¼Œ<strong>RustSan</strong> ç›¸æ¯” ASan å±•ç°å‡º <strong>62.3%</strong> çš„æ€§èƒ½æå‡ï¼›åœ¨<strong>æ¨¡ç³Šæµ‹è¯•</strong>å®éªŒä¸­ï¼Œå¹³å‡æå‡ä¸º <strong>23.52%</strong>ã€‚</p><h2 id="é™„å½•" tabindex="-1"><a class="header-anchor" href="#é™„å½•"><span>é™„å½•</span></a></h2><h3 id="a-cve-case-study" tabindex="-1"><a class="header-anchor" href="#a-cve-case-study"><span>A. CVE case study</span></a></h3><p>æˆ‘ä»¬åœ¨æ­¤ç»™å‡ºè‹¥å¹²<strong>æ¡ˆä¾‹ç ”ç©¶</strong>ï¼Œåˆ†æ Rust ä¸­å†…å­˜é”™è¯¯çš„æ ¹å› ä»¥åŠ <strong>RustSan</strong> å¯¹å®ƒä»¬çš„æ£€æµ‹ã€‚</p><div style="width:100%;margin:auto;text-align:center;"><img src="/assets/images/scholar/RustSan/listing4.png" style="width:50%;"></div><h4 id="æ¡ˆä¾‹-1-cve-2018-21000" tabindex="-1"><a class="header-anchor" href="#æ¡ˆä¾‹-1-cve-2018-21000"><span>æ¡ˆä¾‹ 1ï¼šCVE-2018-21000</span></a></h4><p>è¯¥ CVE å±äº Rust å¯¹ <code>transmute</code> çš„å®ç°ä¸­çš„<strong>å †æº¢å‡º</strong>ã€‚é—®é¢˜çš„æ ¹æºåœ¨ <em>Listing 4a</em> çš„ç¬¬ 5 è¡Œï¼š<code>Vec::from_raw_parts</code> æ˜¯ Rust æ ‡å‡†åº“å‡½æ•°ï¼Œç”¨äºä»<strong>åŸå§‹æŒ‡é’ˆ</strong>æ„é€ æ–°çš„å‘é‡å¯¹è±¡ï¼Œå‡½æ•°å‚æ•°ä¾æ¬¡ä¸º<strong>å‘é‡é•¿åº¦</strong>ä¸<strong>å®¹é‡</strong>ã€‚è¿™é‡Œçš„é”™è¯¯æ˜¯<strong>ç¬¬äºŒã€ç¬¬ä¸‰ä¸ªå‚æ•°çš„é¡ºåºè¢«é¢ å€’</strong>ã€‚åœ¨ Rust æœ¯è¯­ä¸­ï¼Œ<strong>å®¹é‡</strong>ï¼ˆcapacityï¼‰è¡¨ç¤ºä¸ºæœªæ¥æ’å…¥å…ƒç´ æ‰€é¢„ç•™çš„<strong>æœ€å¤§ç©ºé—´</strong>ï¼Œè€Œ<strong>é•¿åº¦</strong>ï¼ˆlengthï¼‰è¡¨ç¤ºå½“å‰å‘é‡ä¸­<strong>å®é™…å…ƒç´ ä¸ªæ•°</strong>ã€‚å› æ­¤ï¼Œè¢«é”™è¯¯æ„é€ çš„å‘é‡ææ˜“åœ¨åç»­ä½¿ç”¨ä¸­å¯¼è‡´<strong>å¯¹è±¡è¾¹ç•Œä¹‹å¤–</strong>çš„å†…å­˜è®¿é—®ã€‚åœ¨æˆ‘ä»¬çš„å¤ç°ä¸­ï¼Œ<strong>RustSan</strong> æŠ¥å‘Šäº†åœ¨ä¸€ä¸ª<strong>ä¼ªå®‰å…¨ç«™ç‚¹</strong>ï¼ˆfalse-safe siteï¼‰ä¸Šï¼Œå¯¹ä¸€ä¸ª<strong>ä¸å®‰å…¨å¯¹è±¡</strong>è§¦åŠäº†<strong>å¯¹è±¡æœ«ç«¯ redzone</strong> çš„è®¿é—®ã€‚</p><h4 id="æ¡ˆä¾‹-2-cve-2021-45713" tabindex="-1"><a class="header-anchor" href="#æ¡ˆä¾‹-2-cve-2021-45713"><span>æ¡ˆä¾‹ 2ï¼šCVE-2021-45713</span></a></h4><p>è¯¥ CVE å‘ç”Ÿåœ¨ <code>rusqlite</code> ä¸­ï¼Œæ˜¯ä¸€èµ·<strong>é‡Šæ”¾åä½¿ç”¨ï¼ˆuse-after-freeï¼‰</strong>ï¼Œç”± <strong>unsafe Rust</strong> ä¸­<strong>è¿èƒŒ Rust å¯¹è±¡ç”Ÿå‘½å‘¨æœŸä¿è¯</strong>å¼•èµ·ã€‚åœ¨ <em>Listing 4b</em> çš„ç¬¬ 16 è¡Œï¼Œ<code>update_hook</code> API å°†é—­åŒ…<strong>å¼ºåˆ¶è½¬æ¢</strong>ä¸ºå‡½æ•°æŒ‡é’ˆï¼Œå¹¶æŠŠå®ƒ<strong>æ³¨å†Œ</strong>åˆ° <code>unsafe</code> ä»£ç å—ä¸­çš„<strong>å¤–éƒ¨ï¼ˆC/C++ï¼‰åº“</strong>ã€‚<code>unsafe</code> Rust ä¸è¿™äº›å¤–éƒ¨åº“<strong>éƒ½ä¸éµå®ˆ</strong> Rust çš„ç”Ÿå‘½å‘¨æœŸä¿è¯ã€‚å…¶ç»“æœæ˜¯ï¼šå½“è¯¥<strong>é—­åŒ…è¢«å›è°ƒ</strong>ä¸”ç›¸å…³å¯¹è±¡è¢«<strong>é”€æ¯</strong>æ—¶ï¼Œäº§ç”Ÿäº†<strong>é‡Šæ”¾åä½¿ç”¨</strong>ã€‚åœ¨æœ¬ CVE çš„å¤ç°ä¸­ï¼Œ<strong>RustSan</strong> åœ¨ä¸€ä¸ª<strong>ä¼ªå®‰å…¨ç«™ç‚¹</strong>ä¸ŠæŠ¥å‘Šäº†å¯¹<strong>å·²éš”ç¦»ï¼ˆquarantinedï¼‰çš„å®‰å…¨å¯¹è±¡</strong>çš„è®¿é—®ã€‚</p><h3 id="b-taint-source-reduction-with-hir-mir-analysis" tabindex="-1"><a class="header-anchor" href="#b-taint-source-reduction-with-hir-mir-analysis"><span>B. Taint source reduction with HIR/MIR analysis</span></a></h3><figure><img src="/assets/images/scholar/RustSan/table6.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æˆ‘ä»¬è¿˜è¯„ä¼°äº† <strong>RustSan</strong> ä¸ <strong>XRust</strong> [38] åœ¨ <strong>HIR/MIR åˆ†æ</strong>ä¸­ç”¨äº<strong>æ±¡ç‚¹æºï¼ˆtaint sourceï¼‰è¯†åˆ«</strong>çš„æ–¹æ³•ï¼ˆå³Â§4ä¸­æ‰€è¿°çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">I1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord">1</span></span></span></span> ä¸ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">I2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord">2</span></span></span></span>ï¼‰ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>XRust</strong> å°† <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">I1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord">1</span></span></span></span>ï¼ˆå³ <strong>æ‰€æœ‰ä½äº <code>unsafe</code> ä»£ç å—ä¸­çš„è¯­å¥</strong>ï¼‰<strong>ç›´æ¥</strong>è§†ä¸ºæ±¡ç‚¹æºï¼›è€Œ <strong>RustSan</strong> ä½¿ç”¨çš„æ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">I2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord">2</span></span></span></span>ï¼Œå®ƒæ˜¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">I1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord">1</span></span></span></span> çš„<strong>ç²¾ç‚¼å­é›†</strong>ï¼Œ<strong>åªåŒ…å«å†™è¯­å¥</strong>ã€‚æ­¤å¤–ï¼Œ<strong>RustSan</strong> èƒ½å¤Ÿè¯†åˆ«<strong>å†…è”å‡½æ•°</strong>ä¸­çš„è¯­å¥ï¼Œè€Œ <strong>XRust</strong> ä¼š<strong>é—æ¼</strong>è¿™ç±»è¯­å¥ã€‚å› è€Œï¼Œé‡‡ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">I2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord">2</span></span></span></span> ä¼š<strong>å‡å°‘</strong>æ±¡ç‚¹æºçš„æ•°é‡ï¼›ä½†ä¸æ­¤åŒæ—¶ï¼Œ<strong>æŠŠå†…è”å‡½æ•°ä¸­çš„è¯­å¥ä¹Ÿçº³å…¥è€ƒè™‘</strong>ï¼Œåˆä¼šä½¿ RustSan çš„æ±¡ç‚¹æºé›†åˆ<strong>ç›¸è¾ƒ XRust å¢åŠ </strong>ã€‚å³ä¾¿å¦‚æ­¤ï¼Œå®éªŒæ˜¾ç¤º <strong>RustSan</strong> çš„æ±¡ç‚¹æºé›†åˆè§„æ¨¡<strong>å¹³å‡å‡å°‘äº† 12.86%</strong>ã€‚è¿™æ„å‘³ç€ <strong>RustSan</strong> åœ¨ HIR/MIR é˜¶æ®µè¾“å‡ºäº†<strong>æ›´ä¸ºç²¾ç»†</strong>çš„åˆ†æç»“æœï¼Œ<strong>ä¼ é€’</strong>åˆ° LLVM é˜¶æ®µåï¼Œ<strong>ç¼“è§£</strong>äº† LLVM IR åˆ†æçš„å¤æ‚åº¦ã€‚</p><h3 id="c-heap-allocator-microbenchmark" tabindex="-1"><a class="header-anchor" href="#c-heap-allocator-microbenchmark"><span>C. Heap allocator microbenchmark</span></a></h3><figure><img src="/assets/images/scholar/RustSan/figure6.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>RustSan</strong> ä¿®æ”¹äº† <strong>ASan</strong> çš„å †åˆ†é…å™¨ï¼Œä½¿å…¶æŒ‰ç…§ <strong>RustSan</strong> çš„å½±å­å†…å­˜ï¼ˆshadow memoryï¼‰æ–¹æ¡ˆä¸ºæ–°åˆ†é…çš„å†…å­˜â€œç€è‰²â€ã€‚<br> ä¸ºè¡¡é‡<strong>è¿è¡ŒæœŸå½±å­å†…å­˜ç®¡ç†</strong>æ‰€å¸¦æ¥çš„å¼€é”€ï¼Œæˆ‘ä»¬æ¯”è¾ƒäº†åœ¨ <strong>RustSan</strong> ä¸ <strong>ASan</strong> ä¸‹ï¼Œå¯¹äºä¸åŒåˆ†é…å°ºå¯¸æ—¶ <code>malloc()</code> çš„<strong>å¹³å‡æ‰§è¡Œæ—¶é—´</strong>ã€‚å¯¹æ¯ä¸€ç§å†…å­˜å¤§å°ï¼Œæˆ‘ä»¬å°†åˆ†é…æ“ä½œï¼ˆ<code>malloc()</code>ï¼‰<strong>é‡å¤æ‰§è¡Œ 1000 ä¸‡æ¬¡</strong>ã€‚</p><p><strong>å›¾6</strong> å±•ç¤ºäº†å®éªŒç»“æœï¼šç›¸å¯¹äº <strong>ASan</strong> çš„åˆ†é…å™¨ï¼Œ<strong>RustSan</strong> çš„åˆ†é…å™¨<strong>å¹³å‡é¢å¤–å¼€é”€ä¸º 5.52%</strong>ã€‚åŸºäºè¯¥å¾®åŸºå‡†ç»“æœï¼Œæˆ‘ä»¬è®¤ä¸ºï¼šåœ¨é€šç”¨åº”ç”¨ä¸æ¨¡ç³Šæµ‹è¯•ï¼ˆfuzzingï¼‰åŸºå‡†ä¸­ï¼Œç”±å †åˆ†é…å™¨æ”¹åŠ¨å¼•å…¥çš„å½±å“<strong>å¯ä»¥å¿½ç•¥ä¸è®¡</strong>ã€‚</p><h2 id="citation" tabindex="-1"><a class="header-anchor" href="#citation"><span>Citation</span></a></h2></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/iXanadu13/iXanadu13.github.io/edit/main/src/posts/scholar/RustSanï¼šRetrofitting AddressSanitizer for Efficient Sanitization of Rust.md" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><span class="vp-meta-info" data-allow-mismatch="text">2025/10/17 11:53:39</span></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: xanadu13@qq.com">Xanadu13</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/posts/scholar/RansomSentry%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E7%BC%96%E8%AF%91%E5%99%A8%E7%9A%84%E6%A3%80%E6%B5%8B%E5%B7%A5%E5%85%B7%E5%AF%B9Android%E5%8B%92%E7%B4%A2%E8%BD%AF%E4%BB%B6%E8%BF%9B%E8%A1%8C%E8%BF%90%E8%A1%8C%E6%97%B6%E6%A3%80%E6%B5%8B.html" aria-label="RansomSentry: Runtime Detection of Android Ransomware With Compiler-Based Instrumentation"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>RansomSentry: Runtime Detection of Android Ransomware With Compiler-Based Instrumentation</div></a><a class="route-link auto-link next" href="/posts/scholar/Translingual_Obfuscation.html" aria-label="Translingual Obfuscation"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">Translingual Obfuscation<span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span></div></a></nav><div id="comment" class="giscus-wrapper input-top vp-comment" vp-comment style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">Made with â¤ï¸</div><div class="vp-copyright">Copyright Â© 2026 Xanadu13 </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-CbaX5e1n.js" defer></script>
  </body>
</html>
