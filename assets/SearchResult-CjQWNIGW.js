import{u as M,h as se,i as te,j as W,k as le,l as ae,t as ie,m as re,n as R,p as H,q as oe,w as O,v as t,x as ue,R as _,y as ne,z as ce,A as pe,B as me,C as he,D as ve,E as ge,F as de,G as ye,H as F,I as Ee,J as Be,K as Ae,L as I,M as P,N as fe}from"./app-2SNeOa3Y.js";const we=["/","/intro.html","/posts/compiler_principle.html","/posts/ensp-win11.html","/posts/git.html","/posts/install-rabbitmq.html","/posts/interview.html","/posts/linux-cmd.html","/posts/nodejs.html","/posts/tsconfig-json-error.html","/posts/vmware-macOS.html","/posts/yapi.html","/posts/algo/LIS.html","/posts/algo/disjoint-set.html","/posts/algo/jd0802t2.html","/posts/algo/jd0809t1.html","/posts/algo/kmp.html","/posts/algo/longestPalindrome.html","/posts/algo/sieve.html","/posts/algo/sort.html","/posts/database/mysql-devide.html","/posts/cpp/basic.html","/posts/cpp/c-union.html","/posts/cpp/compile-time-obf.html","/posts/cpp/meta-program.html","/posts/cpp/priority_queue.html","/posts/cpp/shared_ptr.html","/posts/hdoj/1010.html","/posts/hdoj/1028.html","/posts/hdoj/1213-disjoint-set.html","/posts/hdoj/3743-merge-sort.html","/posts/java/ExecutorService.html","/posts/java/log-in-java.html","/posts/java/sync.html","/posts/luogu/P1462-%E9%80%9A%E5%BE%80%E5%A5%A5%E6%A0%BC%E7%91%9E%E7%8E%9B%E7%9A%84%E9%81%93%E8%B7%AF.html","/posts/luogu/P1807-%E6%9C%80%E9%95%BF%E8%B7%AF.html","/posts/luogu/P3916-%E5%9B%BE%E7%9A%84%E9%81%8D%E5%8E%86.html","/posts/rust/difficulties.html","/posts/rust/tricks.html","/posts/scholar/CFHider%EF%BC%9A%E5%9F%BA%E4%BA%8EIntel%20SGX%E7%9A%84%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B7%B7%E6%B7%86.html","/posts/scholar/%E5%8F%8D%E6%B7%B7%E6%B7%86%EF%BC%9A%E9%80%86%E5%90%91%E6%B7%B7%E6%B7%86%E5%90%8E%E7%9A%84%E4%BB%A3%E7%A0%81.html","/posts/scholar/%E5%9F%BA%E4%BA%8E%E8%BD%AF%E4%BB%B6%E7%9A%84%E7%94%9F%E5%AD%98%E6%9C%BA%E5%88%B6%E4%BF%9D%E6%8A%A4.html","/posts/wsl/WSL-memo.html","/posts/wsl/docker-in-WSL.html","/posts/wsl/kali-linux-in-WSL.html","/posts/wsl/kali-wsl-autostart.html","/posts/wsl/ssh-in-WSL.html","/404.html","/posts/","/posts/algo/","/posts/database/","/posts/cpp/","/posts/hdoj/","/posts/java/","/posts/luogu/","/posts/rust/","/posts/scholar/","/posts/wsl/","/category/","/category/compiler-principle/","/category/ensp/","/category/git/","/category/rabbitmq/","/category/linux/","/category/nodejs/","/category/vscode/","/category/%E8%99%9A%E6%8B%9F%E6%9C%BA/","/category/yapi/","/category/c__/","/category/mysql/","/category/c/","/category/hdoj/","/category/java/","/category/rust/","/category/wsl/","/tag/","/tag/ensp/","/tag/win11/","/tag/virtualbox/","/tag/git/","/tag/wsl/","/tag/linux/","/tag/vmware/","/tag/c__/","/tag/algorithm/","/tag/%E5%B9%B6%E6%9F%A5%E9%9B%86/","/tag/kmp/","/tag/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/","/tag/luogu/","/tag/c/","/tag/metaprogramming/","/tag/string-obfuscation/","/tag/bfs/","/tag/dfs/","/tag/%E6%AF%8D%E5%87%BD%E6%95%B0/","/tag/sort/","/tag/%E6%AD%BB%E9%94%81/","/tag/log/","/tag/%E5%A4%9A%E7%BA%BF%E7%A8%8B/","/tag/%E6%90%9C%E7%B4%A2/","/tag/%E6%9C%80%E7%9F%AD%E8%B7%AF/","/tag/data-structure/","/tag/obfuscate/","/tag/armoury-crate/","/article/","/star/","/timeline/"],He="SLIMSEARCH_QUERY_HISTORY",d=M(He,[]),Fe=()=>{const{queryHistoryCount:l}=F,a=l>0;return{enabled:a,queryHistories:d,addQueryHistory:i=>{a&&(d.value=Array.from(new Set([i,...d.value.slice(0,l-1)])))},removeQueryHistory:i=>{d.value=[...d.value.slice(0,i),...d.value.slice(i+1)]}}},D=l=>we[l.id]+("anchor"in l?`#${l.anchor}`:""),ke="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:T}=F,y=M(ke,[]),Ce=()=>{const l=T>0;return{enabled:l,resultHistories:y,addResultHistory:a=>{if(l){const i={link:D(a),display:a.display};"header"in a&&(i.header=a.header),y.value=[i,...y.value.slice(0,T-1)]}},removeResultHistory:a=>{y.value=[...y.value.slice(0,a),...y.value.slice(a+1)]}}},je=l=>{const a=me(),i=W(),k=he(),o=R(0),B=H(()=>o.value>0),v=ve([]);return ge(()=>{const{search:g,terminate:C}=de(),E=ye(n=>{const{resultsFilter:A=u=>u,querySplitter:L,suggestionsFilter:j,...S}=a.value;n?(o.value+=1,g(n,i.value,S).then(u=>A(u,n,i.value,k.value)).then(u=>{o.value-=1,v.value=u}).catch(u=>{console.warn(u),o.value-=1,o.value||(v.value=[])})):v.value=[]},F.searchDelay-F.suggestDelay,{maxWait:5e3});O([l,i],([n])=>{E(n.join(" "))},{immediate:!0}),Ee(()=>{C()})}),{isSearching:B,results:v}};var xe=se({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:a}){const i=te(),k=W(),o=le(ae),{enabled:B,addQueryHistory:v,queryHistories:g,removeQueryHistory:C}=Fe(),{enabled:E,resultHistories:n,addResultHistory:A,removeResultHistory:L}=Ce(),j=B||E,S=ie(l,"queries"),{results:u,isSearching:U}=je(S),r=re({isQuery:!0,index:0}),m=R(0),h=R(0),Q=H(()=>j&&(g.value.length>0||n.value.length>0)),x=H(()=>u.value.length>0),q=H(()=>u.value[m.value]||null),Y=()=>{const{isQuery:e,index:s}=r;s===0?(r.isQuery=!e,r.index=e?n.value.length-1:g.value.length-1):r.index=s-1},G=()=>{const{isQuery:e,index:s}=r;s===(e?g.value.length-1:n.value.length-1)?(r.isQuery=!e,r.index=0):r.index=s+1},z=()=>{m.value=m.value>0?m.value-1:u.value.length-1,h.value=q.value.contents.length-1},J=()=>{m.value=m.value<u.value.length-1?m.value+1:0,h.value=0},K=()=>{h.value<q.value.contents.length-1?h.value+=1:J()},N=()=>{h.value>0?h.value-=1:z()},b=e=>e.map(s=>fe(s)?s:t(s[0],s[1])),V=e=>{if(e.type==="customField"){const s=Be[e.index]||"$content",[c,w=""]=Ae(s)?s[k.value].split("$content"):s.split("$content");return e.display.map(p=>t("div",b([c,...p,w])))}return e.display.map(s=>t("div",b(s)))},f=()=>{m.value=0,h.value=0,a("updateQuery",""),a("close")},X=()=>B?t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},o.value.queryHistory),g.value.map((e,s)=>t("div",{class:["slimsearch-result-item",{active:r.isQuery&&r.index===s}],onClick:()=>{a("updateQuery",e)}},[t(I,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},e),t("button",{class:"slimsearch-remove-icon",innerHTML:P,onClick:c=>{c.preventDefault(),c.stopPropagation(),C(s)}})]))])):null,Z=()=>E?t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},o.value.resultHistory),n.value.map((e,s)=>t(_,{to:e.link,class:["slimsearch-result-item",{active:!r.isQuery&&r.index===s}],onClick:()=>{f()}},()=>[t(I,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(c=>b(c)).flat())]),t("button",{class:"slimsearch-remove-icon",innerHTML:P,onClick:c=>{c.preventDefault(),c.stopPropagation(),L(s)}})]))])):null;return oe("keydown",e=>{if(l.isFocusing){if(x.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")K();else if(e.key==="Enter"){const s=q.value.contents[h.value];v(l.queries.join(" ")),A(s),i.push(D(s)),f()}}else if(E){if(e.key==="ArrowUp")Y();else if(e.key==="ArrowDown")G();else if(e.key==="Enter"){const{index:s}=r;r.isQuery?(a("updateQuery",g.value[s]),e.preventDefault()):(i.push(n.value[s].link),f())}}}}),O([m,h],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["slimsearch-result-wrapper",{empty:l.queries.length?!x.value:!Q.value}],id:"slimsearch-results"},l.queries.length?U.value?t(ue,{hint:o.value.searching}):x.value?t("ul",{class:"slimsearch-result-list"},u.value.map(({title:e,contents:s},c)=>{const w=m.value===c;return t("li",{class:["slimsearch-result-list-item",{active:w}]},[t("div",{class:"slimsearch-result-title"},e||o.value.defaultTitle),s.map((p,ee)=>{const $=w&&h.value===ee;return t(_,{to:D(p),class:["slimsearch-result-item",{active:$,"aria-selected":$}],onClick:()=>{v(l.queries.join(" ")),A(p),f()}},()=>[p.type==="text"?null:t(p.type==="title"?ne:p.type==="heading"?ce:pe,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[p.type==="text"&&p.header?t("div",{class:"content-header"},p.header):null,t("div",V(p))])])})])})):o.value.emptyResult:j?Q.value?[X(),Z()]:o.value.emptyHistory:o.value.emptyResult)}});export{xe as default};
