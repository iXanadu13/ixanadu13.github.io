import{u as W,h as se,i as te,j as O,k as le,l as ae,t as ie,m as re,n as L,p as H,q as oe,w as P,v as t,x as ue,R as _,y as ne,z as ce,A as me,B as pe,C as he,D as ve,E as de,F as ge,G as ye,H as k,I as Ee,J as fe,K as we,L as T,M as I,N as Ae}from"./app-CNbW_aP_.js";const Be=["/","/intro.html","/posts/compiler_principle.html","/posts/ensp-win11.html","/posts/git.html","/posts/install-rabbitmq.html","/posts/linux-cmd.html","/posts/nodejs.html","/posts/tsconfig-json-error.html","/posts/vmware-macOS.html","/posts/yapi.html","/posts/algo/disjoint-set.html","/posts/algo/longestPalindrome.html","/posts/algo/sieve.html","/posts/algo/sort.html","/posts/database/mysql-devide.html","/posts/cpp/c-union.html","/posts/cpp/compile-time-obf.html","/posts/cpp/meta-program.html","/posts/cpp/priority_queue.html","/posts/hdoj/1010.html","/posts/hdoj/1028.html","/posts/hdoj/1213-disjoint-set.html","/posts/java/log-in-java.html","/posts/rust/difficulties.html","/posts/rust/tricks.html","/posts/scholar/%E5%8F%8D%E6%B7%B7%E6%B7%86%EF%BC%9A%E9%80%86%E5%90%91%E6%B7%B7%E6%B7%86%E5%90%8E%E7%9A%84%E4%BB%A3%E7%A0%81.html","/posts/scholar/%E5%9F%BA%E4%BA%8E%E8%BD%AF%E4%BB%B6%E7%9A%84%E7%94%9F%E5%AD%98%E6%9C%BA%E5%88%B6%E4%BF%9D%E6%8A%A4.html","/posts/wsl/WSL-memo.html","/posts/wsl/docker-in-WSL.html","/posts/wsl/kali-linux-in-WSL.html","/posts/wsl/kali-wsl-autostart.html","/posts/wsl/ssh-in-WSL.html","/404.html","/posts/","/posts/algo/","/posts/database/","/posts/cpp/","/posts/hdoj/","/posts/java/","/posts/rust/","/posts/scholar/","/posts/wsl/","/category/","/category/compiler-principle/","/category/ensp/","/category/git/","/category/rabbitmq/","/category/linux/","/category/nodejs/","/category/vscode/","/category/%E8%99%9A%E6%8B%9F%E6%9C%BA/","/category/yapi/","/category/c__/","/category/mysql/","/category/c/","/category/hdoj/","/category/java/","/category/rust/","/category/wsl/","/tag/","/tag/ensp/","/tag/win11/","/tag/virtualbox/","/tag/git/","/tag/wsl/","/tag/linux/","/tag/vmware/","/tag/algorithm/","/tag/%E5%B9%B6%E6%9F%A5%E9%9B%86/","/tag/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/","/tag/luogu/","/tag/c/","/tag/c__/","/tag/metaprogramming/","/tag/string-obfuscation/","/tag/bfs/","/tag/dfs/","/tag/%E6%AF%8D%E5%87%BD%E6%95%B0/","/tag/log/","/tag/data-structure/","/tag/obfuscate/","/tag/armoury-crate/","/article/","/star/","/timeline/"],He="SLIMSEARCH_QUERY_HISTORY",g=W(He,[]),ke=()=>{const{queryHistoryCount:l}=k,a=l>0;return{enabled:a,queryHistories:g,addQueryHistory:i=>{a&&(g.value=Array.from(new Set([i,...g.value.slice(0,l-1)])))},removeQueryHistory:i=>{g.value=[...g.value.slice(0,i),...g.value.slice(i+1)]}}},Q=l=>Be[l.id]+("anchor"in l?`#${l.anchor}`:""),qe="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:M}=k,y=W(qe,[]),xe=()=>{const l=M>0;return{enabled:l,resultHistories:y,addResultHistory:a=>{if(l){const i={link:Q(a),display:a.display};"header"in a&&(i.header=a.header),y.value=[i,...y.value.slice(0,M-1)]}},removeResultHistory:a=>{y.value=[...y.value.slice(0,a),...y.value.slice(a+1)]}}},Re=l=>{const a=pe(),i=O(),q=he(),o=L(0),f=H(()=>o.value>0),v=ve([]);return de(()=>{const{search:d,terminate:x}=ge(),E=ye(n=>{const{resultsFilter:w=u=>u,querySplitter:D,suggestionsFilter:R,...S}=a.value;n?(o.value+=1,d(n,i.value,S).then(u=>w(u,n,i.value,q.value)).then(u=>{o.value-=1,v.value=u}).catch(u=>{console.warn(u),o.value-=1,o.value||(v.value=[])})):v.value=[]},k.searchDelay-k.suggestDelay,{maxWait:5e3});P([l,i],([n])=>{E(n.join(" "))},{immediate:!0}),Ee(()=>{x()})}),{isSearching:f,results:v}};var be=se({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:a}){const i=te(),q=O(),o=le(ae),{enabled:f,addQueryHistory:v,queryHistories:d,removeQueryHistory:x}=ke(),{enabled:E,resultHistories:n,addResultHistory:w,removeResultHistory:D}=xe(),R=f||E,S=ie(l,"queries"),{results:u,isSearching:U}=Re(S),r=re({isQuery:!0,index:0}),p=L(0),h=L(0),F=H(()=>R&&(d.value.length>0||n.value.length>0)),b=H(()=>u.value.length>0),j=H(()=>u.value[p.value]||null),Y=()=>{const{isQuery:e,index:s}=r;s===0?(r.isQuery=!e,r.index=e?n.value.length-1:d.value.length-1):r.index=s-1},z=()=>{const{isQuery:e,index:s}=r;s===(e?d.value.length-1:n.value.length-1)?(r.isQuery=!e,r.index=0):r.index=s+1},G=()=>{p.value=p.value>0?p.value-1:u.value.length-1,h.value=j.value.contents.length-1},J=()=>{p.value=p.value<u.value.length-1?p.value+1:0,h.value=0},K=()=>{h.value<j.value.contents.length-1?h.value+=1:J()},N=()=>{h.value>0?h.value-=1:G()},C=e=>e.map(s=>Ae(s)?s:t(s[0],s[1])),V=e=>{if(e.type==="customField"){const s=fe[e.index]||"$content",[c,B=""]=we(s)?s[q.value].split("$content"):s.split("$content");return e.display.map(m=>t("div",C([c,...m,B])))}return e.display.map(s=>t("div",C(s)))},A=()=>{p.value=0,h.value=0,a("updateQuery",""),a("close")},X=()=>f?t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},o.value.queryHistory),d.value.map((e,s)=>t("div",{class:["slimsearch-result-item",{active:r.isQuery&&r.index===s}],onClick:()=>{a("updateQuery",e)}},[t(T,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},e),t("button",{class:"slimsearch-remove-icon",innerHTML:I,onClick:c=>{c.preventDefault(),c.stopPropagation(),x(s)}})]))])):null,Z=()=>E?t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},o.value.resultHistory),n.value.map((e,s)=>t(_,{to:e.link,class:["slimsearch-result-item",{active:!r.isQuery&&r.index===s}],onClick:()=>{A()}},()=>[t(T,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(c=>C(c)).flat())]),t("button",{class:"slimsearch-remove-icon",innerHTML:I,onClick:c=>{c.preventDefault(),c.stopPropagation(),D(s)}})]))])):null;return oe("keydown",e=>{if(l.isFocusing){if(b.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")K();else if(e.key==="Enter"){const s=j.value.contents[h.value];v(l.queries.join(" ")),w(s),i.push(Q(s)),A()}}else if(E){if(e.key==="ArrowUp")Y();else if(e.key==="ArrowDown")z();else if(e.key==="Enter"){const{index:s}=r;r.isQuery?(a("updateQuery",d.value[s]),e.preventDefault()):(i.push(n.value[s].link),A())}}}}),P([p,h],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["slimsearch-result-wrapper",{empty:l.queries.length?!b.value:!F.value}],id:"slimsearch-results"},l.queries.length?U.value?t(ue,{hint:o.value.searching}):b.value?t("ul",{class:"slimsearch-result-list"},u.value.map(({title:e,contents:s},c)=>{const B=p.value===c;return t("li",{class:["slimsearch-result-list-item",{active:B}]},[t("div",{class:"slimsearch-result-title"},e||o.value.defaultTitle),s.map((m,ee)=>{const $=B&&h.value===ee;return t(_,{to:Q(m),class:["slimsearch-result-item",{active:$,"aria-selected":$}],onClick:()=>{v(l.queries.join(" ")),w(m),A()}},()=>[m.type==="text"?null:t(m.type==="title"?ne:m.type==="heading"?ce:me,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[m.type==="text"&&m.header?t("div",{class:"content-header"},m.header):null,t("div",V(m))])])})])})):o.value.emptyResult:R?F.value?[X(),Z()]:o.value.emptyHistory:o.value.emptyResult)}});export{be as default};
