import{u as O,h as se,i as te,j as P,k as le,l as ae,t as ie,m as re,n as b,p as E,q as ue,w as U,v as t,x as oe,R as _,y as ne,z as ce,A as me,B as pe,C as ve,D as he,E as de,F as ye,G as ge,H as R,I as fe,J as we,K as He,L as T,M as I,N as ke}from"./app-CN9KBdAf.js";const xe=["/","/intro.html","/posts/compiler_principle.html","/posts/ensp-win11.html","/posts/git.html","/posts/linux-cmd.html","/posts/nodejs.html","/posts/tsconfig-json-error.html","/posts/vmware-macOS.html","/posts/yapi.html","/posts/algo/longestPalindrome.html","/posts/algo/sieve.html","/posts/algo/sort.html","/posts/cpp/c-union.html","/posts/cpp/compile-time-obf.html","/posts/cpp/meta-program.html","/posts/database/mysql-devide.html","/posts/hdoj/1010.html","/posts/hdoj/1028.html","/posts/hdoj/1213.html","/posts/rust/difficulties.html","/posts/rust/tricks.html","/posts/java/log-in-java.html","/posts/wsl/WSL-memo.html","/posts/wsl/docker-in-WSL.html","/posts/wsl/kali-linux-in-WSL.html","/posts/wsl/kali-wsl-autostart.html","/404.html","/posts/","/posts/algo/","/posts/cpp/","/posts/database/","/posts/hdoj/","/posts/rust/","/posts/java/","/posts/wsl/","/category/","/category/compiler-principle/","/category/ensp/","/category/git/","/category/linux/","/category/nodejs/","/category/vscode/","/category/%E8%99%9A%E6%8B%9F%E6%9C%BA/","/category/yapi/","/category/luogu/","/category/c/","/category/c__/","/category/mysql/","/category/hdoj/","/category/rust/","/category/java/","/category/wsl/","/tag/","/tag/ensp/","/tag/win11/","/tag/virtualbox/","/tag/git/","/tag/linux/","/tag/vmware/","/tag/wsl/","/tag/algorithm/","/tag/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/","/tag/cpp/","/tag/c/","/tag/c__/","/tag/metaprogramming/","/tag/string-obfuscation/","/tag/bfs/","/tag/dfs/","/tag/%E6%AF%8D%E5%87%BD%E6%95%B0/","/tag/%E5%B9%B6%E6%9F%A5%E9%9B%86/","/tag/data-structure/","/tag/log/","/tag/armoury-crate/","/article/","/star/","/timeline/"],Ee="SLIMSEARCH_QUERY_HISTORY",y=O(Ee,[]),Re=()=>{const{queryHistoryCount:l}=R,a=l>0;return{enabled:a,queryHistories:y,addQueryHistory:i=>{a&&(y.value=Array.from(new Set([i,...y.value.slice(0,l-1)])))},removeQueryHistory:i=>{y.value=[...y.value.slice(0,i),...y.value.slice(i+1)]}}},D=l=>xe[l.id]+("anchor"in l?`#${l.anchor}`:""),Se="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:M}=R,g=O(Se,[]),qe=()=>{const l=M>0;return{enabled:l,resultHistories:g,addResultHistory:a=>{if(l){const i={link:D(a),display:a.display};"header"in a&&(i.header=a.header),g.value=[i,...g.value.slice(0,M-1)]}},removeResultHistory:a=>{g.value=[...g.value.slice(0,a),...g.value.slice(a+1)]}}},Qe=l=>{const a=pe(),i=P(),S=ve(),u=b(0),w=E(()=>u.value>0),h=he([]);return de(()=>{const{search:d,terminate:q}=ye(),f=ge(n=>{const{resultsFilter:H=o=>o,querySplitter:$,suggestionsFilter:Q,...j}=a.value;n?(u.value+=1,d(n,i.value,j).then(o=>H(o,n,i.value,S.value)).then(o=>{u.value-=1,h.value=o}).catch(o=>{console.warn(o),u.value-=1,u.value||(h.value=[])})):h.value=[]},R.searchDelay-R.suggestDelay,{maxWait:5e3});U([l,i],([n])=>{f(n.join(" "))},{immediate:!0}),fe(()=>{q()})}),{isSearching:w,results:h}};var Ce=se({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:a}){const i=te(),S=P(),u=le(ae),{enabled:w,addQueryHistory:h,queryHistories:d,removeQueryHistory:q}=Re(),{enabled:f,resultHistories:n,addResultHistory:H,removeResultHistory:$}=qe(),Q=w||f,j=ie(l,"queries"),{results:o,isSearching:W}=Qe(j),r=re({isQuery:!0,index:0}),p=b(0),v=b(0),F=E(()=>Q&&(d.value.length>0||n.value.length>0)),C=E(()=>o.value.length>0),L=E(()=>o.value[p.value]||null),Y=()=>{const{isQuery:e,index:s}=r;s===0?(r.isQuery=!e,r.index=e?n.value.length-1:d.value.length-1):r.index=s-1},z=()=>{const{isQuery:e,index:s}=r;s===(e?d.value.length-1:n.value.length-1)?(r.isQuery=!e,r.index=0):r.index=s+1},G=()=>{p.value=p.value>0?p.value-1:o.value.length-1,v.value=L.value.contents.length-1},J=()=>{p.value=p.value<o.value.length-1?p.value+1:0,v.value=0},K=()=>{v.value<L.value.contents.length-1?v.value+=1:J()},N=()=>{v.value>0?v.value-=1:G()},A=e=>e.map(s=>ke(s)?s:t(s[0],s[1])),V=e=>{if(e.type==="customField"){const s=we[e.index]||"$content",[c,x=""]=He(s)?s[S.value].split("$content"):s.split("$content");return e.display.map(m=>t("div",A([c,...m,x])))}return e.display.map(s=>t("div",A(s)))},k=()=>{p.value=0,v.value=0,a("updateQuery",""),a("close")},X=()=>w?t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},u.value.queryHistory),d.value.map((e,s)=>t("div",{class:["slimsearch-result-item",{active:r.isQuery&&r.index===s}],onClick:()=>{a("updateQuery",e)}},[t(T,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},e),t("button",{class:"slimsearch-remove-icon",innerHTML:I,onClick:c=>{c.preventDefault(),c.stopPropagation(),q(s)}})]))])):null,Z=()=>f?t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},u.value.resultHistory),n.value.map((e,s)=>t(_,{to:e.link,class:["slimsearch-result-item",{active:!r.isQuery&&r.index===s}],onClick:()=>{k()}},()=>[t(T,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(c=>A(c)).flat())]),t("button",{class:"slimsearch-remove-icon",innerHTML:I,onClick:c=>{c.preventDefault(),c.stopPropagation(),$(s)}})]))])):null;return ue("keydown",e=>{if(l.isFocusing){if(C.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")K();else if(e.key==="Enter"){const s=L.value.contents[v.value];h(l.queries.join(" ")),H(s),i.push(D(s)),k()}}else if(f){if(e.key==="ArrowUp")Y();else if(e.key==="ArrowDown")z();else if(e.key==="Enter"){const{index:s}=r;r.isQuery?(a("updateQuery",d.value[s]),e.preventDefault()):(i.push(n.value[s].link),k())}}}}),U([p,v],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["slimsearch-result-wrapper",{empty:l.queries.length?!C.value:!F.value}],id:"slimsearch-results"},l.queries.length?W.value?t(oe,{hint:u.value.searching}):C.value?t("ul",{class:"slimsearch-result-list"},o.value.map(({title:e,contents:s},c)=>{const x=p.value===c;return t("li",{class:["slimsearch-result-list-item",{active:x}]},[t("div",{class:"slimsearch-result-title"},e||u.value.defaultTitle),s.map((m,ee)=>{const B=x&&v.value===ee;return t(_,{to:D(m),class:["slimsearch-result-item",{active:B,"aria-selected":B}],onClick:()=>{h(l.queries.join(" ")),H(m),k()}},()=>[m.type==="text"?null:t(m.type==="title"?ne:m.type==="heading"?ce:me,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[m.type==="text"&&m.header?t("div",{class:"content-header"},m.header):null,t("div",V(m))])])})])})):u.value.emptyResult:Q?F.value?[X(),Z()]:u.value.emptyHistory:u.value.emptyResult)}});export{Ce as default};
